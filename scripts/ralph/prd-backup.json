{
  "project": "Practice Management",
  "branchName": "ralph/practice-management-platform",
  "description": "Practice Management Platform - Complete ground-up build with Next.js, ShadCN, Convex, and Clerk",
  "prdContext": {
    "PRD-002": {
      "name": "Email Ticketing Module",
      "overview": "A Zendesk-inspired helpdesk system for managing incoming email communications. The module enables teams to connect email inboxes, automatically route incoming emails to queues, assign tickets to groups or individuals, track SLAs, and maintain organized views of all communications.",
      "background": "Accounting firms and professional services organizations receive high volumes of client communications via email. Traditional email management approaches (folder-based routing, manual assignment) fail to scale and make it difficult to track response times, ensure accountability, and maintain service quality. A proper ticketing system provides the structure needed for efficient team collaboration, SLA compliance, and comprehensive reporting.",
      "goals": [
        "Centralized Email Management: Connect multiple email inboxes and manage all incoming communications from a single interface",
        "Queue-Based Organization: Route tickets to queues based on configurable rules (inbox source, client, keywords)",
        "Flexible Assignment: Assign tickets to groups (teams) or individual agents with clear accountability",
        "SLA Compliance: Track response times and resolution times with configurable SLA policies",
        "Powerful Views: Create filtered views across queues for efficient ticket management",
        "Team Collaboration: Internal notes, collision detection, and shared macros for team efficiency",
        "Integration: Link tickets to work items, clients, and other modules"
      ],
      "coreConcepts": {
        "ConnectedInbox": "An email account (Gmail, Outlook, Exchange) connected via OAuth. Emails arriving at connected inboxes automatically become tickets.",
        "Queue": "A named container for organizing tickets (backend concept for routing and SLA assignment). Users primarily interact with Views, not Queues directly.",
        "Group": "A team of agents who can be assigned tickets. Tickets can be assigned to a group (any member can pick it up) or to a specific agent.",
        "View": "A saved filter that displays tickets matching certain criteria. Views are the primary user-facing navigation for accessing tickets.",
        "Ticket": "The core entity representing an email conversation with status lifecycle, assignment, tags, priority, and SLA tracking.",
        "SLAPolicy": "Time-based targets for ticket handling (first response, next response, resolution time) with business hours and escalations.",
        "Macro": "A reusable action template that applies multiple changes to a ticket at once (canned response, status, assignment, tags)."
      }
    },
    "PRD-003": {
      "name": "Work Module",
      "overview": "The Work Module is the core/main part of the entire system. This is where all client work is tracked, managed, and monitored. It provides template-driven work creation, task management, time tracking integration, budget management, and workflow automation.",
      "background": "This is a practice management solution for accounting firms serving multiple clients. The Work Module is designed around the client-service relationship model where firms have agreed-upon services with clients defined in Statements of Work (SOW). Work items represent the actual work being performed, and templates standardize service delivery across clients.",
      "goals": [
        "Work Management: Track and manage all client work items",
        "Template System: Standardize work structures using templates",
        "Task Management: Break down work into manageable tasks with optional checklists",
        "Automation: Automatically create recurring work items",
        "Budget Tracking: Monitor time and budget against work items",
        "Collaboration: Enable team collaboration on work items",
        "Visibility: Provide multiple views (List, Kanban) with saved view configurations",
        "Efficiency: Support bulk operations for managing large numbers of items",
        "Organization: Enable favorites and archiving for work item lifecycle management"
      ]
    },
    "PRD-004": {
      "name": "Contact Module",
      "overview": "Provides contact and client relationship management (CRM) functionality using a Zendesk-style model where Contacts (people) can exist standalone or belong to Organizations (companies). Organizations can have multiple email domains, enabling automatic contact association.",
      "background": "Accounting firms need to manage relationships with clients, vendors, and other contacts. The Contact Module serves as the central repository for all contact information and enables firms to organize contacts by type, group them, and associate them with work items and other system entities.",
      "goals": [
        "Contact Management: Centralized contact database for people and organizations",
        "Smart Association: Automatic contact-to-organization linking via email domain matching",
        "Domain Management: Organizations can own multiple email domains for auto-association",
        "Flexible Grouping: Client groups and segments for organizing contacts",
        "Customization: Custom fields for firm-specific data capture",
        "Integration: Link contacts to work items, emails, and other entities",
        "Client Portal: Support for client portal access"
      ],
      "coreConcepts": {
        "Contact": "An individual person. Contacts can be standalone (not associated with any organization) or organization members (associated with an organization, either manually or via auto-association).",
        "Organization": "A company or entity. Organizations have one or more email domains and can have multiple contacts (people) associated with them. Domains are unique across the tenant - a domain can only belong to one organization.",
        "Auto-Association": "When a contact is created with an email address, the system checks if the email domain matches any organization's domains. If a match is found, the contact is automatically associated with that organization and flagged as autoAssociated: true.",
        "Client Group": "Manual groupings of contacts and/or organizations for organizing related entities.",
        "Segment": "Dynamic groups based on filter criteria. Segment membership updates automatically as contacts match criteria."
      }
    },
    "PRD-005": {
      "name": "Time Tracking Module",
      "overview": "Provides built-in time tracking functionality that integrates directly with work items. The module enables users to track time using stopwatches or manual entry, view timesheets, and analyze team utilization.",
      "background": "Time tracking is essential for accounting firms to bill clients accurately and monitor project profitability. The Time Tracking Module provides a seamless way for team members to log their time against work items, with automatic aggregation and billing integration.",
      "goals": [
        "Time Entry: Enable users to log time against work items",
        "Stopwatch Functionality: Provide timer-based time tracking",
        "Timesheet Management: Display and manage time entries in timesheet format",
        "Utilization Reporting: Track team member utilization and capacity",
        "Integration: Seamless integration with work items and billing",
        "Billing Integration: Support conversion of time entries to billable items"
      ],
      "coreConcepts": {
        "Time Entry": "A record of time worked on a work item, including date, hours, role, task type, notes, billing rate, and billable status.",
        "Stopwatch": "A running timer that tracks elapsed time. Only one stopwatch can run per user at a time. Stopwatches persist across page navigation and browser sessions (within 24 hours).",
        "Timesheet": "A collection of time entries organized by period (weekly, bi-weekly, or monthly). Users can view current and historical timesheets.",
        "Utilization": "A metric showing hours worked vs. capacity. Capacity is configurable per user (default 8 hours/day, 40 hours/week). Utilization percentage = (hoursWorked / capacity) * 100.",
        "Billing Rate Hierarchy": "Rates are resolved in order: work item rate > user rate > role rate > default rate. If no rate found, use $0.00 and flag for administrator review.",
        "Locked Entry": "A time entry that has been finalized and cannot be edited or deleted. Locked entries are included in billing runs."
      }
    },
    "PRD-006": {
      "name": "Billing Module",
      "overview": "Provides comprehensive billing, invoicing, and financial management functionality. The module enables firms to track unbilled time, create invoices, process billing runs, manage receivables, and analyze financial performance.",
      "background": "Billing is a critical function for accounting firms. The Billing Module integrates with time tracking to convert time entries into billable items, generates invoices, tracks receivables, and provides financial reporting. Most accounting firm clients operate under fixed Statements of Work (SOW) that define agreed services and pricing. The system must track actual work against SOW commitments to identify scope creep and ensure profitability.",
      "goals": [
        "SOW Management: Create and manage Statements of Work that define client agreements, deliverables, and pricing",
        "Scope Creep Detection: Compare actual work against SOW budgets to identify profitability issues",
        "Fixed Fee Billing: Support billing against SOW milestones, schedules, or progress",
        "Unbilled Tracking: Track time entries that haven't been billed",
        "Invoice Creation: Generate invoices from time entries, work items, or SOW schedules",
        "Billing Runs: Process multiple invoices in batch",
        "Receivables Management: Track outstanding invoices and payments",
        "Financial Reporting: Provide realization, receivables, scope analysis, and financial reports",
        "Recurring Billing: Support automated recurring billing"
      ],
      "coreConcepts": {
        "Statement of Work (SOW)": "A client agreement defining services, deliverables, and pricing. SOWs track actual work against budgets to identify scope creep. Status workflow: Draft \u2192 Active \u2192 Complete/Cancelled.",
        "SOW Deliverable": "A specific service or output within an SOW with budgeted hours, fixed amount, and billing trigger. Deliverables can be linked to work items to track actual vs budgeted time/cost.",
        "Scope Creep": "When actual work exceeds SOW budget. System calculates variance (hours and cost) and flags SOWs as On Track (0-10% over), At Risk (10-25% over), or Over Budget (>25% over).",
        "Billing Run": "Batch processing that groups unbilled time entries by client and creates multiple invoices at once. Tracks status (Pending \u2192 Processing \u2192 Completed/Failed) and errors.",
        "Invoice": "A billable document with line items from time entries or fixed fees. Status: Draft \u2192 Sent \u2192 Paid/Overdue. Invoice numbers format: INV-YYYY-NNNN.",
        "Payment": "Record of payment against an invoice. Supports partial payments. Can be edited within edit window (default 7 days) or voided within void window (default 30 days).",
        "Recurring Billing": "Automated billing configuration that generates invoices on schedule (Monthly, Quarterly, Annually). Can be Fixed Amount or Time-Based (bills unbilled time entries).",
        "Change Order": "Modification to an SOW (add deliverable, modify deliverable, price adjustment). Tracks approval status and maintains change history."
      }
    },
    "CHANGE-028": {
      "name": "SOW Document Uploads",
      "overview": "Add document upload capability to SOWs, allowing users to store signed service agreements, contracts, and engagement letters directly with each SOW.",
      "background": "SOWs currently have no way to store associated documents. Users must store documents in external systems and manually track which SOW corresponds to which signed document, leading to disconnected information, manual tracking, compliance risk, and duplicate effort.",
      "goals": [
        "Centralized Storage: Store signed agreements and related documents directly with SOWs",
        "Audit Trail: Track upload timestamp and uploader for compliance",
        "Access Control: Restrict uploads/deletes based on SOW status (Draft/Active only)",
        "File Management: Support upload, download, delete, and description editing for documents"
      ]
    },
    "PRD-014": {
      "name": "Queue Management & Ticket Enhancements",
      "overview": "Queue management system that organizes tickets by client and enables team members to manage their client workload. Includes category/subcategory system for ticket classification.",
      "background": "Users need to see tickets organized by client (their 'triage boxes'), be assigned to specific client queues they're responsible for, manage queue configuration (which inboxes feed which queues, who's assigned), and classify tickets by category for reporting and filtering.",
      "goals": [
        "Client Organization: Organize tickets by client through queues linked to organizations",
        "Queue Management: Configure which inboxes feed which queues and assign team members",
        "Queue Visibility: Show assigned queues in sidebar for quick access",
        "Ticket Classification: Categorize tickets by type (Tax, AP, AR, etc.) for reporting and filtering",
        "Team Assignment: Assign team members to queues they're responsible for",
        "Auto-Routing: Automatically route tickets to queues based on connected inbox configuration"
      ],
      "coreConcepts": {
        "Queue": "A named container for organizing tickets. Every connected inbox feeds into exactly one queue. A queue can optionally link to an organization (client). Queues without organizations are 'general queues'.",
        "Queue Membership": "Assignment of users to queues they're responsible for. Determines what appears in sidebar and filtered views. Roles: member or manager (managers can edit queue settings).",
        "Category": "Classification of ticket TYPE (Tax, AP, AR, etc.). Categories are separate from Queues - categories classify type, queues organize by client. Maximum depth: 2 levels (Category \u2192 Subcategory only).",
        "Inbox \u2192 Queue \u2192 Organization": "Architecture: Every connected inbox feeds into exactly one queue. A queue can receive from multiple inboxes. A queue optionally links to an organization (client)."
      }
    },
    "PRD-016": {
      "name": "Recurring Work & Automation",
      "overview": "Enables accounting firms to automate the creation of recurring work items for clients. The system introduces a subscription model where clients are subscribed to work templates, each with customizable schedules, and work items are automatically created based on those schedules.",
      "background": "Accounting firms perform recurring work for clients on predictable schedules: monthly accounts payable processing, quarterly tax estimates, annual tax returns, weekly payroll, etc. Currently, users must manually create each work item, which is time-consuming, error-prone, and inconsistent. The Recurring Work system solves this by allowing firms to define templates with default schedules, subscribing clients to templates with customizable settings, automatically creating work items on schedule, and providing visibility into upcoming and past automation activity.",
      "goals": [
        "Automation: Automatically create recurring work items based on schedules",
        "Flexibility: Allow per-client customization of schedules, budgets, and team assignments",
        "Visibility: Provide dashboards showing upcoming work and automation history",
        "Control: Enable pause, skip, and manual trigger capabilities",
        "Bulk Operations: Support mass-subscribing clients to templates",
        "Consistency: Ensure all recurring work follows template structure",
        "Auditability: Track who created subscriptions and when automation ran"
      ],
      "coreConcepts": {
        "Recurring Work": "A per-client subscription to a template that defines when and how work items are automatically created. Links Client \u2194 Template with customizable schedule, budget, and team settings.",
        "Schedule Configuration": "Defines frequency (Weekly, Monthly, Quarterly, Annually), day specification, due date offset (days after period end), and lead time (days before due to create work).",
        "Automation Run": "A record of when automation executed, tracking which subscriptions were processed, work items created, errors encountered, and overall status.",
        "Period": "The time range the work covers, stored in ISO 8601 format (YYYY-MM), e.g., '2026-01' for January 2026."
      }
    },
    "PRD-013": {
      "name": "API Architecture",
      "overview": "Defines the external API architecture for third-party integrations. Provides REST API endpoints with API key authentication, webhooks for event notifications, auto-generated OpenAPI documentation, and admin interfaces for managing API credentials.",
      "background": "The platform has a robust internal API via Convex queries and mutations authenticated through Clerk. However, third-party systems (Zapier, accounting software, custom integrations) need a way to interact with the platform programmatically. This requires API key authentication (external systems don't have Clerk sessions), RESTful HTTP endpoints (universal compatibility), webhooks (push notifications when events occur), auto-generated documentation (always in sync), and admin UI for managing keys and webhooks.",
      "goals": [
        "External API Access: Enable third-party integrations via REST API with API key authentication",
        "Developer Experience: Auto-generated OpenAPI documentation that stays in sync with code",
        "Security: Scoped API keys with granular permissions and usage tracking",
        "Webhooks: Event-driven notifications for external systems",
        "Admin Control: Settings pages for API key and webhook management",
        "Observability: Usage metrics, rate limiting, and audit logs"
      ],
      "coreConcepts": {
        "API Key": "A credential for external API access with scoped permissions. Keys have a prefix (pm_live_ or pm_test_), environment (test/live), and permission scopes. Full key shown only once on creation; only hash stored.",
        "Scope": "Permission granted to an API key (e.g., work:read, contacts:write). Scopes limit what operations a key can perform. Common bundles: Read Only, Full Access, Accounting Integration.",
        "Webhook Endpoint": "A URL that receives HTTP POST notifications when events occur. Endpoints subscribe to specific events, receive HMAC-signed payloads, and auto-disable after consecutive failures.",
        "Webhook Delivery": "A record of an attempt to deliver a webhook payload, including status, HTTP response, attempts count, and retry scheduling.",
        "Rate Limiting": "Limits on API requests per minute per key. Enforced at Vercel edge before compute costs. Default: 1000 requests/minute."
      }
    },
    "CHANGE-003": {
      "name": "Work Page Client-Filtered Empty State & Entry Points",
      "overview": "Enhances the Work page when filtered to a single client by showing client context, recurring work status, and contextual empty states with direct creation paths.",
      "background": "When users filter the Work page to a specific client with no work items, they currently see a generic 'No work items match your filters' message. This creates confusion about whether recurring work is set up, provides no clear path to create work, and requires navigation away to understand the client's automation status.",
      "goals": [
        "Contextual Awareness: Show client context and recurring work status when viewing a single client's work",
        "Action-Oriented Empty States: Provide different empty state messages based on whether recurring work exists",
        "Direct Creation Paths: Enable work creation and recurring work setup directly from the filtered Work page",
        "Non-Intrusive: Changes only apply when filtered to exactly one client, preserving normal Work page behavior"
      ]
    },
    "CHANGE-016": {
      "name": "Recurring Work UX Improvements",
      "overview": "Addresses multiple usability issues identified in UX journey review: adds creation paths from dashboard, concept onboarding, inline schedule configuration, bulk assignment preview, error navigation links, and filter state preservation.",
      "background": "A UX journey review of PRD-016 identified several friction points: no creation path from dashboard, unclear concept relationships, templates without schedules creating dead-ends, ambiguous tab naming, no direct links from errors to fixes, unhelpful empty states, unclear team assignment sources, no preview for bulk assignment, unclear period selection, and filter state not preserved.",
      "goals": [
        "Creation Accessibility: Enable recurring work creation directly from dashboard without navigating to client first",
        "Concept Clarity: Provide onboarding explaining Template \u2192 Subscription \u2192 Work Item relationship",
        "Workflow Continuity: Allow inline schedule configuration when templates lack defaults",
        "Bulk Assignment Transparency: Show preview table before bulk assignment with per-client customization",
        "Error Resolution: Add direct navigation links from automation errors to affected subscriptions",
        "Period Selection: Make period selection explicit when manually triggering automation",
        "State Preservation: Preserve filters, sort, and scroll position when navigating to detail views"
      ]
    },
    "PRD-018": {
      "name": "Global Search",
      "overview": "A powerful, unified global search system that allows users to search across all major entities in the application from a single command palette interface. The search is context-aware, keyboard-driven, and provides instant access to work items, tickets, contacts, organizations, invoices, time entries, users, and templates.",
      "background": "Currently, the application has a non-functional search button in the header. Users must navigate to specific modules to find items, which is inefficient. A top-tier global search is a defining feature of modern productivity applications (Linear, Notion, Superhuman, Raycast) that dramatically reduces friction and enables power-user workflows.",
      "goals": [
        "Universal Access: Search across all major entity types from anywhere in the app",
        "Context-Awareness: Default search scope based on current page context",
        "Speed: Sub-200ms results for most queries",
        "Keyboard-First: Full keyboard navigation without requiring mouse",
        "Power User Features: Search operators, filters, and saved searches",
        "Actionable Results: Navigate to items, or take actions directly from search"
      ],
      "coreConcepts": {
        "SearchableEntityType": "The types of entities that can be searched: workItems, tickets, contacts, organizations, invoices, timeEntries, users, templates",
        "Scope": "The entity type(s) being searched. Can be 'all' or a specific entity type. Defaults based on current page context.",
        "Scope Prefix": "Keyboard shortcuts like 'w:' for work items, 't:' for tickets that quickly narrow search scope",
        "Recent Search": "A saved search query with scope and filters that can be quickly re-run",
        "Entity Access History": "Tracks which entities users access most frequently for type-ahead suggestions",
        "Command Palette": "Action system that recognizes natural language commands like 'new ticket' or 'go to work' and executes them"
      }
    },
    "CHANGE-017": {
      "name": "Ticket List Layout Improvements",
      "overview": "Enhances ticket list UX with preview pane mode for efficient triage, collapsible views sidebar, multi-ticket tab support, auto-advance after actions, draft auto-save, and column customization.",
      "background": "The current ticket list design has limitations identified during UX review: no triage efficiency (40+ clicks to process 10 tickets), no multi-ticket workflow, fixed sidebar taking horizontal space, and single-task design when agents often need to reference multiple tickets simultaneously.",
      "goals": [
        "Triage Efficiency: Enable preview pane mode for scanning and triaging tickets without navigation",
        "Space Optimization: Collapsible sidebar that auto-collapses in preview mode",
        "Multi-Ticket Workflow: Tab support for working on multiple tickets simultaneously",
        "Workflow Speed: Auto-advance after reply/note submission",
        "Draft Protection: Auto-save drafts to prevent lost work",
        "Personalization: Column customization for relevant information display"
      ],
      "coreConcepts": {
        "PreviewMode": "Split-view layout with ticket list on left and selected ticket content on right. Single click loads ticket in preview pane without navigation.",
        "TabSystem": "Browser-like tabs for opening multiple tickets. Each tab maintains independent state (scroll, drafts). Home icon returns to list.",
        "AutoAdvance": "After submitting reply/note, automatically close tab (tab mode) or advance to next ticket (preview mode).",
        "DraftAutoSave": "Drafts saved to localStorage after 2s debounce. Persist across sessions. Confirmation dialog when closing tab with draft."
      }
    },
    "CHANGE-018": {
      "name": "Preview Mode UX Redesign",
      "overview": "Fixes critical UX issues in preview mode: transforms the list layout from a squished table to email-style cards, and fixes the sidebar hover animation to slide smoothly instead of showing a double-sidebar overlay effect.",
      "background": "The current preview mode implementation simply compresses the table layout into less horizontal space, making columns unreadable and the interface unusable. Additionally, the sidebar hover behavior shows both the collapsed icon bar and the expanded overlay simultaneously, creating visual confusion. These issues deviate from email client patterns (Outlook, Gmail) where preview modes completely transform the list layout.",
      "goals": [
        "List Transformation: Completely change list layout in preview mode to email-style cards with avatar, requester, subject, snippet, and timestamp",
        "Sidebar Animation: Fix hover behavior to slide smoothly without double-sidebar effect",
        "Visual Polish: Ensure animations are smooth (150-200ms), with appropriate delays to prevent accidental triggers"
      ],
      "coreConcepts": {
        "EmailStyleCards": "In preview mode, each ticket becomes a card showing avatar (with initials), requester name, subject (2 lines max), message snippet, relative timestamp, and status dot - instead of compressed table columns.",
        "SidebarSlide": "When hovering over collapsed sidebar, the entire sidebar animates from 48px to 220px width with the same element sliding, not a popup overlay on top of the collapsed bar.",
        "LayoutModeAwareness": "Components render differently based on current mode - table layout vs card layout, column settings vs sort dropdown."
      }
    },
    "CHANGE-019": {
      "name": "Ticket to Work Item Linking",
      "overview": "Add bidirectional linking between tickets and work items with UI support for creating work items from tickets, linking existing work items, and displaying related items on both ticket and work item detail pages.",
      "background": "Currently there is no path from tickets to work items, creating a critical workflow gap. Users cannot create work items directly from tickets, forcing manual copy-paste. When a ticket requires larger work effort, there's no way to link the ticket to the resulting work item.",
      "goals": [
        "Workflow Integration: Enable seamless transition from tickets (client requests) to work items (tracked deliverables)",
        "Traceability: Maintain bidirectional links between tickets and work items",
        "User Efficiency: Provide one-click work item creation from tickets with pre-populated context",
        "Visibility: Show related work items on tickets and related tickets on work items"
      ],
      "coreConcepts": {
        "BidirectionalLinking": "Both tickets and work items maintain arrays of linked IDs. Linking updates both entities atomically.",
        "CreateFromTicket": "Work item creation flow that pre-populates fields from ticket data (subject, client, assignee, first message) and automatically links the entities."
      }
    },
    "CHANGE-020": {
      "name": "Work Bulk Actions UX Improvements",
      "overview": "Replace manual user ID input and native date input in bulk actions with searchable combobox and Calendar component patterns used throughout the application.",
      "background": "The current bulk actions implementation has severe UX issues: users must manually type user IDs (e.g., user_abc123xyz) to reassign work items, which is completely unusable. Additionally, native date inputs are inconsistent with the rest of the application.",
      "goals": [
        "Usability: Replace manual ID entry with searchable user/group picker",
        "Consistency: Use Calendar component pattern for date selection",
        "Discoverability: Provide visual user selection with avatars and names",
        "Efficiency: Enable bulk reassign in under 10 seconds"
      ]
    },
    "CHANGE-021": {
      "name": "Unified Assignment View",
      "overview": "Make both assignment systems (direct assignments via assigneeId and delegations via assignments table) visible and understandable, adding 'Assigned to Me' tab and optional delegated items in My Week.",
      "background": "The application currently has two disconnected assignment systems that create confusion. Users cannot see items delegated TO them (only what they delegated to others), and My Week misses delegated items. This breaks the natural workflow where users need to see all their assigned work in one place.",
      "goals": [
        "Visibility: Show all items assigned to user (both direct and delegated) in accessible views",
        "Clarity: Distinguish between direct assignments and delegations with visual indicators",
        "Completeness: Include delegated items in My Week when enabled",
        "Terminology: Clarify difference between 'Assign' (direct) and 'Delegate' (tracked)"
      ],
      "coreConcepts": {
        "DirectAssignment": "Assignment via assigneeId field - appears in My Week for items with due dates",
        "Delegation": "Assignment via assignments table - tracks progress, appears in Assignments page",
        "AssignmentSource": "Visual indicator showing whether item was directly assigned or delegated"
      }
    },
    "CHANGE-022": {
      "name": "Contact Billing History",
      "overview": "Add billing history tabs to Contact and Organization detail pages, and make client names clickable throughout the application for quick navigation to client detail pages.",
      "background": "Billing history is not accessible from contact pages, creating broken workflows. Users viewing a contact must navigate to separate invoice list and filter by client to see billing history. Additionally, client names are not clickable, preventing quick navigation.",
      "goals": [
        "Workflow Integration: Enable viewing billing history directly from contact pages",
        "Navigation Efficiency: Make client names clickable for quick access to client detail pages",
        "Context Preservation: Keep users in client context when viewing billing information",
        "Discoverability: Make billing history visible where users expect it"
      ]
    },
    "CHANGE-023": {
      "name": "Work Item Source Traceability",
      "overview": "Display work item source information (template, recurring work, automation) in work item detail pages and add 'Generated Work Items' tab to template detail pages.",
      "background": "Work items have source tracking fields (templateId, recurringWorkId, automationRunId) in the schema, but the UI does not display this information. Users cannot see where a work item came from or navigate to related templates/recurring work subscriptions.",
      "goals": [
        "Traceability: Show work item origins (template, recurring work, automation) in detail pages",
        "Navigation: Enable navigation from work items to source templates and recurring work",
        "Visibility: Display all work items created from a template on template detail page",
        "Automation Clarity: Show visual indicators for auto-generated work items in lists"
      ],
      "coreConcepts": {
        "SourceSection": "New section in work item Details tab showing template, recurring work, automation run, period, and created by type",
        "GeneratedWorkItems": "Tab on template detail page listing all work items created from that template"
      }
    },
    "CHANGE-024": {
      "name": "Shared Picker Components",
      "overview": "Create two shared, reusable picker components (ClientPicker and UserPicker) to standardize client and user selection across all modules, replacing inconsistent Select components and manual text inputs.",
      "background": "Client/contact and user pickers are implemented inconsistently across modules. Work and Billing modules use basic Select components that become unusable with 50+ clients. Work bulk actions require manual user ID input, which is completely broken. This creates poor UX and code duplication.",
      "goals": [
        "Consistency: Standardize picker UX across all modules",
        "Usability: Replace unusable Select components and manual ID inputs with searchable pickers",
        "Maintainability: Extract shared picker logic into reusable components",
        "Scalability: Support large lists (50+ clients, 100+ users) with search functionality"
      ],
      "coreConcepts": {
        "ClientPicker": "Searchable client/contact/organization picker using Popover + Command pattern",
        "UserPicker": "Searchable user picker with avatars, names, emails, extracted from AssigneeCombobox pattern"
      }
    },
    "CHANGE-025": {
      "name": "Shared UI Components for Consistency",
      "overview": "Create three shared components (StatusBadge, EmptyState, ConfirmationDialog) to standardize UI patterns across all modules, ensuring consistent status colors, empty state messaging, and confirmation dialog terminology.",
      "background": "Three UX consistency issues were identified: status badge styling varies by module (different colors for same status), empty state messaging is inconsistent (some have actions, some don't), and confirmation dialog terminology varies (Delete vs Remove, inconsistent warnings).",
      "goals": [
        "Visual Consistency: Standardize status badge colors across all modules",
        "Messaging Consistency: Standardize empty state patterns and terminology",
        "Terminology Consistency: Standardize confirmation dialog patterns (Delete vs Remove, warning text)",
        "Maintainability: Centralize UI patterns in shared components"
      ],
      "coreConcepts": {
        "StatusBadge": "Component with standardized status-to-color mapping and normalization",
        "EmptyState": "Component with consistent messaging patterns and action buttons",
        "ConfirmationDialog": "Component with standardized terminology (Delete vs Remove) and warning text"
      }
    },
    "CHANGE-026": {
      "name": "Time Module Navigation",
      "overview": "Update sidebar navigation to add Time section sub-items (My Time, Timesheets, Utilization) matching the pattern used by Work, Contacts, and Billing sections.",
      "background": "The Time module has sub-routes (/time/timesheets, /time/utilization) that are not discoverable through sidebar navigation. Users cannot access these features without knowing direct URLs, reducing feature adoption.",
      "goals": [
        "Discoverability: Make Time sub-routes visible in sidebar navigation",
        "Consistency: Follow same expandable sub-menu pattern as other sections",
        "Accessibility: Enable easy navigation to timesheet management and utilization reports"
      ]
    },
    "CHANGE-027": {
      "name": "Terminology Standardization",
      "overview": "Standardize status value casing (lowercase with underscores in data, Title Case in display) and remove incorrect 'project' terminology from search keywords.",
      "background": "Status values are stored inconsistently (mix of lowercase and capitalized), and global search includes 'project' as a keyword for work items, which is not the canonical term. These inconsistencies cause minor confusion and maintenance overhead.",
      "goals": [
        "Data Consistency: Standardize status values to lowercase with underscores in database",
        "Display Consistency: Use centralized formatStatus() helper for Title Case display",
        "Terminology Accuracy: Remove 'project' from search keywords, use only 'work item'"
      ]
    },
    "CHANGE-029": {
      "name": "Task Management UX Overhaul",
      "overview": "Redesigns the task management experience within work items to match Asana-level UX with sheet-based detail views, quick inline task creation, persistent quick-add inputs, and visible section actions.",
      "background": "The current task management UI is clunky and unintuitive. Key issues include empty state dead-ends, clunky inline expansion, multi-step task creation, hidden section actions, and inconsistent Uncategorized section behavior. This overhaul addresses all critical UX failures.",
      "goals": [
        "Sheet-based Task Detail: Replace inline expansion with right-side sheet panel for better context preservation",
        "Quick Task Creation: Enable rapid task creation via inline inputs (type + Enter)",
        "Full Detail Creation: Provide header button for creating tasks with all details from the start",
        "Visible Section Actions: Make per-section task creation discoverable with visible buttons",
        "Consistent Uncategorized: Always show Uncategorized section when named sections exist",
        "Modern UX Patterns: Match expectations from modern task management tools like Asana and Linear"
      ]
    },
    "CHANGE-030-Work-Item-Custom-Fields": {
      "name": "Work Item Custom Fields & Status Stages",
      "overview": "The current work item system has a fixed structure with sections, tasks, and subtasks.",
      "background": "The current work item system has a fixed structure with sections, tasks, and subtasks. However, different teams and service lines need more nuanced tracking beyond the basic task completion model. For example:",
      "goals": [
        "Custom Field Definitions (Tenant-Level)\n\nAllow admins to define custom fields that can be used across work items:\n\n**Supported Field Types:**\n- **Text"
      ]
    },
    "CHANGE-031-Team-Management": {
      "name": "Team Management & Hierarchy",
      "overview": "Currently, there's no concept of organizational teams beyond basic agent groups used for ticketing.",
      "background": "Currently, there's no concept of organizational teams beyond basic agent groups used for ticketing. The User Management module lists \"Teams/Departments\" and \"User hierarchies (manager/report-to relationships)\" as explicitly out of scope. However, firms need team structures to manage work effectively:",
      "goals": [
        "Teams Entity\nCreate organizational teams with names, descriptions, and optional hierarchy.\n\n- Teams have one or more managers\n- Teams have members (us"
      ]
    },
    "CHANGE-032-Custom-Views-System": {
      "name": "Unified Custom Views System",
      "overview": "The current view system across the application is fragmented, limited, and lacks modern view management capabilities:.",
      "background": "The current view system across the application is fragmented, limited, and lacks modern view management capabilities:",
      "goals": [
        "**Unified View Architecture**",
        "**View Ownership & Sharing**",
        "**Advanced Filter System**",
        "**Comprehensive View Configuration**",
        "**View Management UI**"
      ]
    },
    "CHANGE-033-Timer-UX-Improvements": {
      "name": "Timer UX Improvements",
      "overview": "The current timer experience has several usability issues that create friction for users trying to track time against work items:.",
      "background": "The current timer experience has several usability issues that create friction for users trying to track time against work items:",
      "goals": [
        "Add Prominent Timer Button in Work Item Header\n\nAdd a visible \"Start Timer\" button in the work item header, next to the status selector. This makes ti"
      ]
    },
    "CHANGE-034-Concurrent-Timers": {
      "name": "Concurrent Timers",
      "overview": "Currently only one timer can run at a time.",
      "background": "Currently only one timer can run at a time. When a user starts a new timer, the existing timer is either forcefully stopped or blocked. This creates significant friction for users who context-switch throughout their workday:",
      "goals": [
        "Timer A automatically pauses (preserves accumulated elapsed time)",
        "Timer B becomes the active timer and starts counting",
        "User can click back to Timer A to resume it (which pauses Timer B)"
      ]
    },
    "CHANGE-035-Multi-Client-Time-Tracking": {
      "name": "Multi-Client Time Tracking",
      "overview": "Some work items involve multiple clients.",
      "background": "Some work items involve multiple clients. Currently, the system only supports a single client per work item, which creates friction for common multi-client scenarios:",
      "goals": [
        "Multiple Clients per Work Item\n\n**Schema Change:**\n- `WorkItem.clientId` becomes `WorkItem.clientIds` (array of client IDs)\n- Backwards compatible: ex"
      ]
    },
    "CHANGE-036-Advanced-Queue-Routing": {
      "name": "Advanced Queue Routing Rules",
      "overview": "Current queue routing is functional but limited in scope and usability:.",
      "background": "Current queue routing is functional but limited in scope and usability:",
      "goals": [
        "**Simple for simple cases** - 80% of users just need domain\u2192queue mapping",
        "**Progressive disclosure** - Advanced options available but not overwhelming",
        "**Visual clarity** - See what rules do in plain English",
        "**Safe experimentation** - Test rules before activating them"
      ]
    },
    "CHANGE-037-User-Tagging-Mentions": {
      "name": "User Tagging & Mentions in Tickets",
      "overview": "When writing internal notes or replies in tickets, users often need to bring a colleague's attention to specific information or request their input.",
      "background": "When writing internal notes or replies in tickets, users often need to bring a colleague's attention to specific information or request their input. The current implementation has several gaps:",
      "goals": [
        "**@Mention Autocomplete** - When user types `@` in the reply or internal note editor, show autocomplete dropdown with tenant users",
        "**Mention Display** - Mentions appear as styled badges/chips that are visually distinct and interactive",
        "**Mention Notifications** - Mentioned users receive in-app and email notifications",
        "**Input Styling Fix** - Clean up border styling on reply and internal note input boxes"
      ]
    },
    "CHANGE-038-Profile-Settings-Signatures": {
      "name": "Profile Settings & Email Signatures",
      "overview": "The current settings architecture has several issues that need to be addressed:.",
      "background": "The current settings architecture has several issues that need to be addressed:",
      "goals": [
        "**Personal Profile Settings Page** - New page at `/settings/my-settings` (or `/profile/settings`)",
        "**Email Signature Editor** - Rich text editor for creating/editing email signatures",
        "**Notification Preferences** - Moved from admin settings, personal to each user",
        "**Display Preferences** - Theme, default views, timezone, date/time format",
        "**Clear Settings Separation** - Admin Settings vs Profile Settings distinction"
      ]
    },
    "CHANGE-039-Personal-Email-Calendar": {
      "name": "Personal Email & Calendar Integration",
      "overview": "The current email ticketing system only allows administrators to connect inboxes for the shared ticketing queues.",
      "background": "The current email ticketing system only allows administrators to connect inboxes for the shared ticketing queues. This creates several gaps in the user experience:",
      "goals": [
        "Personal Email Inbox Connection\n\nEach user can connect their own email inbox (separate from admin-connected ticketing inboxes):\n\n- **Personal inbox co"
      ]
    },
    "CHANGE-040-Real-Time-Email-Sync": {
      "name": "Real-Time Email Sync",
      "overview": "Current email synchronization has significant delays that undermine the value of the integrated email system:.",
      "background": "Current email synchronization has significant delays that undermine the value of the integrated email system:",
      "goals": [
        "**Webhook-Based Incoming Email** (Primary)",
        "**Synchronous Outgoing Email**",
        "**Real-Time User Notifications**",
        "**Sync Status Dashboard**"
      ]
    },
    "CHANGE-041-Forward-Email-Attachment": {
      "name": "Forward Email as Attachment",
      "overview": "Users need to prove that they sent an email to a client.",
      "background": "Users need to prove that they sent an email to a client. This is a common scenario in professional services:",
      "goals": [
        "**Forward as Attachment Action** - On any ticket message, add \"Forward as Attachment\" action",
        "**Enhanced Email Search** - Find specific emails by content, date, recipient, subject",
        "**Compose with Message Attachments** - New compose flow allowing attachment of existing messages",
        "**EML File Generation** - Generate proper .eml files that Outlook/Gmail can open",
        "**Viewing Forwarded Emails** - Handle receiving emails with .eml attachments"
      ]
    },
    "CHANGE-042-Contextual-Ticket-Search": {
      "name": "Contextual Ticket Search",
      "overview": "Global search (\u2318K) exists but is designed for finding things across the entire application.",
      "background": "Global search (\u2318K) exists but is designed for finding things across the entire application. When users are working in the tickets module with specific views or queues filtered, they need a way to search **within that context** rather than globally.",
      "goals": [
        "**Embedded Search Bar** in ticket list header (distinct from global \u2318K search)",
        "**Scope Selection** to control search breadth (Current View, Current Queue, All Tickets)",
        "**Multi-field Search** across subject, body content, requester, and tags",
        "**Real-time Filtering** as user types (with debounce)",
        "**Search Results Integration** that replaces ticket list with matching results",
        "**Match Highlighting** to show where search terms match"
      ]
    },
    "CHANGE-044": {
      "name": "Ticket UX Improvements",
      "overview": "Comprehensive UX overhaul addressing views sidebar hierarchy, multi-select behavior, archive quick actions, submit button positioning, status dropdown workflow, assignment UI, and attach message dialog.",
      "background": "The tickets module has accumulated several UX issues that create friction for daily users: confusing sidebar hierarchy, clunky multi-select, no quick dismiss action, submit button in wrong location, status dropdown requiring two clicks, flat assignment UI, and attach message defaults to current ticket.",
      "goals": [
        "Sidebar Clarity: Consolidate views sidebar with clear hierarchy (Views \u2192 Personal Views \u2192 Queues)",
        "Clean Multi-Select: Hover checkboxes in list view, Outlook-style selection in preview view",
        "Quick Archive: One-click archive action for non-actionable tickets",
        "Consistent Submit: Fixed submit button position in preview mode matching full-screen",
        "Efficient Status: One-click status+submit with split button design",
        "Hierarchical Assignment: Tree-structured assignment showing users within teams",
        "Simplified Attach: Search-only attach message dialog pre-populated with requester email"
      ]
    }
  },
  "userStories": [
    {
      "id": "US-001",
      "title": "Create Next.js project with TypeScript",
      "description": "As a developer, I need a Next.js project so that I can start building the app.",
      "acceptanceCriteria": [
        "Run 'npx create-next-app@latest' with TypeScript, Tailwind, ESLint, App Router options",
        "Project created in current directory or appropriate subfolder",
        "package.json exists with next, react, react-dom dependencies",
        "TypeScript configured with tsconfig.json",
        "Tailwind CSS configured with tailwind.config.ts",
        "Project runs with 'npm run dev' and shows Next.js welcome page",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "PRD-000: Foundation - Use frontend skill for guidance"
    },
    {
      "id": "US-002",
      "title": "Initialize ShadCN UI",
      "description": "As a developer, I need ShadCN configured so that I can use pre-built components.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest init'",
        "Select New York style, Zinc color, CSS variables: yes",
        "components.json file created",
        "lib/utils.ts created with cn() helper",
        "CSS variables added to globals.css",
        "Tailwind config updated for ShadCN",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "PRD-000: ShadCN Setup"
    },
    {
      "id": "US-003",
      "title": "Install core ShadCN components - buttons and inputs",
      "description": "As a developer, I need basic form components so that I can build forms.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add button'",
        "Run 'npx shadcn-ui@latest add input'",
        "Run 'npx shadcn-ui@latest add label'",
        "Run 'npx shadcn-ui@latest add textarea'",
        "Components exist in components/ui/",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-004",
      "title": "Install ShadCN form and selection components",
      "description": "As a developer, I need selection components so that I can build forms with choices.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add select'",
        "Run 'npx shadcn-ui@latest add checkbox'",
        "Run 'npx shadcn-ui@latest add radio-group'",
        "Run 'npx shadcn-ui@latest add switch'",
        "Components exist in components/ui/",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-005",
      "title": "Install ShadCN overlay components",
      "description": "As a developer, I need modal and dropdown components.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add dialog'",
        "Run 'npx shadcn-ui@latest add dropdown-menu'",
        "Run 'npx shadcn-ui@latest add popover'",
        "Run 'npx shadcn-ui@latest add sheet'",
        "Run 'npx shadcn-ui@latest add tooltip'",
        "Components exist in components/ui/",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-006",
      "title": "Install ShadCN display components",
      "description": "As a developer, I need display components for content presentation.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add card'",
        "Run 'npx shadcn-ui@latest add badge'",
        "Run 'npx shadcn-ui@latest add avatar'",
        "Run 'npx shadcn-ui@latest add separator'",
        "Run 'npx shadcn-ui@latest add skeleton'",
        "Components exist in components/ui/",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-007",
      "title": "Install ShadCN data and navigation components",
      "description": "As a developer, I need table and tab components.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add table'",
        "Run 'npx shadcn-ui@latest add tabs'",
        "Run 'npx shadcn-ui@latest add scroll-area'",
        "Components exist in components/ui/",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-008",
      "title": "Install ShadCN toast/sonner for notifications",
      "description": "As a developer, I need toast notifications for feedback.",
      "acceptanceCriteria": [
        "Run 'npx shadcn-ui@latest add sonner'",
        "Add Toaster component to root layout",
        "Toast can be triggered with toast() function",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "PRD-000: ShadCN Components"
    },
    {
      "id": "US-009",
      "title": "Install Lucide icons",
      "description": "As a developer, I need icons for the UI.",
      "acceptanceCriteria": [
        "Run 'npm install lucide-react'",
        "Icons can be imported: import { Home, Settings } from 'lucide-react'",
        "Icons render correctly in a test component",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": "PRD-000: Icons"
    },
    {
      "id": "US-010",
      "title": "Set up Convex backend",
      "description": "As a developer, I need Convex configured for the database.",
      "acceptanceCriteria": [
        "Run 'npm install convex'",
        "Run 'npx convex dev' to initialize (creates convex/ folder)",
        "convex/ folder exists with _generated/ subfolder",
        "Add 'convex': 'convex dev' script to package.json",
        "CONVEX_DEPLOYMENT and NEXT_PUBLIC_CONVEX_URL in .env.local",
        "Add .env.local to .gitignore if not already",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": "PRD-000: Convex Setup"
    },
    {
      "id": "US-011",
      "title": "Create ConvexClientProvider",
      "description": "As a developer, I need Convex provider in the app.",
      "acceptanceCriteria": [
        "Create components/providers/convex-provider.tsx",
        "Provider uses ConvexReactClient with NEXT_PUBLIC_CONVEX_URL",
        "Provider wraps children with ConvexProvider",
        "Mark component as 'use client'",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": "PRD-000: Convex Setup"
    },
    {
      "id": "US-012",
      "title": "Install and configure Clerk for Next.js",
      "description": "As a developer, I need Clerk for authentication.",
      "acceptanceCriteria": [
        "Run 'npm install @clerk/nextjs'",
        "Add NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY to .env.local",
        "Add CLERK_SECRET_KEY to .env.local",
        "Add NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in to .env.local",
        "Add NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up to .env.local",
        "Create .env.example with placeholder values",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": "PRD-001: Clerk Setup"
    },
    {
      "id": "US-013",
      "title": "Configure Clerk middleware",
      "description": "As a developer, I need Clerk middleware for route protection.",
      "acceptanceCriteria": [
        "Create middleware.ts in project root",
        "Use clerkMiddleware() from @clerk/nextjs/server",
        "Configure matcher to exclude static files and api routes appropriately",
        "Public routes: /sign-in, /sign-up, /api/webhooks",
        "Typecheck passes"
      ],
      "priority": 13,
      "passes": true,
      "notes": "PRD-001: Clerk Middleware"
    },
    {
      "id": "US-014",
      "title": "Add ClerkProvider to root layout",
      "description": "As a developer, I need Clerk context in the app.",
      "acceptanceCriteria": [
        "Update app/layout.tsx to wrap children with ClerkProvider",
        "ClerkProvider wraps ConvexClientProvider (Clerk outside, Convex inside)",
        "App still loads without errors",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": true,
      "notes": "PRD-001: Clerk Setup"
    },
    {
      "id": "US-015",
      "title": "Configure Convex with Clerk authentication",
      "description": "As a developer, I need Convex to use Clerk for auth.",
      "acceptanceCriteria": [
        "Run 'npm install @clerk/clerk-react' if not already installed",
        "Create convex/auth.config.ts with Clerk domain configuration",
        "Update ConvexClientProvider to use ConvexProviderWithClerk",
        "Use useAuth from @clerk/nextjs in provider",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": true,
      "notes": "PRD-001: Convex-Clerk Integration"
    },
    {
      "id": "US-016",
      "title": "Create sign-in page",
      "description": "As a user, I need a sign-in page to authenticate.",
      "acceptanceCriteria": [
        "Create app/(auth)/sign-in/[[...sign-in]]/page.tsx",
        "Page uses Clerk SignIn component",
        "Page is centered on screen",
        "Page shows application branding above sign-in",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "PRD-001: Auth Pages"
    },
    {
      "id": "US-017",
      "title": "Create sign-up page",
      "description": "As a user, I need a sign-up page to create an account.",
      "acceptanceCriteria": [
        "Create app/(auth)/sign-up/[[...sign-up]]/page.tsx",
        "Page uses Clerk SignUp component",
        "Page is centered on screen",
        "Page shows application branding above sign-up",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "PRD-001: Auth Pages"
    },
    {
      "id": "US-018",
      "title": "Create auth layout without app shell",
      "description": "As a user, I need auth pages without the main app navigation.",
      "acceptanceCriteria": [
        "Create app/(auth)/layout.tsx",
        "Layout renders children without sidebar or header",
        "Layout has centered, minimal styling",
        "Auth pages use this layout automatically",
        "Typecheck passes"
      ],
      "priority": 18,
      "passes": true,
      "notes": "PRD-001: Auth Layout"
    },
    {
      "id": "US-019",
      "title": "Create basic Convex schema",
      "description": "As a developer, I need database tables defined.",
      "acceptanceCriteria": [
        "Create convex/schema.ts",
        "Define users table: clerkId (string), email (string), name (string), avatarUrl (optional string), createdAt (number)",
        "Define tenants table: name (string), permaKey (string), createdAt (number)",
        "Add indexes for users.clerkId and tenants.permaKey",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": "PRD-001: Database Schema"
    },
    {
      "id": "US-020",
      "title": "Create user sync mutation",
      "description": "As a developer, I need to sync Clerk users to Convex.",
      "acceptanceCriteria": [
        "Create convex/users.ts",
        "Create upsertUser mutation that takes clerkId, email, name, avatarUrl",
        "Mutation checks if user exists by clerkId, updates or inserts accordingly",
        "Mutation is an internalMutation (not exposed to client)",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": true,
      "notes": "PRD-001: User Sync"
    },
    {
      "id": "US-021",
      "title": "Create Clerk webhook endpoint",
      "description": "As a developer, I need to receive Clerk user events.",
      "acceptanceCriteria": [
        "Create app/api/webhooks/clerk/route.ts",
        "Install 'svix' package for webhook verification",
        "Handle POST requests with Clerk webhook payload",
        "Verify webhook signature using CLERK_WEBHOOK_SECRET",
        "Handle 'user.created' and 'user.updated' events",
        "Call Convex mutation to upsert user",
        "Add CLERK_WEBHOOK_SECRET to .env.local and .env.example",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": "PRD-001: Webhooks"
    },
    {
      "id": "US-022",
      "title": "Create Convex HTTP router for webhooks",
      "description": "As a developer, I need Convex to receive webhook calls.",
      "acceptanceCriteria": [
        "Create convex/http.ts with httpRouter",
        "Alternatively, keep using Next.js API route and call Convex via httpAction",
        "Ensure webhook can successfully call the upsertUser mutation",
        "Typecheck passes"
      ],
      "priority": 22,
      "passes": true,
      "notes": "PRD-001: Webhooks - choose approach based on Convex best practices"
    },
    {
      "id": "US-023",
      "title": "Create getCurrentUser query",
      "description": "As a developer, I need to fetch the current user's data.",
      "acceptanceCriteria": [
        "Add getCurrentUser query to convex/users.ts",
        "Query uses ctx.auth.getUserIdentity() to get Clerk identity",
        "Query looks up user in users table by clerkId (from identity.subject)",
        "Returns user record or null if not found",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": true,
      "notes": "PRD-001: User Queries"
    },
    {
      "id": "US-024",
      "title": "Create useCurrentUser hook",
      "description": "As a developer, I need easy access to current user data.",
      "acceptanceCriteria": [
        "Create hooks/use-current-user.ts",
        "Hook uses useQuery to call getCurrentUser",
        "Hook returns { user, isLoading } object",
        "Mark file as 'use client'",
        "Typecheck passes"
      ],
      "priority": 24,
      "passes": true,
      "notes": "PRD-001: Hooks"
    },
    {
      "id": "US-025",
      "title": "Create dashboard layout with sidebar structure",
      "description": "As a user, I need the main app layout with navigation.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/layout.tsx",
        "Layout has flex container with sidebar and main content area",
        "Sidebar area is 240px wide on desktop",
        "Main content area fills remaining width",
        "Header area at top, 56px height",
        "Use Tailwind classes for layout",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": true,
      "notes": "PRD-000: Layout"
    },
    {
      "id": "US-026",
      "title": "Create Header component",
      "description": "As a user, I need a header with branding and user info.",
      "acceptanceCriteria": [
        "Create components/layout/header.tsx",
        "Header shows application text/logo on left",
        "Header shows Clerk UserButton on right",
        "Header has h-14 (56px) height",
        "Header has border-b for bottom border",
        "Header uses sticky positioning",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 26,
      "passes": true,
      "notes": "PRD-000: Layout"
    },
    {
      "id": "US-027",
      "title": "Add quick action buttons to Header",
      "description": "As a user, I need quick action buttons for common tasks.",
      "acceptanceCriteria": [
        "Add buttons to header: Email, Note, Work, Contact, Time Entry",
        "Use ShadCN Button with variant='ghost' and size='sm'",
        "Each button has an icon from Lucide",
        "Clicking button shows toast 'Coming soon'",
        "Buttons are in a flex row between logo and UserButton",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 27,
      "passes": true,
      "notes": "PRD-000: Header"
    },
    {
      "id": "US-028",
      "title": "Create Sidebar component structure",
      "description": "As a user, I need a sidebar for navigation.",
      "acceptanceCriteria": [
        "Create components/layout/sidebar.tsx",
        "Sidebar has w-60 (240px) width",
        "Sidebar has bg-muted/40 background",
        "Sidebar has border-r right border",
        "Sidebar fills full height below header",
        "Sidebar uses flex-col layout",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": true,
      "notes": "PRD-000: Sidebar"
    },
    {
      "id": "US-029",
      "title": "Add navigation items to Sidebar",
      "description": "As a user, I need navigation links in the sidebar.",
      "acceptanceCriteria": [
        "Add nav items: Tickets (Inbox icon), My Week (Calendar icon), Work (Briefcase icon), Contacts (Users icon), Time (Clock icon), Billing (CreditCard icon), Settings (Settings icon)",
        "Each item is a Next.js Link component",
        "Each item has icon + label text",
        "Items have hover state (bg-muted)",
        "Items have padding and rounded corners",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 29,
      "passes": true,
      "notes": "PRD-000: Sidebar Navigation"
    },
    {
      "id": "US-030",
      "title": "Add active state to Sidebar navigation",
      "description": "As a user, I need to see which page I'm on.",
      "acceptanceCriteria": [
        "Use usePathname() hook to get current path",
        "Active nav item has bg-primary/10 background",
        "Active nav item has text-primary color",
        "Active nav item has left border (border-l-2 border-primary)",
        "Compare pathname to item href to determine active state",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 30,
      "passes": true,
      "notes": "PRD-000: Sidebar Active State"
    },
    {
      "id": "US-031",
      "title": "Create placeholder page for Tickets",
      "description": "As a developer, I need the Tickets page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/tickets/page.tsx",
        "Page shows 'Tickets' as h1 heading",
        "Page shows placeholder text 'Email ticketing will appear here'",
        "Page is a server component by default",
        "Typecheck passes"
      ],
      "priority": 31,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-032",
      "title": "Create placeholder page for My Week",
      "description": "As a developer, I need the My Week page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/my-week/page.tsx",
        "Page shows 'My Week' as h1 heading",
        "Page shows placeholder text 'Your weekly tasks will appear here'",
        "Typecheck passes"
      ],
      "priority": 32,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-033",
      "title": "Create placeholder page for Work",
      "description": "As a developer, I need the Work page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/work/page.tsx",
        "Page shows 'Work' as h1 heading",
        "Page shows placeholder text 'Work items will appear here'",
        "Typecheck passes"
      ],
      "priority": 33,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-034",
      "title": "Create placeholder page for Contacts",
      "description": "As a developer, I need the Contacts page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/page.tsx",
        "Page shows 'Contacts' as h1 heading",
        "Page shows placeholder text 'Contacts will appear here'",
        "Typecheck passes"
      ],
      "priority": 34,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-035",
      "title": "Create placeholder page for Time",
      "description": "As a developer, I need the Time page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/time/page.tsx",
        "Page shows 'Time' as h1 heading",
        "Page shows placeholder text 'Time tracking will appear here'",
        "Typecheck passes"
      ],
      "priority": 35,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-036",
      "title": "Create placeholder page for Billing",
      "description": "As a developer, I need the Billing page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/page.tsx",
        "Page shows 'Billing' as h1 heading",
        "Page shows placeholder text 'Billing will appear here'",
        "Typecheck passes"
      ],
      "priority": 36,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-037",
      "title": "Create placeholder page for Settings",
      "description": "As a developer, I need the Settings page to exist.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/page.tsx",
        "Page shows 'Settings' as h1 heading",
        "Page shows placeholder text 'Settings will appear here'",
        "Typecheck passes"
      ],
      "priority": 37,
      "passes": true,
      "notes": "PRD-000: Pages"
    },
    {
      "id": "US-038",
      "title": "Configure root redirect to Tickets",
      "description": "As a user, I need the root URL to go to Tickets.",
      "acceptanceCriteria": [
        "Update app/(dashboard)/page.tsx or create redirect",
        "Visiting '/' redirects to '/tickets'",
        "Use Next.js redirect() function",
        "Typecheck passes"
      ],
      "priority": 38,
      "passes": true,
      "notes": "PRD-000: Routing"
    },
    {
      "id": "US-039",
      "title": "Integrate Header and Sidebar into dashboard layout",
      "description": "As a user, I need the layout components connected.",
      "acceptanceCriteria": [
        "Dashboard layout imports and renders Header component",
        "Dashboard layout imports and renders Sidebar component",
        "Main content area renders {children}",
        "Layout structure: Header on top, Sidebar on left, content fills rest",
        "Content area has overflow-auto for scrolling",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 39,
      "passes": true,
      "notes": "PRD-000: Layout Integration"
    },
    {
      "id": "US-040",
      "title": "Add collapsible sidebar state",
      "description": "As a user, I need to collapse the sidebar for more space.",
      "acceptanceCriteria": [
        "Add collapsed state to Sidebar (useState or context)",
        "Add toggle button at bottom of sidebar (ChevronLeft/ChevronRight icon)",
        "Collapsed sidebar is w-16 (64px) showing only icons",
        "Expanded sidebar is w-60 (240px) showing icons + labels",
        "Persist collapsed state in localStorage",
        "Smooth transition with transition-all duration-300",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 40,
      "passes": true,
      "notes": "PRD-000: Sidebar Collapse"
    },
    {
      "id": "US-041",
      "title": "Add user section to Sidebar bottom",
      "description": "As a user, I need user info and menu at sidebar bottom.",
      "acceptanceCriteria": [
        "Add user section at bottom of sidebar, separated by border-t",
        "Show user avatar (use Clerk user image or Avatar component)",
        "Show user name (from Clerk useUser hook)",
        "Use ShadCN DropdownMenu for user actions",
        "Dropdown items: Profile, Settings, Log Out",
        "Log Out calls Clerk signOut()",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 41,
      "passes": true,
      "notes": "PRD-000: Sidebar User Menu"
    },
    {
      "id": "US-042",
      "title": "Create mobile navigation with Sheet",
      "description": "As a user on mobile, I need navigation that works on small screens.",
      "acceptanceCriteria": [
        "On screens < 768px (md breakpoint), hide desktop sidebar",
        "Add hamburger menu button to Header on mobile (Menu icon)",
        "Clicking hamburger opens ShadCN Sheet from left side",
        "Sheet contains same navigation as desktop sidebar",
        "Clicking nav item closes the sheet",
        "Use Tailwind responsive classes: hidden md:flex, flex md:hidden",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 42,
      "passes": true,
      "notes": "PRD-000: Mobile Navigation"
    },
    {
      "id": "US-043",
      "title": "Create loading.tsx for dashboard",
      "description": "As a user, I need loading states during navigation.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/loading.tsx",
        "Show centered spinner or skeleton during page loads",
        "Use ShadCN Skeleton component or custom spinner",
        "Loading state appears during route transitions",
        "Typecheck passes"
      ],
      "priority": 43,
      "passes": true,
      "notes": "PRD-000: Loading States"
    },
    {
      "id": "US-044",
      "title": "Create error.tsx for dashboard",
      "description": "As a user, I need friendly error handling.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/error.tsx",
        "Mark as 'use client'",
        "Show friendly error message",
        "Show 'Try Again' button that calls reset()",
        "Style with centered layout",
        "Typecheck passes"
      ],
      "priority": 44,
      "passes": true,
      "notes": "PRD-000: Error Handling"
    },
    {
      "id": "US-045",
      "title": "Create global-error.tsx",
      "description": "As a user, I need root-level error handling.",
      "acceptanceCriteria": [
        "Create app/global-error.tsx",
        "Mark as 'use client'",
        "Renders own html and body tags (required for global errors)",
        "Show friendly error message with reload button",
        "Typecheck passes"
      ],
      "priority": 45,
      "passes": true,
      "notes": "PRD-000: Error Handling"
    },
    {
      "id": "US-046",
      "title": "Configure custom theme colors",
      "description": "As a developer, I need brand colors.",
      "acceptanceCriteria": [
        "Update CSS variables in globals.css for primary color (blue tone)",
        "Primary color: hsl(221, 83%, 53%) or similar brand blue",
        "Update destructive, muted, accent as needed",
        "Active states and primary buttons use brand color",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 46,
      "passes": true,
      "notes": "PRD-000: Theming"
    },
    {
      "id": "US-047",
      "title": "Create not-found.tsx page",
      "description": "As a user, I need a 404 page for unknown routes.",
      "acceptanceCriteria": [
        "Create app/not-found.tsx",
        "Show '404 - Page Not Found' message",
        "Show link to go back to home/tickets",
        "Styled consistently with app",
        "Typecheck passes"
      ],
      "priority": 47,
      "passes": true,
      "notes": "PRD-000: 404 Page"
    },
    {
      "id": "US-048",
      "title": "Create UserProfilePage with Clerk UserProfile",
      "description": "As a user, I need to manage my profile.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/profile/page.tsx",
        "Page uses Clerk UserProfile component",
        "Page is centered with max-width container",
        "Update sidebar Profile link to navigate to /profile",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 48,
      "passes": true,
      "notes": "PRD-001: User Profile"
    },
    {
      "id": "US-049",
      "title": "Create env.example and document setup",
      "description": "As a developer, I need documentation for environment setup.",
      "acceptanceCriteria": [
        "Create or update .env.example with all required variables",
        "Include: NEXT_PUBLIC_CONVEX_URL, NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, CLERK_SECRET_KEY, CLERK_WEBHOOK_SECRET",
        "All values should be placeholders like 'your_key_here'",
        "Typecheck passes"
      ],
      "priority": 49,
      "passes": true,
      "notes": "PRD-000: Configuration"
    },
    {
      "id": "US-050",
      "title": "Create README with setup instructions",
      "description": "As a developer, I need documentation to set up the project.",
      "acceptanceCriteria": [
        "Create or update README.md",
        "Document prerequisites (Node.js, npm)",
        "Document environment variable setup",
        "Document Clerk configuration steps",
        "Document Convex setup steps",
        "Document how to run: npm install, npx convex dev, npm run dev",
        "Document folder structure overview",
        "Typecheck passes"
      ],
      "priority": 50,
      "passes": true,
      "notes": "PRD-000: Documentation"
    },
    {
      "id": "US-051",
      "title": "Add workItems table to Convex schema",
      "description": "As a developer, I need a database table to store work items.",
      "acceptanceCriteria": [
        "Add workItems table to convex/schema.ts",
        "Fields: name (string), workType (string), status (string), assigneeId (optional string), clientId (string), clientGroupId (optional string), templateId (optional string), startDate (optional number), dueDate (optional number), deadline (optional number), completedDate (optional number), progress (number default 0), budgetHours (optional number), budgetUSD (optional number), fees (optional number), feeType (string default 'TimeAndMaterials'), createdAt (number), updatedAt (number)",
        "Add index on status field",
        "Add index on clientId field",
        "Add index on assigneeId field",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 51,
      "passes": true,
      "notes": "PRD-003: Work Module - Schema"
    },
    {
      "id": "US-052",
      "title": "Add workTemplates table to Convex schema",
      "description": "As a developer, I need a database table to store work templates.",
      "acceptanceCriteria": [
        "Add workTemplates table to convex/schema.ts",
        "Fields: name (string), description (optional string), workType (string), lastPublishedBy (optional string), dateAdded (number), lastEdited (number), timesUsed (number default 0), isDraft (boolean default true)",
        "Add index on workType field",
        "Add index on isDraft field",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 52,
      "passes": true,
      "notes": "PRD-003: Work Module - Schema"
    },
    {
      "id": "US-053",
      "title": "Add templateSections table to Convex schema",
      "description": "As a developer, I need a database table to store template sections.",
      "acceptanceCriteria": [
        "Add templateSections table to convex/schema.ts",
        "Fields: templateId (id referencing workTemplates), name (string), description (optional string), order (number)",
        "Add index on templateId field",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 53,
      "passes": true,
      "notes": "PRD-003: Work Module - Schema"
    },
    {
      "id": "US-054",
      "title": "Add templateTasks table to Convex schema",
      "description": "As a developer, I need a database table to store template tasks.",
      "acceptanceCriteria": [
        "Add templateTasks table to convex/schema.ts",
        "Fields: templateId (id referencing workTemplates), sectionId (id referencing templateSections), name (string), description (optional string), assignedRole (string), order (number)",
        "Add index on templateId field",
        "Add index on sectionId field",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 54,
      "passes": true,
      "notes": "PRD-003: Work Module - Schema"
    },
    {
      "id": "US-055",
      "title": "Add workItemTasks table to Convex schema",
      "description": "As a developer, I need a database table to store work item tasks.",
      "acceptanceCriteria": [
        "Add workItemTasks table to convex/schema.ts",
        "Fields: workId (id referencing workItems), sectionId (optional string), name (string), description (optional string), assignedRole (optional string), assignedUserId (optional string), status (string default 'active'), dueDate (optional number), completedDate (optional number), createdAt (number), updatedAt (number)",
        "Add index on workId field",
        "Add index on status field",
        "Add index on assignedUserId field",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 55,
      "passes": true,
      "notes": "PRD-003: Work Module - Schema"
    },
    {
      "id": "US-056",
      "title": "Create listWorkItems query",
      "description": "As a developer, I need to fetch all work items.",
      "acceptanceCriteria": [
        "Create convex/workItems.ts file",
        "Create listWorkItems query that returns all work items",
        "Query accepts optional filters: status, clientId, assigneeId",
        "Query returns work items sorted by dueDate ascending",
        "Query requires authentication (ctx.auth.getUserIdentity)",
        "Typecheck passes"
      ],
      "priority": 56,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-057",
      "title": "Create getWorkItem query",
      "description": "As a developer, I need to fetch a single work item by ID.",
      "acceptanceCriteria": [
        "Add getWorkItem query to convex/workItems.ts",
        "Query accepts workId parameter",
        "Query returns the work item or null if not found",
        "Query requires authentication",
        "Typecheck passes"
      ],
      "priority": 57,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-058",
      "title": "Create createWorkItem mutation",
      "description": "As a developer, I need to create new work items.",
      "acceptanceCriteria": [
        "Add createWorkItem mutation to convex/workItems.ts",
        "Mutation accepts: name, workType, clientId, and optional fields (dueDate, assigneeId, budgetHours, budgetUSD, templateId)",
        "Mutation sets status to 'planned', progress to 0, createdAt and updatedAt to Date.now()",
        "Mutation returns the new work item ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 58,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-059",
      "title": "Create updateWorkItem mutation",
      "description": "As a developer, I need to update work items.",
      "acceptanceCriteria": [
        "Add updateWorkItem mutation to convex/workItems.ts",
        "Mutation accepts workId and partial work item fields",
        "Mutation updates only the provided fields",
        "Mutation sets updatedAt to Date.now()",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 59,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-060",
      "title": "Create deleteWorkItem mutation",
      "description": "As a developer, I need to delete work items.",
      "acceptanceCriteria": [
        "Add deleteWorkItem mutation to convex/workItems.ts",
        "Mutation accepts workId parameter",
        "Mutation deletes the work item",
        "Mutation also deletes all associated workItemTasks",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 60,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-061",
      "title": "Create listTemplates query",
      "description": "As a developer, I need to fetch all work templates.",
      "acceptanceCriteria": [
        "Create convex/workTemplates.ts file",
        "Create listTemplates query that returns all templates",
        "Query accepts optional filter: isDraft (boolean)",
        "Query returns templates sorted by name ascending",
        "Query requires authentication",
        "Typecheck passes"
      ],
      "priority": 61,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-062",
      "title": "Create getTemplate query with sections and tasks",
      "description": "As a developer, I need to fetch a template with all its sections and tasks.",
      "acceptanceCriteria": [
        "Add getTemplate query to convex/workTemplates.ts",
        "Query accepts templateId parameter",
        "Query returns template with nested sections array",
        "Each section includes nested tasks array",
        "Sections sorted by order field",
        "Tasks within each section sorted by order field",
        "Typecheck passes"
      ],
      "priority": 62,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-063",
      "title": "Create createTemplate mutation",
      "description": "As a developer, I need to create new work templates.",
      "acceptanceCriteria": [
        "Add createTemplate mutation to convex/workTemplates.ts",
        "Mutation accepts: name, workType, and optional description",
        "Mutation sets isDraft to true, timesUsed to 0",
        "Mutation sets dateAdded and lastEdited to Date.now()",
        "Mutation returns the new template ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 63,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-064",
      "title": "Create updateTemplate mutation",
      "description": "As a developer, I need to update work templates.",
      "acceptanceCriteria": [
        "Add updateTemplate mutation to convex/workTemplates.ts",
        "Mutation accepts templateId and partial template fields (name, description, workType)",
        "Mutation updates only the provided fields",
        "Mutation sets lastEdited to Date.now()",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 64,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-065",
      "title": "Create deleteTemplate mutation",
      "description": "As a developer, I need to delete work templates.",
      "acceptanceCriteria": [
        "Add deleteTemplate mutation to convex/workTemplates.ts",
        "Mutation accepts templateId parameter",
        "Mutation deletes the template",
        "Mutation deletes all associated templateSections",
        "Mutation deletes all associated templateTasks",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 65,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-066",
      "title": "Create publishTemplate mutation",
      "description": "As a developer, I need to publish a template to make it available for use.",
      "acceptanceCriteria": [
        "Add publishTemplate mutation to convex/workTemplates.ts",
        "Mutation accepts templateId parameter",
        "Mutation sets isDraft to false",
        "Mutation sets lastPublishedBy to current user ID",
        "Mutation sets lastEdited to Date.now()",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 66,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-067",
      "title": "Create addTemplateSection mutation",
      "description": "As a developer, I need to add sections to templates.",
      "acceptanceCriteria": [
        "Add addTemplateSection mutation to convex/workTemplates.ts",
        "Mutation accepts: templateId, name, and optional description",
        "Mutation auto-calculates order as max(existing orders) + 1",
        "Mutation returns the new section ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 67,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-068",
      "title": "Create updateTemplateSection mutation",
      "description": "As a developer, I need to update template sections.",
      "acceptanceCriteria": [
        "Add updateTemplateSection mutation to convex/workTemplates.ts",
        "Mutation accepts sectionId and partial fields (name, description)",
        "Mutation updates only the provided fields",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 68,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-069",
      "title": "Create deleteTemplateSection mutation",
      "description": "As a developer, I need to delete template sections.",
      "acceptanceCriteria": [
        "Add deleteTemplateSection mutation to convex/workTemplates.ts",
        "Mutation accepts sectionId parameter",
        "Mutation deletes the section",
        "Mutation deletes all tasks in that section",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 69,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-070",
      "title": "Create addTemplateTask mutation",
      "description": "As a developer, I need to add tasks to template sections.",
      "acceptanceCriteria": [
        "Add addTemplateTask mutation to convex/workTemplates.ts",
        "Mutation accepts: templateId, sectionId, name, assignedRole, and optional description",
        "Mutation auto-calculates order as max(existing orders in section) + 1",
        "Mutation returns the new task ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 70,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-071",
      "title": "Create updateTemplateTask mutation",
      "description": "As a developer, I need to update template tasks.",
      "acceptanceCriteria": [
        "Add updateTemplateTask mutation to convex/workTemplates.ts",
        "Mutation accepts taskId and partial fields (name, description, assignedRole)",
        "Mutation updates only the provided fields",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 71,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-072",
      "title": "Create deleteTemplateTask mutation",
      "description": "As a developer, I need to delete template tasks.",
      "acceptanceCriteria": [
        "Add deleteTemplateTask mutation to convex/workTemplates.ts",
        "Mutation accepts taskId parameter",
        "Mutation deletes the task",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 72,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-073",
      "title": "Create listWorkItemTasks query",
      "description": "As a developer, I need to fetch tasks for a work item.",
      "acceptanceCriteria": [
        "Create convex/workItemTasks.ts file",
        "Create listWorkItemTasks query that accepts workId",
        "Query returns all tasks for the work item",
        "Query requires authentication",
        "Typecheck passes"
      ],
      "priority": 73,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-074",
      "title": "Create createWorkItemTask mutation",
      "description": "As a developer, I need to create tasks within work items.",
      "acceptanceCriteria": [
        "Add createWorkItemTask mutation to convex/workItemTasks.ts",
        "Mutation accepts: workId, name, and optional fields (description, assignedRole, assignedUserId, dueDate)",
        "Mutation sets status to 'active', createdAt and updatedAt to Date.now()",
        "Mutation returns the new task ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 74,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-075",
      "title": "Create updateWorkItemTask mutation",
      "description": "As a developer, I need to update work item tasks.",
      "acceptanceCriteria": [
        "Add updateWorkItemTask mutation to convex/workItemTasks.ts",
        "Mutation accepts taskId and partial task fields",
        "Mutation updates only the provided fields",
        "Mutation sets updatedAt to Date.now()",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 75,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-076",
      "title": "Create completeTask mutation with progress update",
      "description": "As a developer, I need to mark tasks complete and update work progress.",
      "acceptanceCriteria": [
        "Add completeTask mutation to convex/workItemTasks.ts",
        "Mutation accepts taskId parameter",
        "Mutation sets task status to 'completed' and completedDate to Date.now()",
        "Mutation recalculates parent work item progress (completed tasks / total tasks * 100)",
        "Mutation updates work item progress field",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 76,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-077",
      "title": "Create createWorkFromTemplate mutation",
      "description": "As a developer, I need to create a work item from a template.",
      "acceptanceCriteria": [
        "Add createWorkFromTemplate mutation to convex/workItems.ts",
        "Mutation accepts: templateId, name, clientId, and optional fields (dueDate, assigneeId)",
        "Mutation creates work item with template's workType",
        "Mutation creates all tasks from template sections and tasks",
        "Mutation increments template's timesUsed counter",
        "Mutation returns the new work item ID",
        "Mutation requires authentication",
        "Typecheck passes"
      ],
      "priority": 77,
      "passes": true,
      "notes": "PRD-003: Work Module - Backend"
    },
    {
      "id": "US-078",
      "title": "Create useWorkItems hook",
      "description": "As a developer, I need easy access to work items data in components.",
      "acceptanceCriteria": [
        "Create hooks/use-work-items.ts",
        "Hook uses useQuery to call listWorkItems",
        "Hook accepts optional filters object",
        "Hook returns { workItems, isLoading } object",
        "Mark file as 'use client'",
        "Typecheck passes"
      ],
      "priority": 78,
      "passes": true,
      "notes": "PRD-003: Work Module - Hooks"
    },
    {
      "id": "US-079",
      "title": "Create useWorkItem hook",
      "description": "As a developer, I need easy access to a single work item.",
      "acceptanceCriteria": [
        "Create hooks/use-work-item.ts",
        "Hook uses useQuery to call getWorkItem",
        "Hook accepts workId parameter",
        "Hook returns { workItem, isLoading } object",
        "Mark file as 'use client'",
        "Typecheck passes"
      ],
      "priority": 79,
      "passes": true,
      "notes": "PRD-003: Work Module - Hooks"
    },
    {
      "id": "US-080",
      "title": "Update Work page with work items table",
      "description": "As a user, I need to see work items in a table on the Work page.",
      "acceptanceCriteria": [
        "Update app/(dashboard)/work/page.tsx",
        "Page fetches work items using useWorkItems hook",
        "Page displays ShadCN Table component",
        "Table has columns: Name, Client, Status, Due Date, Progress",
        "Show loading skeleton while data loads",
        "Show 'No work items yet' message when empty",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 80,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-081",
      "title": "Create WorkItemRow component",
      "description": "As a user, I need clickable work item rows in the table.",
      "acceptanceCriteria": [
        "Create components/work/work-item-row.tsx",
        "Component renders a TableRow with work item data",
        "Row is clickable and navigates to /work/[workId]",
        "Status displayed as ShadCN Badge with appropriate color",
        "Progress displayed as percentage",
        "Due date formatted nicely (e.g., 'Jan 15, 2026')",
        "Typecheck passes"
      ],
      "priority": 81,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-082",
      "title": "Create Work page header with Add Work button",
      "description": "As a user, I need a header with an Add Work button on the Work page.",
      "acceptanceCriteria": [
        "Create components/work/work-page-header.tsx",
        "Component shows 'Work' as page title",
        "Component has 'Add Work' button on the right",
        "Button uses ShadCN Button with Plus icon",
        "Button click shows toast 'Create work modal coming soon' for now",
        "Add header component to Work page",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 82,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-083",
      "title": "Add status filter dropdown to Work page",
      "description": "As a user, I need to filter work items by status.",
      "acceptanceCriteria": [
        "Add ShadCN Select component to work page header",
        "Select options: All, Planned, In Progress, Review, Complete",
        "Selecting a status filters the work items list",
        "Filter state stored in component state",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 83,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-084",
      "title": "Create work item detail page route",
      "description": "As a user, I need a detail page for each work item.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/work/[workId]/page.tsx",
        "Page accepts workId from URL params",
        "Page fetches work item using useWorkItem hook",
        "Page shows loading skeleton while fetching",
        "Page shows 'Work item not found' if not found",
        "Page shows work item name as title when loaded",
        "Typecheck passes"
      ],
      "priority": 84,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-085",
      "title": "Create WorkItemHeader component",
      "description": "As a user, I need to see work item details in a header.",
      "acceptanceCriteria": [
        "Create components/work/work-item-header.tsx",
        "Component accepts workItem as prop",
        "Component displays work item name as heading",
        "Component displays status as Badge",
        "Component displays client name",
        "Component displays due date",
        "Add back button that navigates to /work",
        "Typecheck passes"
      ],
      "priority": 85,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-086",
      "title": "Create WorkItemTabs component",
      "description": "As a user, I need tabs to navigate work item sections.",
      "acceptanceCriteria": [
        "Create components/work/work-item-tabs.tsx",
        "Component uses ShadCN Tabs component",
        "Tabs: Tasks, Timeline, Time & Budget, Documents, Details",
        "Tasks tab is default/active",
        "Each tab has a TabsContent placeholder",
        "Integrate tabs into work item detail page",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 86,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-087",
      "title": "Create TasksList component for Tasks tab",
      "description": "As a user, I need to see tasks in the Tasks tab.",
      "acceptanceCriteria": [
        "Create components/work/tasks-list.tsx",
        "Component accepts workId as prop",
        "Component fetches tasks using listWorkItemTasks query",
        "Component displays tasks in a list format",
        "Each task shows: name, status, assigned role",
        "Show 'No tasks yet' when empty",
        "Typecheck passes"
      ],
      "priority": 87,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-088",
      "title": "Add task completion checkbox to TasksList",
      "description": "As a user, I need to mark tasks as complete.",
      "acceptanceCriteria": [
        "Add ShadCN Checkbox to each task row",
        "Checkbox is checked if task status is 'completed'",
        "Clicking checkbox calls completeTask mutation",
        "Task row shows strikethrough when completed",
        "Checkbox is disabled while mutation is pending",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 88,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-089",
      "title": "Create TimeBudgetTab component",
      "description": "As a user, I need to see time and budget information.",
      "acceptanceCriteria": [
        "Create components/work/time-budget-tab.tsx",
        "Component accepts workItem as prop",
        "Component displays Budget (USD) from workItem.budgetUSD",
        "Component displays Budget (Hours) from workItem.budgetHours",
        "Component displays placeholder for 'Actual Time: 0h' (time tracking integration later)",
        "Use ShadCN Card components for layout",
        "Typecheck passes"
      ],
      "priority": 89,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-090",
      "title": "Create TimelineTab placeholder component",
      "description": "As a user, I need a timeline tab for activity.",
      "acceptanceCriteria": [
        "Create components/work/timeline-tab.tsx",
        "Component accepts workId as prop",
        "Component shows placeholder: 'Timeline activity will appear here'",
        "Component has space for future activity feed implementation",
        "Typecheck passes"
      ],
      "priority": 90,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-091",
      "title": "Create DetailsTab component",
      "description": "As a user, I need to see work item details and metadata.",
      "acceptanceCriteria": [
        "Create components/work/details-tab.tsx",
        "Component accepts workItem as prop",
        "Component displays: Work Type, Created Date, Last Updated",
        "Component displays: Assignee (or 'Unassigned')",
        "Component displays: Fee Type (Time & Materials or Fixed Fee)",
        "Use definition list or card layout",
        "Typecheck passes"
      ],
      "priority": 91,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-092",
      "title": "Create CreateWorkDialog component",
      "description": "As a user, I need a dialog to create new work items.",
      "acceptanceCriteria": [
        "Create components/work/create-work-dialog.tsx",
        "Component uses ShadCN Dialog component",
        "Dialog has form fields: Name (required), Client (select), Work Type (select), Due Date (date picker)",
        "Dialog has Cancel and Create buttons",
        "Form validates required fields",
        "Create button is disabled while fields are invalid",
        "Typecheck passes"
      ],
      "priority": 92,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-093",
      "title": "Integrate CreateWorkDialog with mutation",
      "description": "As a user, I need the create work dialog to save work items.",
      "acceptanceCriteria": [
        "CreateWorkDialog calls createWorkItem mutation on submit",
        "Dialog closes on successful creation",
        "Toast shows 'Work item created' on success",
        "Toast shows error message on failure",
        "Form resets after successful creation",
        "Connect Add Work button to open the dialog",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 93,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-094",
      "title": "Create Templates page route",
      "description": "As an admin, I need a page to manage work templates.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/templates/page.tsx",
        "Page shows 'Templates' as page title",
        "Page fetches templates using listTemplates query",
        "Page displays templates in a table or card grid",
        "Each template shows: name, work type, times used, draft status",
        "Show loading skeleton while fetching",
        "Typecheck passes"
      ],
      "priority": 94,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-095",
      "title": "Add navigation link to Templates page",
      "description": "As an admin, I need to navigate to the Templates page.",
      "acceptanceCriteria": [
        "Add 'Templates' item to Settings page or as sub-nav under Settings",
        "Link navigates to /settings/templates",
        "Use FileText or Layout icon from Lucide",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 95,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-096",
      "title": "Create Template detail page route",
      "description": "As an admin, I need a page to view and edit a template.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/templates/[templateId]/page.tsx",
        "Page accepts templateId from URL params",
        "Page fetches template with sections and tasks using getTemplate query",
        "Page shows loading skeleton while fetching",
        "Page shows 'Template not found' if not found",
        "Page shows template name as title when loaded",
        "Typecheck passes"
      ],
      "priority": 96,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-097",
      "title": "Create TemplateEditor component structure",
      "description": "As an admin, I need to edit template structure.",
      "acceptanceCriteria": [
        "Create components/templates/template-editor.tsx",
        "Component accepts template (with sections and tasks) as prop",
        "Component displays template name and description (editable)",
        "Component displays sections in a list",
        "Component has 'Add Section' button",
        "Typecheck passes"
      ],
      "priority": 97,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-098",
      "title": "Create TemplateSectionCard component",
      "description": "As an admin, I need to view and edit template sections.",
      "acceptanceCriteria": [
        "Create components/templates/template-section-card.tsx",
        "Component accepts section (with tasks) as prop",
        "Component displays section name (editable inline)",
        "Component displays tasks within the section",
        "Component has 'Add Task' button",
        "Component has delete section button (trash icon)",
        "Typecheck passes"
      ],
      "priority": 98,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-099",
      "title": "Create TemplateTaskItem component",
      "description": "As an admin, I need to view and edit template tasks.",
      "acceptanceCriteria": [
        "Create components/templates/template-task-item.tsx",
        "Component accepts task as prop",
        "Component displays task name (editable inline)",
        "Component displays assigned role",
        "Component has role selection dropdown",
        "Component has delete task button (X icon)",
        "Typecheck passes"
      ],
      "priority": 99,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-100",
      "title": "Integrate template editing mutations",
      "description": "As an admin, I need template edits to be saved.",
      "acceptanceCriteria": [
        "TemplateEditor calls updateTemplate mutation when name/description changes",
        "TemplateSectionCard calls addTemplateSection when Add Section clicked",
        "TemplateSectionCard calls updateTemplateSection when section name edited",
        "TemplateSectionCard calls deleteTemplateSection when delete clicked",
        "TemplateTaskItem calls updateTemplateTask when task edited",
        "TemplateTaskItem calls deleteTemplateTask when delete clicked",
        "Show toast notifications for save operations",
        "Typecheck passes"
      ],
      "priority": 100,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-101",
      "title": "Add publish template functionality",
      "description": "As an admin, I need to publish templates.",
      "acceptanceCriteria": [
        "Add 'Publish' button to TemplateEditor component",
        "Button only shown if template.isDraft is true",
        "Clicking button calls publishTemplate mutation",
        "Show confirmation dialog before publishing",
        "Toast shows 'Template published' on success",
        "Button changes to 'Published' (disabled) after publishing",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 101,
      "passes": true,
      "notes": "PRD-003: Work Module - UI"
    },
    {
      "id": "US-102",
      "title": "Complete template creation and selection flow",
      "description": "As a user/admin, I need to create new templates and use them when creating work items.",
      "acceptanceCriteria": [
        "Create components/templates/create-template-dialog.tsx with form fields: Name (required), Work Type (required), Description (optional)",
        "CreateTemplateDialog has Cancel and Create buttons, Create calls createTemplate mutation",
        "Dialog closes and navigates to template detail page on success",
        "Add 'Create Template' button to Templates page header that opens CreateTemplateDialog",
        "Add 'Use Template' optional select to CreateWorkDialog",
        "Template select shows published templates only (isDraft: false)",
        "When template selected, work type is auto-filled from template",
        "Form submission calls createWorkFromTemplate if template selected, createWorkItem if no template",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 102,
      "passes": true,
      "notes": "PRD-003: Work Module - UI. Combines template creation dialog and template selection in work creation."
    },
    {
      "id": "US-103",
      "title": "Add work item progress and status UI",
      "description": "As a user, I need to see work item progress visually and change status.",
      "acceptanceCriteria": [
        "Add progress bar to WorkItemRow showing progress percentage",
        "Add progress bar to WorkItemHeader showing progress percentage",
        "Use ShadCN Progress component or custom progress bar",
        "Progress bar color: green > 66%, yellow 33-66%, red < 33%",
        "Display percentage text next to progress bar",
        "Add status dropdown to WorkItemHeader with options: Planned, In Progress, Review, Complete",
        "Selecting status calls updateWorkItem mutation",
        "If Complete selected, set completedDate to Date.now()",
        "Toast shows 'Status updated' on success",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 103,
      "passes": true,
      "notes": "PRD-003: Work Module - UI. Combines progress display and status update functionality."
    },
    {
      "id": "US-104",
      "title": "Add work item sections schema and backend operations",
      "description": "As a developer, I need database tables and backend operations for organizing tasks into sections within work items.",
      "acceptanceCriteria": [
        "Add workItemSections table to convex/schema.ts with fields: workId (id), name (string), description (optional string), order (number), isCollapsed (boolean default false), createdAt (number), updatedAt (number)",
        "Add index on workId field",
        "Add sectionId field to workItemTasks table (optional string, references workItemSections)",
        "Add order field to workItemTasks table (number, for ordering within section)",
        "Create convex/workItemSections.ts file",
        "Create listWorkItemSections query that accepts workId and returns sections sorted by order",
        "Create createWorkItemSection mutation (workId, name, optional description, auto-calculates order)",
        "Create updateWorkItemSection mutation (sectionId, partial fields: name, description, isCollapsed)",
        "Create deleteWorkItemSection mutation (sectionId, cascade deletes tasks or moves to uncategorized based on flag)",
        "Create reorderWorkItemSections mutation (workId, sectionIds array in new order)",
        "Update createWorkItemTask mutation to accept optional sectionId and order",
        "Create reorderWorkItemTasks mutation (workId, taskIds array in new order, optional sectionId)",
        "All mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 104,
      "passes": true,
      "notes": "PRD-003: US-021 - Schema and backend for work item sections"
    },
    {
      "id": "US-105",
      "title": "Add automator schema and backend operations",
      "description": "As a developer, I need database tables and backend operations for automating recurring work creation.",
      "acceptanceCriteria": [
        "Add automators table to convex/schema.ts with fields: sectionId (id referencing templateSections), templateId (id), tenantId (string), name (string), scheduleType (string: Monthly|Quarterly|Annually|EndOfMonth|CustomCRON), scheduleConfig (object with dayOfMonth, months, month, cronExpression, daysBeforeEOM), leadTimeDays (number), clientFilter (object with type: all|clientGroups|clients, clientGroupIds array, clientIds array), isActive (boolean default true), lastRunAt (optional number), nextRunAt (optional number), createdAt (number), updatedAt (number)",
        "Add index on templateId field",
        "Add index on sectionId field",
        "Add index on isActive field",
        "Create convex/automators.ts file",
        "Create listAutomators query (accepts templateId or sectionId filter)",
        "Create getAutomator query (automatorId)",
        "Create createAutomator mutation (sectionId, templateId, name, scheduleType, scheduleConfig, leadTimeDays, clientFilter)",
        "Create updateAutomator mutation (automatorId, partial fields)",
        "Create deleteAutomator mutation (automatorId)",
        "Create runAutomator action (automatorId) for manual triggering",
        "All queries/mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 105,
      "passes": true,
      "notes": "PRD-003: US-029 - Schema and backend for automators"
    },
    {
      "id": "US-106",
      "title": "Add work item edit and delete UI",
      "description": "As a user, I need to edit and delete work items from the detail view.",
      "acceptanceCriteria": [
        "Add actions dropdown menu (\u22ee) to WorkItemHeader component",
        "Add 'Edit' option that enables inline editing mode",
        "Make work item fields editable inline: Name, Status, Due Date, Deadline, Assignee, Client, Budget Hours, Budget USD, Fee Type",
        "Required fields show asterisk indicator",
        "Validation: Name required, due date <= deadline",
        "Save button appears in edit mode, calls updateWorkItem mutation",
        "Cancel button discards changes",
        "Show confirmation dialog before navigating away with unsaved changes",
        "Add 'Delete Work Item' option to actions dropdown",
        "Delete shows confirmation dialog with impact count (tasks to delete, time entries to unlink)",
        "Confirmation dialog has destructive Delete button",
        "Delete calls deleteWorkItem mutation, redirects to /work, shows success toast",
        "Success toast: 'Work item updated' for edit, 'Work item deleted' for delete",
        "Error toast shows specific validation messages",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 106,
      "passes": true,
      "notes": "PRD-003: US-016, US-017 - Work item edit and delete UI"
    },
    {
      "id": "US-107",
      "title": "Add task management UI (add, edit, delete with undo)",
      "description": "As a user, I need to add, edit, and delete tasks within work items.",
      "acceptanceCriteria": [
        "Add 'Add Task' button to TasksList component header",
        "Clicking shows inline form with task name input (required) and optional section dropdown",
        "Form has checkmark (save) and X (cancel) icons",
        "Pressing Enter saves task, Escape cancels",
        "New task appears with 'Active' status, work item progress recalculates",
        "Focus moves to task name input after save for quick multi-add",
        "Empty task name shows validation error",
        "Make task rows clickable to expand inline edit form",
        "Editable fields: name, description, assignee, due date, section",
        "Changes auto-save on blur (debounced 500ms) via updateWorkItemTask mutation",
        "Show 'Saving...' indicator during save",
        "Escape key cancels unsaved changes and collapses",
        "Add delete icon (trash) that appears on task row hover",
        "Delete immediately removes task (no confirmation), calls deleteWorkItemTask mutation",
        "Task fades out with animation, progress updates",
        "Show undo toast: 'Task deleted' with 'Undo' button (available 5 seconds)",
        "Undo restores task via createWorkItemTask mutation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 107,
      "passes": true,
      "notes": "PRD-003: US-018, US-019, US-020 - Task management UI"
    },
    {
      "id": "US-108",
      "title": "Add work item sections UI (create, edit, delete, reorder)",
      "description": "As a user, I need to organize tasks into sections within work items.",
      "acceptanceCriteria": [
        "Add 'Add Section' button next to 'Add Task' in Tasks tab header",
        "Clicking shows inline input for section name",
        "Pressing Enter creates section via createWorkItemSection mutation",
        "Sections display as collapsible groups with header bar",
        "Section header shows: drag handle, name (editable inline), task count, collapse toggle, actions menu (\u22ee)",
        "Sections can be collapsed/expanded (state persists via updateWorkItemSection)",
        "Clicking section name enables inline edit",
        "Section name required, validation error if empty",
        "Sections can be reordered via drag-and-drop (calls reorderWorkItemSections)",
        "Delete section shows confirmation dialog if contains tasks: 'Delete section [Name]? Choose what to do with X tasks:'",
        "Delete options: 'Move to Uncategorized' (default) or 'Delete tasks'",
        "Empty sections delete without confirmation",
        "Tasks can be dragged between sections (calls reorderWorkItemTasks)",
        "Empty section shows: 'No tasks in this section. Drag tasks here or add new ones.'",
        "'Uncategorized' section appears automatically if tasks exist without a section",
        "Use @dnd-kit/core for drag-and-drop functionality",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 108,
      "passes": true,
      "notes": "PRD-003: US-021 - Work item sections UI"
    },
    {
      "id": "US-109",
      "title": "Enhance template library with sorting, filtering, and search",
      "description": "As a user, I need to find templates easily with sorting, filtering, and search.",
      "acceptanceCriteria": [
        "Update Templates page table to be sortable by all columns (Name, Work Type, Status, Times Used, Last Edited)",
        "Default sort: Last Edited descending",
        "Add filter dropdown for Work Type (shows all work types from templates)",
        "Add search input that filters templates by name (client-side or server-side filter)",
        "Search input has clear button (X icon) when text entered",
        "Filters and search update table results instantly",
        "Status badge shows 'Draft' (yellow) or 'Published' (green)",
        "Click row navigates to template detail page",
        "Actions dropdown on each row shows: Edit, Delete",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 109,
      "passes": true,
      "notes": "PRD-003: US-022 - Template library enhancements"
    },
    {
      "id": "US-110",
      "title": "Enhance template editing with auto-save and warnings",
      "description": "As an admin, I need template edits to auto-save with warnings for active templates.",
      "acceptanceCriteria": [
        "Template editor auto-saves changes as draft (debounced, calls updateTemplate mutation)",
        "Show 'Last saved' timestamp that updates after each save",
        "Show 'Saving...' indicator during save operation",
        "Add warning banner at top of editor if template is used by active work items: 'This template is used by X active work items. Changes will not affect existing work.'",
        "Query active work items count for template (workItems where templateId matches and status != 'Complete')",
        "Show unsaved changes confirmation dialog before navigating away",
        "Track unsaved changes state (compare current form state to last saved state)",
        "Confirmation dialog: 'You have unsaved changes. Are you sure you want to leave?'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 110,
      "passes": true,
      "notes": "PRD-003: US-023 - Template editing enhancements"
    },
    {
      "id": "US-111",
      "title": "Add template delete UI with confirmation",
      "description": "As an admin, I need to delete templates with proper confirmation and warnings.",
      "acceptanceCriteria": [
        "Add 'Delete' option to template actions dropdown in library",
        "Add 'Delete Template' button to template editor header",
        "Delete shows confirmation dialog: 'Delete Template'",
        "Dialog message: 'Are you sure you want to delete '[Template Name]'? This template has been used X times.'",
        "Query template.timesUsed for usage count",
        "If template has active work items, show additional warning: 'X active work items were created from this template. They will not be affected.'",
        "Query active work items count",
        "Dialog has Cancel and Delete buttons",
        "Delete button is destructive styled (red)",
        "Delete calls deleteTemplate mutation",
        "Success toast: 'Template deleted'",
        "Redirects to template library after deletion",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 111,
      "passes": true,
      "notes": "PRD-003: US-024 - Template delete UI"
    },
    {
      "id": "US-112",
      "title": "Enhance template section and task editing with descriptions and improved UX",
      "description": "As an admin, I need better template section and task editing with descriptions and role management.",
      "acceptanceCriteria": [
        "Template section header name is editable inline (click to edit)",
        "Add description field below section name (optional, editable inline)",
        "Section description shown below name when present",
        "Template task row expands to show full edit form when clicked",
        "Editable fields: name (required), description (optional multi-line), assigned role",
        "Role dropdown shows predefined roles: Preparer 1, Preparer 2, Reviewer 1, Reviewer 2, Partner",
        "Role dropdown allows custom role input (combobox/autocomplete)",
        "Task description supports multi-line text",
        "All changes auto-save (debounced) via updateTemplateSection/updateTemplateTask mutations",
        "Show 'Saving...' indicator during save",
        "Delete template section shows confirmation if contains tasks: 'Delete section [Name]? This will also delete X tasks.'",
        "Empty sections delete without confirmation",
        "Delete template task shows undo toast (5 seconds) instead of immediate confirmation",
        "Task fades out with animation on delete",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 112,
      "passes": true,
      "notes": "PRD-003: US-025, US-026, US-027, US-028 - Template section/task editing enhancements"
    },
    {
      "id": "US-113",
      "title": "Add automator configuration UI",
      "description": "As an admin, I need to configure automators for recurring work creation on template sections.",
      "acceptanceCriteria": [
        "Add 'Add Automator' button to template section header (shown if no automator exists)",
        "Clicking opens automator configuration panel/dialog",
        "Panel shows: schedule type dropdown (Monthly, Quarterly, Annually, End of Month, Custom CRON)",
        "Monthly schedule: Day of month picker (1-31 or 'Last' option)",
        "Quarterly schedule: Quarter selector (Q1/Q2/Q3/Q4 checkboxes) + day picker",
        "Annually schedule: Month dropdown + day picker",
        "End of Month schedule: Days before/after EOM input (e.g., '3 days before')",
        "Custom CRON: Text input for CRON expression with validation",
        "Lead time setting: 'Create X days before due date' number input",
        "Client filter: Radio/select with options 'All clients', 'Client groups', 'Specific clients'",
        "If 'Client groups' selected, show multi-select for client groups",
        "If 'Specific clients' selected, show multi-select for clients",
        "Save and Cancel buttons",
        "Save calls createAutomator mutation",
        "Automator badge appears on section header: '\ud83d\udd04 [Schedule Type] - [Details]' (e.g., 'Monthly - Day 15')",
        "Click badge to edit automator (opens same panel with existing values)",
        "Badge has dropdown menu with 'Edit' and 'Delete' options",
        "Delete shows confirmation dialog",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 113,
      "passes": true,
      "notes": "PRD-003: US-029 - Automator configuration UI"
    },
    {
      "id": "US-114",
      "title": "Enhance budget editing with inline editing",
      "description": "As a user, I need to edit work item budgets inline in the Time & Budget tab.",
      "acceptanceCriteria": [
        "Make Budget Hours and Budget USD fields editable inline in TimeBudgetTab component",
        "Clicking field shows input with current value",
        "Input validates: must be non-negative numbers",
        "Changes save on blur via updateWorkItem mutation",
        "Show 'Saving...' indicator during save",
        "Remaining budget recalculates automatically after save",
        "Add timeline activity entry when budget updated: 'Budget updated from X to Y hours' (if hours changed) or 'Budget updated from $X to $Y' (if USD changed)",
        "Create addTimelineActivity mutation or update work item with activity log",
        "Success toast: 'Budget updated'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 114,
      "passes": true,
      "notes": "PRD-003: US-030 - Budget editing enhancements"
    },
    {
      "id": "US-115",
      "title": "Add schema for favorites, archiving, saved views, and task checklists",
      "description": "As a developer, I need database tables for favorites, archiving, saved views, and task checklists.",
      "acceptanceCriteria": [
        "Add userWorkItemFavorites table to convex/schema.ts with fields: userId (string), workId (id referencing workItems), tenantId (string), createdAt (number)",
        "Add index on userId field",
        "Add index on workId field",
        "Add isArchived (boolean default false), archivedAt (optional number), archivedBy (optional string) fields to workItems table",
        "Add sourceWorkId (optional id referencing workItems) field to workItems table for duplication tracking",
        "Add savedViews table to convex/schema.ts with fields: userId (string), tenantId (string), name (string), context (string default 'work'), config (object with viewType, filters array, sortColumn, sortDirection, columnVisibility, columnOrder), order (number), createdAt (number), updatedAt (number)",
        "Add index on userId field",
        "Add index on context field",
        "Add checklistItems array field to workItemTasks table (array of objects with itemId, text, isCompleted, order, completedAt)",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 115,
      "passes": true,
      "notes": "PRD-003: US-031, US-032, US-033, US-035, US-037 - Schema for new features"
    },
    {
      "id": "US-116",
      "title": "Add backend operations for duplicate, favorite, and archive work items",
      "description": "As a developer, I need mutations and queries for duplicating, favoriting, and archiving work items.",
      "acceptanceCriteria": [
        "Add duplicateWorkItem mutation to convex/workItems.ts (workId, options object with includeTasks, includeSections, includeBudget, newClientId, newName)",
        "Mutation creates new work item with sourceWorkId reference, status 'Planned', progress 0",
        "If includeTasks/includeSections true, creates tasks and sections from source",
        "All new tasks have status 'Active'",
        "Mutation returns new work item ID",
        "Add toggleWorkItemFavorite mutation to convex/workItems.ts (workId, isFavorite boolean)",
        "Mutation creates or deletes userWorkItemFavorite record",
        "Add listFavoriteWorkItems query to convex/workItems.ts (returns work items where user has favorite)",
        "Add archiveWorkItem mutation to convex/workItems.ts (workId)",
        "Mutation sets isArchived to true, archivedAt to Date.now(), archivedBy to current userId",
        "Add restoreWorkItem mutation to convex/workItems.ts (workId)",
        "Mutation sets isArchived to false, clears archivedAt and archivedBy",
        "Update listWorkItems query to accept includeArchived boolean filter (default false)",
        "All mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 116,
      "passes": true,
      "notes": "PRD-003: US-031, US-032, US-033, US-034 - Backend for duplicate, favorite, archive"
    },
    {
      "id": "US-117",
      "title": "Add backend operations for saved views",
      "description": "As a developer, I need CRUD operations for saved views.",
      "acceptanceCriteria": [
        "Create convex/savedViews.ts file",
        "Create listSavedViews query (userId, context filter, returns sorted by order)",
        "Create getSavedView query (viewId)",
        "Create createSavedView mutation (name, context, config object, auto-calculates order)",
        "Create updateSavedView mutation (viewId, partial fields: name, config)",
        "Create deleteSavedView mutation (viewId)",
        "Create reorderSavedViews mutation (viewIds array in new order)",
        "Validate view name uniqueness per user",
        "Enforce maximum 20 saved views per user",
        "All queries/mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 117,
      "passes": true,
      "notes": "PRD-003: US-035 - Backend for saved views"
    },
    {
      "id": "US-118",
      "title": "Add backend operations for task checklists",
      "description": "As a developer, I need mutations for managing task checklist items.",
      "acceptanceCriteria": [
        "Add addChecklistItem mutation to convex/workItemTasks.ts (taskId, text, auto-calculates order)",
        "Add updateChecklistItem mutation to convex/workItemTasks.ts (taskId, itemId, partial fields: text, isCompleted)",
        "Add deleteChecklistItem mutation to convex/workItemTasks.ts (taskId, itemId)",
        "Add reorderChecklistItems mutation to convex/workItemTasks.ts (taskId, itemIds array in new order)",
        "Validate maximum 20 checklist items per task",
        "All mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 118,
      "passes": true,
      "notes": "PRD-003: US-037 - Backend for task checklists"
    },
    {
      "id": "US-119",
      "title": "Add bulk operations backend mutations",
      "description": "As a developer, I need mutations for bulk operations on work items.",
      "acceptanceCriteria": [
        "Add bulkUpdateWorkItems mutation to convex/workItems.ts (workIds array, updates object with status, assigneeId, dueDate)",
        "Add bulkArchiveWorkItems mutation to convex/workItems.ts (workIds array)",
        "Add bulkDeleteWorkItems mutation to convex/workItems.ts (workIds array)",
        "Mutations process items in batch and return success/failure counts",
        "Bulk delete cascades to tasks (deletes all associated tasks)",
        "All mutations require authentication",
        "Typecheck passes"
      ],
      "priority": 119,
      "passes": true,
      "notes": "PRD-003: US-036 - Backend for bulk operations"
    },
    {
      "id": "US-120",
      "title": "Add duplicate work item UI",
      "description": "As a user, I need to duplicate work items with options.",
      "acceptanceCriteria": [
        "Add 'Duplicate' option to work item actions dropdown (both list row and detail view)",
        "Clicking opens DuplicateWorkItemDialog component",
        "Dialog shows source work item name",
        "Dialog has checkboxes: 'Include tasks' (default checked), 'Include sections' (default checked), 'Include budget settings' (default checked)",
        "Dialog has client selector (defaults to same client, allows changing)",
        "Dialog has name input (defaults to '[Original Name] (Copy)', editable)",
        "Dialog has Cancel and 'Duplicate' buttons",
        "Duplicate button calls duplicateWorkItem mutation",
        "Success toast: 'Work item duplicated'",
        "Navigate to new work item detail view on success",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 120,
      "passes": true,
      "notes": "PRD-003: US-031 - Duplicate work item UI"
    },
    {
      "id": "US-121",
      "title": "Add favorites UI (star icon and filter)",
      "description": "As a user, I need to favorite work items and filter by favorites.",
      "acceptanceCriteria": [
        "Add star icon (outline when not favorited, filled when favorited) to WorkItemRow component (left side, before name)",
        "Add star icon to WorkItemHeader component (near title)",
        "Add star icon to kanban cards (top-right corner)",
        "Single click toggles favorite via toggleWorkItemFavorite mutation",
        "Optimistic UI update (instant visual feedback, no toast)",
        "Add 'Favorites' filter option to work list filters",
        "Filter shows only favorited items when selected",
        "Use Star icon from Lucide (Star for filled, StarOff for outline)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 121,
      "passes": true,
      "notes": "PRD-003: US-032 - Favorites UI"
    },
    {
      "id": "US-122",
      "title": "Add archive and restore work item UI",
      "description": "As a user, I need to archive and restore work items.",
      "acceptanceCriteria": [
        "Add 'Archive' option to work item actions dropdown (both list row and detail view)",
        "Single click archives immediately via archiveWorkItem mutation (no confirmation)",
        "Show undo toast: 'Work item archived' with 'Undo' button (5 seconds)",
        "Undo calls restoreWorkItem mutation",
        "Add 'Include Archived' toggle/filter to work list",
        "When enabled, shows archived items with muted colors and 'Archived' badge",
        "Archived items are read-only (disable edit/delete actions)",
        "Show banner on archived item detail page: 'This work item is archived'",
        "Replace 'Archive' with 'Restore' option in actions menu for archived items",
        "Restore shows success toast: 'Work item restored'",
        "Update listWorkItems query call to pass includeArchived filter",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 122,
      "passes": true,
      "notes": "PRD-003: US-033, US-034 - Archive and restore UI"
    },
    {
      "id": "US-122.5",
      "title": "Implement Kanban board view for work items",
      "description": "As a user, I want to view work items on a kanban board so that I can visualize workflow stages.",
      "acceptanceCriteria": [
        "Add view toggle button to work list header (List/Kanban toggle)",
        "Create components/work/kanban-board.tsx component",
        "Kanban board displays columns for workflow statuses: Planned, In Progress, Review, Complete",
        "Work items appear as cards in appropriate status columns",
        "Cards display: name, client name, assignee avatar, due date, progress bar",
        "Cards are clickable and navigate to work item detail page",
        "Implement drag-and-drop using @dnd-kit/core library",
        "Cards can be dragged between columns",
        "Dragging shows visual feedback (shadow, placeholder in target column)",
        "Card status updates when moved to new column (calls updateWorkItem mutation with new status)",
        "Optimistic UI update on drag with rollback on error",
        "Column headers show item count badge (e.g., 'Planned (5)')",
        "Empty columns show 'No items' placeholder text",
        "Loading state shows skeleton cards in each column",
        "Kanban view respects current filters (client, assignee, etc.)",
        "Kanban view respects saved view configurations",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 122.5,
      "passes": true,
      "notes": "PRD-003: US-015 - Kanban board view implementation"
    },
    {
      "id": "US-123",
      "title": "Add saved views UI (create, switch, edit, delete)",
      "description": "As a user, I need to save and manage custom views of work items.",
      "acceptanceCriteria": [
        "Add view selector dropdown to work list header (left side, prominent)",
        "Default view: 'All Work' (cannot be deleted or renamed)",
        "Show 'Save View' button when filters are applied or view differs from saved state",
        "Save view dialog: name input (required), 'Save' and 'Cancel' buttons",
        "Validate name uniqueness, show error if duplicate",
        "Save calls createSavedView mutation with current filters, view type, sort, column config",
        "Saved views appear in dropdown as list",
        "Current view name shown in selector",
        "Show 'Modified' badge or asterisk if current filters differ from saved view",
        "Hover over saved view shows edit (pencil) and delete (trash) icons",
        "Edit opens rename dialog (calls updateSavedView mutation)",
        "Delete shows confirmation: 'Delete view [Name]?'",
        "Delete calls deleteSavedView mutation",
        "Selecting saved view applies its filters and view type",
        "Enforce maximum 20 saved views (show message if limit reached)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 123,
      "passes": true,
      "notes": "PRD-003: US-035 - Saved views UI"
    },
    {
      "id": "US-124",
      "title": "Add bulk operations UI (multi-select and actions)",
      "description": "As a user, I need to perform bulk operations on multiple work items.",
      "acceptanceCriteria": [
        "Add checkbox column on left side of work list table",
        "Add 'Select all' checkbox in table header (selects all visible items)",
        "Show 'Select all X items' link if more items exist beyond current view",
        "Show selection count: 'X selected'",
        "Show bulk actions bar when 1+ items selected with buttons: 'Change Status' (dropdown), 'Reassign' (opens picker), 'Change Due Date' (opens date picker), 'Archive', 'Delete' (red, destructive)",
        "Clicking outside or Escape clears selection",
        "Add 'Clear selection' link in bulk bar",
        "Bulk status change shows confirmation: 'Change status of X work items to [Status]?'",
        "Bulk reassign shows confirmation: 'Reassign X work items to [Name]?'",
        "Bulk due date shows confirmation: 'Change due date of X work items to [Date]?'",
        "Bulk archive shows confirmation: 'Archive X work items? They can be restored later.'",
        "Bulk delete shows confirmation: 'Delete X work items? This will permanently delete all tasks and unlink time entries. This cannot be undone.'",
        "All bulk actions call respective mutations (bulkUpdateWorkItems, bulkArchiveWorkItems, bulkDeleteWorkItems)",
        "Show success toast with count: 'X work items updated/archived/deleted'",
        "If partial failure, show summary dialog: 'X succeeded, Y failed' with error details",
        "Clear selection after successful operation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 124,
      "passes": true,
      "notes": "PRD-003: US-036 - Bulk operations UI"
    },
    {
      "id": "US-125",
      "title": "Add task checklist UI (add, complete, delete, reorder)",
      "description": "As a user, I need to add checklists to tasks for tracking sub-steps.",
      "acceptanceCriteria": [
        "Add 'Add checklist' link in expanded task view (below description)",
        "Show checklist section when task has checklist items",
        "Inline input to add new checklist item (press Enter to add, Escape to cancel)",
        "Each checklist item shows: checkbox, text, delete icon (on hover)",
        "Clicking checkbox toggles completion via updateChecklistItem mutation (strikethrough when complete)",
        "Checklist items can be reordered via drag-and-drop (calls reorderChecklistItems)",
        "Delete item: single click on trash icon, calls deleteChecklistItem mutation, shows undo toast",
        "Show checklist progress on task row: '3/5' or progress bar",
        "Checklist completion does NOT affect task status",
        "Maximum 20 checklist items per task (show message if limit reached)",
        "Use @dnd-kit/core for drag-and-drop",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 125,
      "passes": true,
      "notes": "PRD-003: US-037 - Task checklist UI"
    },
    {
      "id": "US-126",
      "title": "Add email ticketing database schema",
      "description": "As a developer, I need database tables for the email ticketing module.",
      "acceptanceCriteria": [
        "Add tickets table to convex/schema.ts with fields: ticketId (id), tenantId (string), subject (string), status (string enum: new|open|pending|on_hold|solved|closed), priority (string enum: urgent|high|normal|low), requesterEmail (string), requesterName (optional string), clientId (optional string), queueId (string), groupId (optional string), assigneeId (optional string), followerIds (array of strings, max 10), isSnoozed (boolean), snoozedUntil (optional number), statusBeforeSnooze (optional string), tags (array of strings), slaPolicyId (optional string), slaFirstResponseAt (optional number), slaFirstResponseBreached (boolean), slaResolutionAt (optional number), slaResolutionBreached (boolean), slaPausedAt (optional number), slaPausedDuration (optional number), inboxId (string), threadId (string), messageCount (number), isManual (boolean), isArchived (boolean), archivedAt (optional number), createdAt (number), updatedAt (number), firstResponseAt (optional number), solvedAt (optional number), closedAt (optional number)",
        "Add ticketMessages table with fields: messageId (id), ticketId (id), type (string enum: email|reply|note), direction (string enum: inbound|outbound), sender (string), senderName (optional string), recipients (optional array), ccRecipients (optional array), subject (optional string), bodyText (string), bodyHtml (optional string), attachments (array), isInternal (boolean), mentions (optional array of strings), createdAt (number)",
        "Add connectedInboxes table with fields: inboxId (id), tenantId (string), emailAddress (string), provider (string enum: gmail|outlook|exchange), accessToken (string), refreshToken (string), tokenExpiresAt (number), clientId (optional string), isActive (boolean), lastSyncAt (optional number), syncStatus (string enum: idle|syncing|error), syncError (optional string), createdAt (number)",
        "Add queues table with fields: queueId (id), tenantId (string), name (string), description (optional string), defaultGroupId (optional string), slaPolicyId (optional string), isActive (boolean), isDefault (boolean), ticketCount (optional number), createdAt (number), updatedAt (number)",
        "Add routingRules table with fields: ruleId (id), tenantId (string), name (string), priority (number), conditions (array of objects with field, operator, value), targetQueueId (string), isActive (boolean), createdAt (number)",
        "Add groups table with fields: groupId (id), tenantId (string), name (string), description (optional string), memberIds (array of strings), isActive (boolean), createdAt (number), updatedAt (number)",
        "Add views table with fields: viewId (id), tenantId (string), name (string), type (string enum: system|shared|personal), ownerId (optional string), filters (array of filter objects), sortBy (string), sortOrder (string enum: asc|desc), displayOrder (number), createdAt (number), updatedAt (number)",
        "Add slaPolicies table with fields: policyId (id), tenantId (string), name (string), description (optional string), targets (object with priority-based targets), useBusinessHours (boolean), isActive (boolean), createdAt (number), updatedAt (number)",
        "Add businessHours table with fields: tenantId (string), timezone (string), schedule (object with day-based configs), holidays (array), updatedAt (number)",
        "Add macros table with fields: macroId (id), tenantId (string), name (string), description (optional string), type (string enum: shared|personal), ownerId (optional string), actions (array), isActive (boolean), createdAt (number), updatedAt (number), lastUsedAt (optional number)",
        "Add tags table with fields: tagId (id), tenantId (string), name (string), color (optional string), usageCount (number), createdAt (number), updatedAt (number)",
        "Add timelineEvents table with fields: eventId (id), ticketId (id), type (string enum), actorId (string), data (object), createdAt (number)",
        "Add indexes on key fields: tickets.queueId, tickets.status, tickets.assigneeId, tickets.requesterEmail, ticketMessages.ticketId, queues.tenantId, groups.tenantId, views.tenantId",
        "Run 'npx convex dev' to generate types",
        "Typecheck passes"
      ],
      "priority": 126,
      "passes": true,
      "notes": "PRD-002: Email Ticketing Module - Schema foundation"
    },
    {
      "id": "US-127",
      "title": "Create connected inboxes backend operations",
      "description": "As a developer, I need CRUD operations for managing email inbox connections.",
      "acceptanceCriteria": [
        "Create convex/connectedInboxes.ts file",
        "Create listInboxes query (returns all inboxes for tenant, requires authentication)",
        "Create getInbox query (inboxId, requires authentication)",
        "Create connectInbox mutation (emailAddress, provider, accessToken, refreshToken, tokenExpiresAt, optional clientId)",
        "Create updateInbox mutation (inboxId, partial fields: clientId, isActive)",
        "Create deleteInbox mutation (inboxId, requires authentication)",
        "Create syncInbox action (inboxId) for manual sync trigger",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 127,
      "passes": true,
      "notes": "PRD-002: US-001, US-002 - Connected inboxes backend"
    },
    {
      "id": "US-128",
      "title": "Create queues backend operations",
      "description": "As a developer, I need CRUD operations for managing queues.",
      "acceptanceCriteria": [
        "Create convex/queues.ts file",
        "Create listQueues query (returns all queues for tenant, requires authentication)",
        "Create getQueue query (queueId, requires authentication)",
        "Create createQueue mutation (name, description, defaultGroupId, slaPolicyId, isActive)",
        "Create updateQueue mutation (queueId, partial fields)",
        "Create deleteQueue mutation (queueId, requires reassignment of tickets to another queue or default queue)",
        "Create setDefaultQueue mutation (queueId, sets isDefault to true, clears other defaults)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 128,
      "passes": true,
      "notes": "PRD-002: US-003 - Queues backend"
    },
    {
      "id": "US-129",
      "title": "Create routing rules backend operations",
      "description": "As a developer, I need CRUD operations for managing routing rules.",
      "acceptanceCriteria": [
        "Create convex/routingRules.ts file",
        "Create listRoutingRules query (returns all rules for tenant, sorted by priority)",
        "Create getRoutingRule query (ruleId, requires authentication)",
        "Create createRoutingRule mutation (name, priority, conditions array, targetQueueId, isActive)",
        "Create updateRoutingRule mutation (ruleId, partial fields)",
        "Create deleteRoutingRule mutation (ruleId, requires authentication)",
        "Create reorderRoutingRules mutation (ruleIds array in new priority order)",
        "Create testRoutingRule action (ruleId, sampleEmail object) returns match result",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 129,
      "passes": true,
      "notes": "PRD-002: US-004 - Routing rules backend"
    },
    {
      "id": "US-130",
      "title": "Create groups backend operations",
      "description": "As a developer, I need CRUD operations for managing agent groups.",
      "acceptanceCriteria": [
        "Create convex/groups.ts file",
        "Create listGroups query (returns all groups for tenant, requires authentication)",
        "Create getGroup query (groupId, includes memberIds, requires authentication)",
        "Create createGroup mutation (name, description, memberIds array, isActive)",
        "Create updateGroup mutation (groupId, partial fields: name, description, isActive)",
        "Create deleteGroup mutation (groupId, unassigns tickets assigned to group)",
        "Create addGroupMember mutation (groupId, userId)",
        "Create removeGroupMember mutation (groupId, userId)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 130,
      "passes": true,
      "notes": "PRD-002: US-005 - Groups backend"
    },
    {
      "id": "US-131",
      "title": "Create views backend operations",
      "description": "As a developer, I need CRUD operations for managing ticket views.",
      "acceptanceCriteria": [
        "Create convex/views.ts file",
        "Create listViews query (returns system + personal views for user, requires authentication)",
        "Create getView query (viewId, requires authentication)",
        "Create createView mutation (name, type, filters array, sortBy, sortOrder, optional ownerId for personal views)",
        "Create updateView mutation (viewId, partial fields: name, filters, sortBy, sortOrder)",
        "Create deleteView mutation (viewId, requires authentication, only owner can delete personal views)",
        "Create getViewTicketCount query (viewId, returns count of matching tickets)",
        "Create getViewTickets query (viewId, pagination params, returns matching tickets)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 131,
      "passes": true,
      "notes": "PRD-002: US-008, US-009, US-010 - Views backend"
    },
    {
      "id": "US-132",
      "title": "Create tickets backend CRUD operations",
      "description": "As a developer, I need CRUD operations for managing tickets.",
      "acceptanceCriteria": [
        "Create convex/tickets.ts file",
        "Create listTickets query (accepts filters: queueId, status, priority, assigneeId, tags, pagination params)",
        "Create getTicket query (ticketId, includes messages, requires authentication)",
        "Create createTicket mutation (subject, requesterEmail, requesterName, queueId, priority, initialMessage, optional clientId, optional assigneeId, isManual flag)",
        "Create updateTicket mutation (ticketId, partial fields: status, priority, assigneeId, groupId, tags)",
        "Create deleteTicket mutation (ticketId, admin only, requires authentication, cannot delete if linked to work items)",
        "Create assignTicket mutation (ticketId, assigneeId or groupId)",
        "Create changeTicketStatus mutation (ticketId, newStatus, records in timeline)",
        "Create changeTicketPriority mutation (ticketId, newPriority, records in timeline)",
        "Create addTicketTags mutation (ticketId, tags array)",
        "Create removeTicketTag mutation (ticketId, tag)",
        "Create linkTicketToWorkItem mutation (ticketId, workItemId)",
        "Create unlinkTicketFromWorkItem mutation (ticketId, workItemId)",
        "Create followTicket mutation (ticketId, adds current user to followers, max 10)",
        "Create unfollowTicket mutation (ticketId, removes current user from followers)",
        "Create snoozeTicket mutation (ticketId, until timestamp, sets status to on_hold, preserves original status)",
        "Create unsnoozeTicket mutation (ticketId, restores original status)",
        "Create archiveTicket mutation (ticketId, sets isArchived to true)",
        "Create unarchiveTicket mutation (ticketId, sets isArchived to false)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 132,
      "passes": true,
      "notes": "PRD-002: US-011, US-015, US-016, US-017, US-018, US-034, US-035, US-031 - Tickets backend CRUD"
    },
    {
      "id": "US-133",
      "title": "Create ticket messages backend operations",
      "description": "As a developer, I need operations for managing ticket messages (replies and notes).",
      "acceptanceCriteria": [
        "Add listTicketMessages query to convex/tickets.ts (ticketId, returns all messages sorted by createdAt)",
        "Create sendTicketReply mutation (ticketId, bodyText, bodyHtml, recipients, ccRecipients, attachments, status to set after reply)",
        "Create addTicketNote mutation (ticketId, bodyText, bodyHtml, mentions array, attachments, isInternal true)",
        "Create getTicketTimeline query (ticketId, returns timeline events sorted by createdAt)",
        "Create addTimelineEvent mutation (ticketId, eventType, data object, actorId)",
        "Reply updates ticket firstResponseAt if first reply, updates updatedAt",
        "Reply increments messageCount on ticket",
        "Note supports @mentions (extracts user IDs from bodyText)",
        "All operations require authentication",
        "Typecheck passes"
      ],
      "priority": 133,
      "passes": true,
      "notes": "PRD-002: US-012, US-013, US-014 - Ticket messages backend"
    },
    {
      "id": "US-134",
      "title": "Create SLA policies backend operations",
      "description": "As a developer, I need CRUD operations for managing SLA policies.",
      "acceptanceCriteria": [
        "Create convex/slaPolicies.ts file",
        "Create listSLAPolicies query (returns all policies for tenant, requires authentication)",
        "Create getSLAPolicy query (policyId, requires authentication)",
        "Create createSLAPolicy mutation (name, description, targets object with priority-based configs, useBusinessHours)",
        "Create updateSLAPolicy mutation (policyId, partial fields)",
        "Create deleteSLAPolicy mutation (policyId, requires reassignment if in use)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 134,
      "passes": true,
      "notes": "PRD-002: US-020 - SLA policies backend"
    },
    {
      "id": "US-135",
      "title": "Create business hours backend operations",
      "description": "As a developer, I need CRUD operations for managing business hours and holidays.",
      "acceptanceCriteria": [
        "Create convex/businessHours.ts file",
        "Create getBusinessHours query (returns business hours config for tenant)",
        "Create updateBusinessHours mutation (timezone, schedule object with day configs)",
        "Create listHolidays query (returns all holidays for tenant, sorted by date)",
        "Create addHoliday mutation (date, name, isRecurring)",
        "Create updateHoliday mutation (holidayId, partial fields)",
        "Create deleteHoliday mutation (holidayId)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 135,
      "passes": true,
      "notes": "PRD-002: US-021, US-029 - Business hours backend"
    },
    {
      "id": "US-136",
      "title": "Create macros backend operations",
      "description": "As a developer, I need CRUD operations for managing macros.",
      "acceptanceCriteria": [
        "Create convex/macros.ts file",
        "Create listMacros query (returns shared + personal macros for user, requires authentication)",
        "Create getMacro query (macroId, requires authentication)",
        "Create createMacro mutation (name, description, type, actions array, isActive)",
        "Create updateMacro mutation (macroId, partial fields)",
        "Create deleteMacro mutation (macroId, requires authentication)",
        "Create applyMacro mutation (ticketId, macroId, applies all macro actions to ticket)",
        "Create duplicateMacro mutation (macroId, creates copy with new name)",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 136,
      "passes": true,
      "notes": "PRD-002: US-024, US-025 - Macros backend"
    },
    {
      "id": "US-137",
      "title": "Create tags backend operations",
      "description": "As a developer, I need CRUD operations for managing tags.",
      "acceptanceCriteria": [
        "Create convex/tags.ts file",
        "Create listTags query (returns all tags for tenant with usageCount, requires authentication)",
        "Create getTag query (tagId, requires authentication)",
        "Create createTag mutation (name, optional color)",
        "Create updateTag mutation (tagId, partial fields: name, color)",
        "Create deleteTag mutation (tagId, only if usageCount is 0)",
        "Create mergeTags mutation (sourceTagId, targetTagId, updates all tickets using source tag)",
        "Update usageCount when tags added/removed from tickets",
        "All operations require authentication and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 137,
      "passes": true,
      "notes": "PRD-002: US-028 - Tags backend"
    },
    {
      "id": "US-138",
      "title": "Create bulk ticket operations backend",
      "description": "As a developer, I need bulk operations for managing multiple tickets at once.",
      "acceptanceCriteria": [
        "Add bulkAssignTickets mutation to convex/tickets.ts (ticketIds array, assigneeId or groupId)",
        "Add bulkUpdateTicketStatus mutation (ticketIds array, newStatus)",
        "Add bulkUpdateTicketPriority mutation (ticketIds array, newPriority)",
        "Add bulkAddTicketTags mutation (ticketIds array, tags array)",
        "Add bulkApplyMacro mutation (ticketIds array, macroId)",
        "Add bulkArchiveTickets mutation (ticketIds array)",
        "All mutations return success/failure counts",
        "All operations require authentication",
        "Typecheck passes"
      ],
      "priority": 138,
      "passes": true,
      "notes": "PRD-002: US-026 - Bulk operations backend"
    },
    {
      "id": "US-139",
      "title": "Create collision detection and presence tracking backend",
      "description": "As a developer, I need real-time presence tracking for ticket viewers.",
      "acceptanceCriteria": [
        "Add getTicketViewers query to convex/tickets.ts (ticketId, returns array of user IDs currently viewing)",
        "Add recordTicketView action (ticketId, userId, records viewing timestamp)",
        "Add clearTicketView action (ticketId, userId, removes from viewers)",
        "Viewers expire after 5 minutes of inactivity",
        "Use Convex real-time subscriptions for live updates",
        "All operations require authentication",
        "Typecheck passes"
      ],
      "priority": 139,
      "passes": true,
      "notes": "PRD-002: US-019 - Collision detection backend"
    },
    {
      "id": "US-140",
      "title": "Create connected inboxes UI",
      "description": "As an administrator, I need to connect and manage email inboxes.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/inboxes/page.tsx for inbox management",
        "Create components/tickets/inbox-connection-dialog.tsx with OAuth flow initiation",
        "Create components/tickets/inbox-list.tsx showing all connected inboxes with status, last sync, email count",
        "Show connection status badges: Connected (green), Syncing (yellow), Error (red)",
        "Add 'Connect Inbox' button that opens connection dialog",
        "Connection dialog supports Gmail and Outlook/Exchange OAuth",
        "Add 'Force Sync' button for each inbox",
        "Add 'Disconnect' button with confirmation dialog",
        "Show client association selector in inbox settings",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 140,
      "passes": true,
      "notes": "PRD-002: US-001, US-002 - Connected inboxes UI"
    },
    {
      "id": "US-141",
      "title": "Create queues management UI",
      "description": "As an administrator, I need to create and manage queues.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/queues/page.tsx for queue management",
        "Create components/tickets/create-queue-dialog.tsx with form: name (required), description, default group selector, SLA policy selector",
        "Create components/tickets/queue-list.tsx showing all queues with ticket counts",
        "Add 'Create Queue' button that opens create dialog",
        "Queue list shows: name, ticket count, default group, SLA policy, active status",
        "Add edit button (opens edit dialog with same form)",
        "Add delete button with confirmation showing ticket count and requiring reassignment",
        "Cannot delete default queue (must set another as default first)",
        "Show 'Set as Default' action for non-default queues",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 141,
      "passes": true,
      "notes": "PRD-002: US-003 - Queues UI"
    },
    {
      "id": "US-142",
      "title": "Create routing rules management UI",
      "description": "As an administrator, I need to configure automatic ticket routing rules.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/routing-rules/page.tsx",
        "Create components/tickets/routing-rule-dialog.tsx with form: name, conditions (inbox, sender email/domain, subject keywords, body keywords), target queue, priority",
        "Create components/tickets/routing-rules-list.tsx showing all rules in priority order",
        "Rules list supports drag-and-drop reordering (auto-saves on change)",
        "Add up/down buttons for reordering as alternative",
        "Add 'Create Rule' button",
        "Each rule shows: name, conditions summary, target queue, active status toggle",
        "Add edit and delete buttons (delete shows confirmation)",
        "Add 'Test Rule' button that opens test dialog with sample email input",
        "Set default queue selector for unmatched tickets",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 142,
      "passes": true,
      "notes": "PRD-002: US-004 - Routing rules UI"
    },
    {
      "id": "US-143",
      "title": "Create groups management UI",
      "description": "As an administrator, I need to create and manage agent groups.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/groups/page.tsx",
        "Create components/tickets/create-group-dialog.tsx with form: name (required), description, member multi-select",
        "Create components/tickets/group-list.tsx showing all groups with member counts",
        "Add 'Create Group' button",
        "Group list shows: name, member count, active status",
        "Add edit button (opens edit dialog)",
        "Add delete button with confirmation showing ticket count",
        "Cannot delete group if it's default for any queue",
        "Member selector shows all users in tenant with search",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 143,
      "passes": true,
      "notes": "PRD-002: US-005 - Groups UI"
    },
    {
      "id": "US-144",
      "title": "Create ticket list page with system views",
      "description": "As an agent, I need to view tickets in a list with system views.",
      "acceptanceCriteria": [
        "Update app/(dashboard)/tickets/page.tsx to show ticket list",
        "Create components/tickets/views-sidebar.tsx with system views: All Tickets, My Tickets, Following, Unassigned, New Tickets, Pending, Snoozed, Recently Updated",
        "Each view shows ticket count badge",
        "Active view is highlighted",
        "Views sidebar appears on left side of tickets page",
        "Create components/tickets/ticket-list-table.tsx with columns: Subject, Requester, Assignee, Status, Priority, Queue, Updated, SLA Status",
        "Table supports sorting by clicking column headers (toggle asc/desc)",
        "Table shows pagination (25 per page, configurable: 25, 50, 100)",
        "Show loading skeleton rows while fetching",
        "SLA status shows color indicator (green/yellow/red) with countdown",
        "Click row opens ticket detail",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 144,
      "passes": true,
      "notes": "PRD-002: US-008, US-011 - Ticket list and system views UI"
    },
    {
      "id": "US-145",
      "title": "Create personal and shared views UI",
      "description": "As an agent, I need to create and manage custom views.",
      "acceptanceCriteria": [
        "Add 'Create View' button to views sidebar",
        "Create components/tickets/create-view-dialog.tsx with form: name, filters (queue, status, priority, assignee, tags, dates, SLA status), sort options",
        "Filters support multiple conditions with AND logic",
        "Save view creates personal view (visible only to creator) or shared view (if admin)",
        "Personal views appear in 'Personal Views' section below system views",
        "Shared views appear in 'Shared Views' section (admin-managed)",
        "Right-click view shows edit/delete options",
        "Edit opens same dialog with existing values",
        "Delete shows confirmation",
        "Views update ticket list when selected",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 145,
      "passes": true,
      "notes": "PRD-002: US-009, US-010 - Personal and shared views UI"
    },
    {
      "id": "US-146",
      "title": "Create ticket detail page with conversation thread",
      "description": "As an agent, I need to view complete ticket details and conversation.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/tickets/[ticketId]/page.tsx",
        "Create components/tickets/ticket-detail-header.tsx with subject, back button, Follow/Snooze/Export buttons",
        "Create components/tickets/ticket-conversation.tsx showing all messages in thread (newest at bottom)",
        "Messages show: sender name, timestamp, body (HTML rendered), attachments",
        "Internal notes visually distinct (different background, lock icon)",
        "Create components/tickets/ticket-properties-panel.tsx (right side) showing: Requester info, Status dropdown, Priority dropdown, Assignee dropdown, Queue, Tags, SLA status, Followers, Linked work items",
        "Show requester name, email, associated client",
        "Show all attachments with download links",
        "Show ticket timeline/activity log",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 146,
      "passes": true,
      "notes": "PRD-002: US-012 - Ticket detail UI"
    },
    {
      "id": "US-147",
      "title": "Create ticket reply and internal note UI",
      "description": "As an agent, I need to reply to tickets and add internal notes.",
      "acceptanceCriteria": [
        "Create components/tickets/ticket-reply-editor.tsx with rich text editor (bold, italic, lists, links)",
        "Editor has toggle between 'Public Reply' and 'Internal Note' modes",
        "Public reply shows: body editor, attachment upload (max 25MB per file, 50MB total), CC recipients field, macro selector, combined submit button with status dropdown",
        "Submit button shows: 'Submit as Open', 'Submit as Pending', 'Submit as On-hold', 'Submit as Solved'",
        "Internal note shows: body editor, attachment upload, @mention autocomplete (shows all users), submit button",
        "Internal notes visually distinct in conversation thread",
        "Auto-save draft every 30 seconds",
        "Validation: subject required for new thread, body required",
        "Show loading spinner on submit button while sending",
        "Error handling: show error message with retry button if send fails",
        "Reply appears in thread immediately after send",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 147,
      "passes": true,
      "notes": "PRD-002: US-013, US-014 - Reply and note UI"
    },
    {
      "id": "US-148",
      "title": "Create ticket assignment and property editing UI",
      "description": "As an agent, I need to assign tickets and change properties.",
      "acceptanceCriteria": [
        "Add assignee dropdown to ticket properties panel (supports group or individual agent)",
        "Assignee dropdown shows groups and users with search",
        "Selecting assignee calls assignTicket mutation",
        "Add status dropdown to properties panel with all statuses",
        "Status change calls changeTicketStatus mutation, records in timeline",
        "Add priority dropdown to properties panel",
        "Priority change calls changeTicketPriority mutation, records in timeline",
        "Add tags autocomplete input to properties panel",
        "Tags show existing tags with usage count, allows creating new tags inline",
        "Add/remove tags calls addTicketTags/removeTicketTag mutations",
        "All changes show optimistic UI updates",
        "Success toasts for each action",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 148,
      "passes": true,
      "notes": "PRD-002: US-006, US-007, US-015, US-016, US-017 - Assignment and properties UI"
    },
    {
      "id": "US-149",
      "title": "Create ticket follow, snooze, and quick actions UI",
      "description": "As an agent, I need to follow tickets, snooze them, and perform quick triage actions.",
      "acceptanceCriteria": [
        "Add 'Follow' button to ticket detail header (toggles to 'Unfollow' when following)",
        "Show followers in properties panel (avatars with tooltip showing names)",
        "Maximum 10 followers per ticket",
        "Add 'Snooze' button to ticket detail header and hover actions on list",
        "Snooze dropdown shows: 'Tomorrow morning', 'Next week', 'Custom date/time'",
        "Custom date/time opens date/time picker",
        "Snoozed tickets show in 'Snoozed' system view with expiry time",
        "Add quick action buttons on ticket list row hover: Assign to me, Change status dropdown, Snooze dropdown",
        "Quick actions apply immediately with optimistic UI update",
        "Success/error toast for each action",
        "Keyboard shortcuts: hover + 'A' for assign to me",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 149,
      "passes": true,
      "notes": "PRD-002: US-034, US-035, US-036 - Follow, snooze, quick actions UI"
    },
    {
      "id": "US-150",
      "title": "Create ticket export/print UI",
      "description": "As an agent, I need to export tickets to PDF or print them.",
      "acceptanceCriteria": [
        "Add 'Export' dropdown button to ticket detail header with options: 'Export as PDF', 'Print'",
        "Export dialog shows checkboxes: 'Include internal notes' (default unchecked), 'Include attachments list' (default checked)",
        "PDF includes: ticket subject, requester info, all public messages, timestamps, professional formatting",
        "Print option opens browser print dialog with print-optimized view",
        "Export action recorded in ticket timeline",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 150,
      "passes": true,
      "notes": "PRD-002: US-037 - Export/print UI"
    },
    {
      "id": "US-151",
      "title": "Create SLA policies management UI",
      "description": "As an administrator, I need to create and manage SLA policies.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/sla-policies/page.tsx",
        "Create components/tickets/create-sla-policy-dialog.tsx with form: name, description, targets by priority (first response time, next response time, resolution time in minutes), useBusinessHours toggle",
        "Create components/tickets/sla-policy-list.tsx showing all policies",
        "Add 'Create Policy' button",
        "Policy list shows: name, description, targets summary",
        "Add edit and delete buttons (delete shows which queues/clients use policy)",
        "Cannot delete policy if in use",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 151,
      "passes": true,
      "notes": "PRD-002: US-020 - SLA policies UI"
    },
    {
      "id": "US-152",
      "title": "Create business hours and holidays management UI",
      "description": "As an administrator, I need to configure business hours and holidays.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/business-hours/page.tsx",
        "Create components/tickets/business-hours-form.tsx with timezone selector, schedule for each day (working hours, start/end time)",
        "Add '24/7 SLA' toggle per SLA policy",
        "Create components/tickets/holidays-list.tsx showing all holidays",
        "Add 'Add Holiday' button with form: date picker, name, recurring checkbox",
        "Holiday list shows: date, name, recurring indicator",
        "Add edit and delete buttons",
        "Show preview of next 7 days with working hours highlighted",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 152,
      "passes": true,
      "notes": "PRD-002: US-021, US-029 - Business hours UI"
    },
    {
      "id": "US-153",
      "title": "Create SLA status display and breach notifications UI",
      "description": "As an agent, I need to see SLA status on tickets and receive breach notifications.",
      "acceptanceCriteria": [
        "Show SLA status in ticket list column with color indicator (green/yellow/red) and countdown",
        "Show SLA status in ticket detail properties panel with time remaining and which metric is at risk",
        "SLA status tooltip shows full details on hover",
        "Add SLA status filter to views (breached, at risk, on track)",
        "Create app/(dashboard)/settings/sla-notifications/page.tsx for configuring breach notifications",
        "Notification settings: approaching breach threshold (default 75%), breach notification, notify options (assigned agent, group, specific users)",
        "Notifications sent via in-app and email",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 153,
      "passes": true,
      "notes": "PRD-002: US-022, US-023 - SLA status and notifications UI"
    },
    {
      "id": "US-154",
      "title": "Create macros management and application UI",
      "description": "As an agent, I need to create macros and apply them to tickets.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/macros/page.tsx",
        "Create components/tickets/create-macro-dialog.tsx with form: name, description, type (personal/shared), actions (canned response with placeholders, status change, priority change, add tags, assign)",
        "Macro actions support placeholders like {{requester.name}}",
        "Create components/tickets/macro-list.tsx showing all macros (personal + shared) with search/filter",
        "Add 'Create Macro' button",
        "Add edit, duplicate, and delete buttons",
        "Delete shows confirmation",
        "Add macro selector dropdown to ticket reply editor",
        "Selecting macro shows preview of changes",
        "Apply macro button applies all actions to ticket",
        "Macro application recorded in timeline",
        "Bulk apply macro option in bulk actions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 154,
      "passes": true,
      "notes": "PRD-002: US-024, US-025 - Macros UI"
    },
    {
      "id": "US-155",
      "title": "Create tags management UI",
      "description": "As an administrator, I need to manage tags.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/tags/page.tsx",
        "Create components/tickets/tag-list.tsx showing all tags with usage count",
        "Create components/tickets/create-tag-dialog.tsx with form: name (required), color picker",
        "Add 'Create Tag' button",
        "Tag list supports search/filter",
        "Tag list sortable by name or usage count",
        "Add edit button (updates name/color, updates all tickets using tag)",
        "Add merge button (combines two tags)",
        "Add delete button (only if usage count is 0, or shows warning with usage count)",
        "Bulk delete unused tags option",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 155,
      "passes": true,
      "notes": "PRD-002: US-028 - Tags management UI"
    },
    {
      "id": "US-156",
      "title": "Create manual ticket creation UI",
      "description": "As an agent, I need to create tickets manually (not from email).",
      "acceptanceCriteria": [
        "Add '+ New Ticket' button to tickets page header",
        "Create components/tickets/create-ticket-dialog.tsx with form: Subject (required), Requester email (required, can select from contacts), Requester name (optional), Queue (required), Priority (defaults to Normal), Initial message/description (required), Attachments (optional), Link to contact/client (optional)",
        "Form validation shows errors inline below fields",
        "Submit creates ticket and opens ticket detail view",
        "Manual tickets show icon indicator",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 156,
      "passes": true,
      "notes": "PRD-002: US-030 - Manual ticket creation UI"
    },
    {
      "id": "US-157",
      "title": "Create ticket archive and deletion UI",
      "description": "As an administrator, I need to archive and delete tickets.",
      "acceptanceCriteria": [
        "Add 'Archive' option to ticket actions dropdown (admin only)",
        "Archive shows confirmation dialog",
        "Bulk archive option in bulk actions",
        "Archived tickets removed from default views but searchable",
        "Archive status badge shown on archived tickets",
        "Add 'Unarchive' option for archived tickets",
        "Add 'Delete' option to ticket actions dropdown (admin only)",
        "Delete shows warning: 'This action cannot be undone'",
        "Cannot delete tickets with linked work items (must unlink first)",
        "Audit log entry for archiving and deletion",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 157,
      "passes": true,
      "notes": "PRD-002: US-031 - Archive and deletion UI"
    },
    {
      "id": "US-158",
      "title": "Create ticket list column customization UI",
      "description": "As an agent, I need to customize which columns appear in ticket list views.",
      "acceptanceCriteria": [
        "Add column settings button to ticket list header",
        "Right-click column header shows context menu with 'Hide Column' option",
        "Column settings dialog shows checkboxes for all available columns",
        "Columns can be reordered via drag-and-drop",
        "Column width adjustable by dragging column border",
        "Preferences saved per view (or globally per user)",
        "Reset to default columns option",
        "Available columns: Subject, Requester, Assignee, Status, Priority, Queue, Tags, Created, Updated, SLA Status",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 158,
      "passes": true,
      "notes": "PRD-002: US-032 - Column customization UI"
    },
    {
      "id": "US-159",
      "title": "Create auto-close configuration UI",
      "description": "As an administrator, I need to configure when Solved tickets are automatically closed.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/auto-close/page.tsx",
        "Add toggle to enable/disable auto-close",
        "Add number input for auto-close period (days after Solved, default 7)",
        "Add optional notification before auto-close (X days before)",
        "Show preview of next auto-close run time",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 159,
      "passes": true,
      "notes": "PRD-002: US-033 - Auto-close configuration UI"
    },
    {
      "id": "US-160",
      "title": "Create bulk ticket operations UI",
      "description": "As an agent, I need to perform bulk operations on multiple tickets.",
      "acceptanceCriteria": [
        "Add checkbox column on left side of ticket list table",
        "Add 'Select all' checkbox in table header",
        "Show selection count: 'X selected'",
        "Show bulk actions bar when 1+ items selected with buttons: Change Status (dropdown), Reassign (picker), Change Priority (dropdown), Add Tags, Apply Macro, Archive, Delete",
        "Bulk actions show confirmation dialog with count of affected tickets",
        "Show progress indicator for large batches",
        "Success/error summary after completion",
        "Clear selection after successful operation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 160,
      "passes": true,
      "notes": "PRD-002: US-026 - Bulk operations UI"
    },
    {
      "id": "US-161",
      "title": "Create collision detection UI",
      "description": "As an agent, I need to see when other agents are viewing the same ticket.",
      "acceptanceCriteria": [
        "Show avatar/name of other agents currently viewing ticket in ticket detail header",
        "Real-time updates as agents open/close ticket (via Convex subscriptions)",
        "Optional: Show typing indicator if another agent is composing reply",
        "Indicator disappears when agent leaves or after 5 minutes of inactivity",
        "Fallback to polling every 10 seconds if WebSocket disconnects",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 161,
      "passes": true,
      "notes": "PRD-002: US-019 - Collision detection UI"
    },
    {
      "id": "US-162",
      "title": "Create notification preferences UI",
      "description": "As an agent, I need to configure my notification preferences.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/notifications/page.tsx",
        "Notification settings for: new ticket assigned, ticket reply from customer, @mention, SLA warning",
        "Channels: in-app, email (checkboxes for each)",
        "Enable/disable per notification type",
        "Do not disturb settings (time range or manual toggle)",
        "Notification frequency: immediate, digest every hour, digest daily",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 162,
      "passes": true,
      "notes": "PRD-002: US-027 - Notification preferences UI"
    },
    {
      "id": "US-163",
      "title": "Add Contact Module database schema",
      "description": "As a developer, I need database schema for contacts, organizations, client groups, segments, and custom fields.",
      "acceptanceCriteria": [
        "Add contacts table to convex/schema.ts with fields: tenantId, name, email, phone, organizationId (optional), autoAssociated (boolean), clientGroupIds (array), avatarStorageId (optional), customFields (object), assignedToUserId (optional), clientPortalEnabled (boolean), notes (optional), timestamps, createdBy",
        "Add organizations table with fields: tenantId, name, domains (array, stored lowercase), address (object with street/city/state/postalCode/country), phone, website, notes, clientGroupIds (array), avatarStorageId (optional), customFields (object), assignedToUserId (optional), timestamps, createdBy",
        "Add clientGroups table with fields: tenantId, name, description (optional), timestamps, createdBy",
        "Add segments table with fields: tenantId, name, description (optional), criteria (object with type, filters array, logic), timestamps, createdBy",
        "Add customFieldDefinitions table with fields: tenantId, name, fieldKey (unique), fieldType, appliesTo, required (boolean), options (array, for dropdown), displayOrder, timestamps",
        "Add index on organizations.domains for efficient domain lookup",
        "Add index on contacts.organizationId for member queries",
        "Add index on contacts.email for search",
        "Add index on organizations.name for search",
        "Typecheck passes"
      ],
      "priority": 163,
      "passes": true,
      "notes": "PRD-004: Schema - All Contact Module tables"
    },
    {
      "id": "US-164",
      "title": "Create contacts CRUD backend operations",
      "description": "As a developer, I need backend operations for managing contacts.",
      "acceptanceCriteria": [
        "Create convex/contacts.ts with list query (supports filters: standalone, organization, all, search, clientGroup, assignedTo)",
        "Create get query by contact ID",
        "Create create mutation that handles auto-association: extracts email domain, checks against organization domains (case-insensitive), auto-associates if match found, sets autoAssociated flag",
        "Create update mutation for contact fields",
        "Create delete mutation that removes contact from client groups and work item associations",
        "Create associateWithOrganization mutation (manual association, sets autoAssociated: false)",
        "Create removeFromOrganization mutation (sets organizationId to null)",
        "All queries filter by tenantId",
        "Typecheck passes"
      ],
      "priority": 164,
      "passes": true,
      "notes": "PRD-004: US-001, US-003, US-004, US-005, US-006, US-007, US-009 - Contacts CRUD backend"
    },
    {
      "id": "US-165",
      "title": "Create organizations CRUD backend operations",
      "description": "As a developer, I need backend operations for managing organizations.",
      "acceptanceCriteria": [
        "Create convex/organizations.ts with list query (supports search, filters)",
        "Create get query by organization ID",
        "Create getMembers query to get all contacts in an organization",
        "Create create mutation",
        "Create update mutation",
        "Create delete mutation that sets all member contacts' organizationId to null (makes them standalone)",
        "All queries filter by tenantId",
        "Typecheck passes"
      ],
      "priority": 165,
      "passes": true,
      "notes": "PRD-004: US-010, US-011, US-012, US-015, US-016, US-017 - Organizations CRUD backend"
    },
    {
      "id": "US-166",
      "title": "Create domain management backend operations",
      "description": "As a developer, I need backend operations for managing organization email domains.",
      "acceptanceCriteria": [
        "Create addDomain mutation that validates domain format, checks uniqueness (domain cannot belong to another org), stores lowercase, finds standalone contacts with matching domain and returns them for association prompt",
        "Create removeDomain mutation that finds auto-associated contacts via domain and returns them for removal/keep prompt",
        "Create checkDomainAvailability query to check if domain is available",
        "Create findContactsByDomain query to find standalone contacts matching domain",
        "Domain validation: valid format (no www, no http/https), case-insensitive storage",
        "Uniqueness enforced: error if domain belongs to another organization",
        "Typecheck passes"
      ],
      "priority": 166,
      "passes": true,
      "notes": "PRD-004: US-013, US-014 - Domain management backend"
    },
    {
      "id": "US-167",
      "title": "Create client groups backend operations",
      "description": "As a developer, I need backend operations for managing client groups.",
      "acceptanceCriteria": [
        "Create convex/clientGroups.ts with list query",
        "Create get query by client group ID",
        "Create create mutation",
        "Create update mutation",
        "Create delete mutation (removes group reference from member contacts/organizations' clientGroupIds arrays)",
        "Create addMember mutation (adds contact or organization to group by updating clientGroupIds)",
        "Create removeMember mutation (removes contact or organization from group)",
        "All queries filter by tenantId",
        "Typecheck passes"
      ],
      "priority": 167,
      "passes": true,
      "notes": "PRD-004: US-018, US-019, US-020, US-021, US-022, US-023, US-024 - Client groups backend"
    },
    {
      "id": "US-168",
      "title": "Create segments backend operations",
      "description": "As a developer, I need backend operations for managing contact segments.",
      "acceptanceCriteria": [
        "Create convex/segments.ts with list query",
        "Create get query by segment ID",
        "Create getMembers query that dynamically calculates matching contacts/organizations based on segment criteria",
        "Create create mutation with criteria builder support",
        "Create update mutation",
        "Create delete mutation (no impact on contacts/organizations)",
        "Segment criteria support: type (contact/organization/both), filters array with field/operator/value, logic (and/or)",
        "Filter operators: equals, notEquals, contains, greaterThan, lessThan, isEmpty, isNotEmpty",
        "All queries filter by tenantId",
        "Typecheck passes"
      ],
      "priority": 168,
      "passes": true,
      "notes": "PRD-004: US-025, US-026, US-027, US-028, US-029 - Segments backend"
    },
    {
      "id": "US-169",
      "title": "Create custom fields backend operations",
      "description": "As a developer, I need backend operations for managing custom field definitions.",
      "acceptanceCriteria": [
        "Create convex/customFields.ts with list query (grouped by appliesTo scope, sorted by displayOrder)",
        "Create get query by custom field ID",
        "Create create mutation with fieldKey auto-generation from name (editable, must be unique)",
        "Create update mutation (fieldKey cannot be changed)",
        "Create delete mutation (existing data preserved in contacts/organizations, field just removed from forms)",
        "Field types supported: text, number, date, dropdown, checkbox",
        "AppliesTo scopes: contacts, organizations, both",
        "All queries filter by tenantId",
        "Typecheck passes"
      ],
      "priority": 169,
      "passes": true,
      "notes": "PRD-004: US-032, US-033, US-034, US-035, US-036 - Custom fields backend"
    },
    {
      "id": "US-170",
      "title": "Create avatar upload and management backend",
      "description": "As a developer, I need backend operations for managing contact and organization avatars.",
      "acceptanceCriteria": [
        "Create convex/avatars.ts with upload mutation (accepts file for contact or organization, validates image type jpg/png/gif, max 5MB, stores in Convex storage, updates avatarStorageId on contact/org)",
        "Create delete mutation (removes avatar from storage, clears avatarStorageId)",
        "Create getUrl query to get avatar URL from storage ID",
        "Avatar storage uses Convex file storage",
        "Typecheck passes"
      ],
      "priority": 170,
      "passes": true,
      "notes": "PRD-004: US-030, US-031 - Avatar backend"
    },
    {
      "id": "US-171",
      "title": "Create contact list page with search and filters",
      "description": "As a user, I want to view all contacts in a list with search and filtering.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/page.tsx",
        "Create components/contacts/contact-list.tsx with table layout: Avatar, Name, Email, Organization, Created columns",
        "Add search bar with 300ms debounce (searches name, email fields)",
        "Search results highlight matching text",
        "Add filter bar: Type (All/Contacts/Organizations), Organization dropdown, Standalone toggle, Client Group dropdown, Segment dropdown",
        "Multiple filters combine with AND logic",
        "Active filter count displayed: 'X filters active'",
        "Filters can be removed individually (X button)",
        "Clear All Filters button",
        "Sort options: Name (A-Z, Z-A), Organization, Created (newest, oldest)",
        "Pagination: 50 items per page with 'Load More' button",
        "Total count displayed: 'Showing X of Y contacts'",
        "Empty state: 'No contacts yet. Create your first contact to get started.' with 'Create Contact' button",
        "No results state: 'No contacts match your search' or 'No contacts match your filters. Try adjusting your criteria.'",
        "Loading state: Skeleton loaders during initial load",
        "Clicking contact row navigates to contact detail page",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 171,
      "passes": true,
      "notes": "PRD-004: US-001, US-002, US-040 - Contact list UI"
    },
    {
      "id": "US-172",
      "title": "Create contact detail view",
      "description": "As a user, I want to view detailed information about a contact.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/[contactId]/page.tsx",
        "Create components/contacts/contact-detail-header.tsx with avatar (hover overlay: Change/Remove), name, email, phone",
        "Create components/contacts/contact-detail-content.tsx with sections: Organization (shows linked org or 'Standalone contact', 'Add to Organization' button if standalone, 'Remove from Organization' action if member, 'Auto-associated via @domain.com' badge if applicable), Work Items (list with empty state), Emails (list with empty state), Custom Fields (if any defined), Timeline/Activity",
        "Organization name is clickable link to organization detail page",
        "Edit button opens edit modal",
        "Action menu with Delete option",
        "Loading state: Skeleton loader during initial load",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 172,
      "passes": true,
      "notes": "PRD-004: US-008 - Contact detail view"
    },
    {
      "id": "US-173",
      "title": "Create contact create and edit dialogs",
      "description": "As a user, I want to create and edit contacts.",
      "acceptanceCriteria": [
        "Create components/contacts/create-contact-dialog.tsx with form: Name (required, marked with asterisk), Email (optional, validated on blur), Phone (optional), Organization dropdown (optional, searchable), Custom fields section (if any defined)",
        "If email entered and domain matches org, show info message: 'This email matches [Organization Name]. Contact will be added to this organization.'",
        "User can uncheck organization association before save if auto-detected",
        "Email validation: format checked on blur, shows error if invalid",
        "Save button disabled until name field is filled",
        "On save, contact is created (handles auto-association), success toast: 'Contact created', user navigated to contact detail view",
        "Create components/contacts/edit-contact-dialog.tsx (same form, pre-populated with existing data)",
        "If email domain changes and matches different org, prompt user to re-associate",
        "Cancel button closes modal without saving",
        "Click outside modal or Escape key closes dialog (with unsaved changes warning)",
        "Network errors show toast: 'Failed to create contact. Please try again.' or 'Failed to update contact. Please try again.'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 173,
      "passes": true,
      "notes": "PRD-004: US-003, US-005 - Contact create/edit dialogs"
    },
    {
      "id": "US-174",
      "title": "Create contact delete confirmation dialog",
      "description": "As a user, I want to delete contacts with proper confirmation.",
      "acceptanceCriteria": [
        "Add Delete option to contact detail action menu",
        "Create components/contacts/delete-contact-dialog.tsx with confirmation: 'Delete [Contact Name]? This cannot be undone.'",
        "If contact has associated work items, show warning: 'This contact is associated with X work items. The contact will be removed from those work items.'",
        "If contact is member of organization, show info: 'This contact will be removed from [Organization Name]'",
        "On confirm, contact is deleted, removed from client groups, removed from work item associations, success toast: 'Contact deleted', user redirected to contact list",
        "Cancel returns to contact detail without changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 174,
      "passes": true,
      "notes": "PRD-004: US-009 - Contact delete"
    },
    {
      "id": "US-175",
      "title": "Create organization list page",
      "description": "As a user, I want to view all organizations in a list.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/organizations/page.tsx",
        "Create components/contacts/organization-list.tsx with table layout: Name, Domains, Member Count, Address, Created columns",
        "Add search bar with 300ms debounce (searches name, domains)",
        "Search results highlight matching text",
        "Add filter and sort options",
        "Pagination: 50 items per page with 'Load More' button",
        "Total count displayed: 'Showing X of Y organizations'",
        "Empty state: 'No organizations yet. Create your first organization to get started.' with 'Create Organization' button",
        "No results state: 'No organizations match your search'",
        "Loading state: Skeleton loaders during initial load",
        "Click on organization opens detail view",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 175,
      "passes": true,
      "notes": "PRD-004: US-010 - Organization list UI"
    },
    {
      "id": "US-176",
      "title": "Create organization detail view",
      "description": "As a user, I want to view detailed information about an organization.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/organizations/[organizationId]/page.tsx",
        "Create components/contacts/organization-detail-header.tsx with logo/avatar (hover overlay: Change/Remove), name",
        "Create components/contacts/organization-detail-content.tsx with sections: Domains (list with remove X button each, 'Add Domain' input field, domain validation messages inline), Members (list of contacts with avatar, name, email, 'Auto-associated' badge, 'Add Member' button, empty state: 'No members yet. Add contacts to this organization.'), Address, Phone, Website, Work Items (empty state), Custom Fields (if any defined), Notes",
        "Edit button opens edit modal",
        "Action menu with Delete option",
        "Loading state: Skeleton loader during initial load",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 176,
      "passes": true,
      "notes": "PRD-004: US-015, US-017 - Organization detail view"
    },
    {
      "id": "US-177",
      "title": "Create organization create and edit dialogs",
      "description": "As a user, I want to create and edit organizations.",
      "acceptanceCriteria": [
        "Create components/contacts/create-organization-dialog.tsx with form: Name (required, marked with asterisk), Domains field (multi-input with 'Add' button, validated on blur), Address fields (optional: street, city, state, postal code, country), Phone (optional), Website (optional), Notes (optional), Custom fields section (if any defined)",
        "Domain validation: valid format (no www, no http/https), case-insensitive storage (lowercase)",
        "Domain validation runs on blur, shows inline error if invalid format",
        "Domain uniqueness check: error toast if domain already belongs to another org: 'Domain @domain.com is already assigned to [Organization Name]'",
        "Save button disabled until name field is filled",
        "On save, if domains have matching standalone contacts, prompt to associate (see US-178)",
        "On save, organization is created, success toast: 'Organization created', user navigated to organization detail view",
        "Create components/contacts/edit-organization-dialog.tsx (same form, pre-populated with existing data)",
        "Domains can be added or removed (with confirmation flows)",
        "Cancel button closes modal without saving",
        "Click outside modal or Escape key closes dialog (with unsaved changes warning)",
        "Network errors show toast: 'Failed to create organization. Please try again.' or 'Failed to update organization. Please try again.'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 177,
      "passes": true,
      "notes": "PRD-004: US-011, US-012 - Organization create/edit dialogs"
    },
    {
      "id": "US-178",
      "title": "Create domain management UI with association prompts",
      "description": "As a user, I want to add and remove domains with proper handling of existing contacts.",
      "acceptanceCriteria": [
        "When adding domain that has matching standalone contacts, show confirmation dialog: 'Associate Existing Contacts?' with message 'Found X contacts with @domain.com email addresses', contact list with checkboxes (all checked by default), buttons 'Add Selected to Organization' and 'Skip'",
        "When removing domain that has auto-associated contacts, show confirmation dialog: 'What about associated contacts?' with message 'X contacts were auto-associated via @domain.com', radio options 'Remove from Organization' (contacts become standalone) and 'Keep in Organization' (contacts stay, just remove domain), buttons 'Confirm' and 'Cancel'",
        "Domain input field with 'Add' button in organization detail view",
        "Each domain has remove (X) button",
        "Domain validation messages shown inline",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 178,
      "passes": true,
      "notes": "PRD-004: US-013, US-014 - Domain management UI"
    },
    {
      "id": "US-179",
      "title": "Create organization delete confirmation dialog",
      "description": "As a user, I want to delete organizations with proper confirmation.",
      "acceptanceCriteria": [
        "Add Delete option to organization detail action menu",
        "Create components/contacts/delete-organization-dialog.tsx with confirmation: 'Delete [Organization Name]? This cannot be undone.'",
        "If organization has members, show info: 'This organization has X members. They will become standalone contacts.'",
        "If organization has associated work items, show warning: 'This organization is associated with X work items. The organization will be removed from those work items.'",
        "If organization has domains, show info: 'X domains will be released and can be used by other organizations.'",
        "On confirm, organization is deleted, all member contacts become standalone, domains released, organization removed from client groups and work item associations, success toast: 'Organization deleted. X contacts are now standalone.', user redirected to organization list",
        "Cancel returns to organization detail without changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 179,
      "passes": true,
      "notes": "PRD-004: US-016 - Organization delete"
    },
    {
      "id": "US-180",
      "title": "Create client groups list and detail pages",
      "description": "As a user, I want to view and manage client groups.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/client-groups/page.tsx with list showing: name, description, member count",
        "Groups can be sorted by name, member count, created date",
        "Groups can be searched by name",
        "Pagination: 50 items per page with 'Load More' button",
        "Total count displayed: 'Showing X of Y client groups'",
        "Empty state: 'No client groups yet. Create one to organize your contacts.' with 'Create Client Group' button",
        "Loading state: Skeleton loaders",
        "Click on group opens detail view",
        "Create app/(dashboard)/contacts/client-groups/[groupId]/page.tsx showing: group name, description, Members section (lists all contacts AND organizations in group with avatar, name, type badge Contact/Organization, link to detail), Members can be filtered: All, Contacts only, Organizations only, 'Add Member' button, members can be removed with confirmation, Edit button, Delete button in action menu",
        "Empty members state: 'No members yet. Add contacts or organizations to this group.' with 'Add Member' button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 180,
      "passes": true,
      "notes": "PRD-004: US-018, US-019 - Client groups list and detail"
    },
    {
      "id": "US-181",
      "title": "Create client groups create, edit, and delete dialogs",
      "description": "As a user, I want to create, edit, and delete client groups.",
      "acceptanceCriteria": [
        "Create components/contacts/create-client-group-dialog.tsx with form: Name (required, marked with asterisk), Description (optional), Save button disabled until name filled, success toast: 'Client group created', user navigated to group detail view",
        "Create components/contacts/edit-client-group-dialog.tsx (same form, pre-populated), success toast: 'Client group updated'",
        "Create components/contacts/delete-client-group-dialog.tsx with confirmation: 'Delete [Group Name]? Members will not be deleted.', shows member count: 'This group has X members', on confirm group deleted (members remain, only group reference removed), success toast: 'Client group deleted', user redirected to client groups list",
        "Cancel buttons close dialogs without saving",
        "Network errors show appropriate toast messages",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 181,
      "passes": true,
      "notes": "PRD-004: US-020, US-021, US-022 - Client groups CRUD dialogs"
    },
    {
      "id": "US-182",
      "title": "Create add and remove member from client group dialogs",
      "description": "As a user, I want to add and remove contacts/organizations from client groups.",
      "acceptanceCriteria": [
        "Create components/contacts/add-member-to-group-dialog.tsx with search/select dialog for contacts and organizations, shows entity type (Contact/Organization) in results, can select multiple entities at once (checkboxes), already-members excluded from selection (grayed out or hidden), on confirm selected entities added to group, success toast: 'X members added to [Group Name]', group detail view updates immediately",
        "Create components/contacts/remove-member-from-group-dialog.tsx with confirmation: 'Remove [Name] from [Group Name]?', on confirm member removed from group (clientGroupIds updated), member still exists as contact/organization, success toast: '[Name] removed from group', group detail view updates immediately",
        "Add Member button available on client group detail and on contact/organization detail ('Add to Group' action)",
        "Remove button (X) visible on hover for each member row in group detail",
        "Cancel closes dialogs without changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 182,
      "passes": true,
      "notes": "PRD-004: US-023, US-024 - Client group member management"
    },
    {
      "id": "US-183",
      "title": "Create segments list and detail pages",
      "description": "As a user, I want to view and manage contact segments.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/segments/page.tsx with list showing: name, description, member count (dynamic, updates automatically)",
        "Segments can be sorted by name, member count, created date",
        "Segments can be searched by name",
        "Pagination: 50 items per page with 'Load More' button",
        "Total count displayed: 'Showing X of Y segments'",
        "Empty state: 'No segments yet. Create one to filter contacts dynamically.' with 'Create Segment' button",
        "Loading state: Skeleton loaders",
        "Click on segment opens detail view",
        "Create app/(dashboard)/contacts/segments/[segmentId]/page.tsx showing: segment name, description, Criteria section (shows all filter criteria with logic AND/OR), Members section (lists all contacts/organizations matching criteria, member count: 'X members match this segment', members update automatically when contacts change, each member shows avatar, name, type badge, link to detail), Members can be filtered: All, Contacts only, Organizations only, Edit button, Delete button in action menu",
        "Empty state: 'No members match this segment's criteria.' with 'Edit Criteria' button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 183,
      "passes": true,
      "notes": "PRD-004: US-025, US-026 - Segments list and detail"
    },
    {
      "id": "US-184",
      "title": "Create segment create and edit dialogs with criteria builder",
      "description": "As a user, I want to create and edit segments with filter criteria.",
      "acceptanceCriteria": [
        "Create components/contacts/create-segment-dialog.tsx with form: Name (required, marked with asterisk), Description (optional), Type selector: 'Contacts only', 'Organizations only', 'Both', Criteria builder (allows adding multiple filters), Filter options: field (organization, domain, custom fields, created date, etc.), operator (equals, contains, greaterThan, etc.), value, Logic selector: 'All criteria must match' (AND) or 'Any criteria matches' (OR), Preview shows estimated member count: '~X members will match', Save button disabled until name and at least one criterion added, success toast: 'Segment created', user navigated to segment detail view",
        "Create components/contacts/edit-segment-dialog.tsx (same form, existing criteria pre-populated), criteria can be added/removed/modified, preview shows updated member count, success toast: 'Segment updated', segment detail view updates with new members",
        "Cancel buttons close dialogs without saving",
        "Network errors show appropriate toast messages",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 184,
      "passes": true,
      "notes": "PRD-004: US-027, US-028 - Segment create/edit with criteria builder"
    },
    {
      "id": "US-185",
      "title": "Create segment delete confirmation dialog",
      "description": "As a user, I want to delete segments with proper confirmation.",
      "acceptanceCriteria": [
        "Add Delete option to segment detail action menu",
        "Create components/contacts/delete-segment-dialog.tsx with confirmation: 'Delete [Segment Name]? This cannot be undone.', shows member count: 'This segment currently matches X members', on confirm segment deleted (no impact on contacts/organizations), success toast: 'Segment deleted', user redirected to segments list",
        "Cancel returns to segment detail without changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 185,
      "passes": true,
      "notes": "PRD-004: US-029 - Segment delete"
    },
    {
      "id": "US-186",
      "title": "Create custom fields management UI",
      "description": "As an administrator, I want to manage custom field definitions.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/contact-customization/page.tsx",
        "Create components/contacts/custom-fields-list.tsx showing: name, field type, applies to, required, display order, fields grouped by scope: Contacts, Organizations, Both, fields sorted by display order, 'Create Custom Field' button, each field has edit and delete actions",
        "Empty state: 'No custom fields yet. Create one to capture additional information.' with 'Create Custom Field' button",
        "Loading state: Skeleton loaders",
        "Create components/contacts/create-custom-field-dialog.tsx with form: Name (required, marked with asterisk), Field Key (auto-generated from name, editable, must be unique), Applies To selector: 'Contacts only', 'Organizations only', 'Both', Field Type selector: Text, Number, Date, Dropdown, Checkbox, Required checkbox, For Dropdown type: Options field (comma-separated or multi-input), Display Order field (number, defaults to next available), Save button disabled until name and field type selected, success toast: 'Custom field created', field appears on respective forms immediately",
        "Create components/contacts/edit-custom-field-dialog.tsx (same form, pre-populated, Field Key read-only), success toast: 'Custom field updated', changes reflected on forms immediately",
        "Create components/contacts/delete-custom-field-dialog.tsx with confirmation: 'Delete [Field Name]? Existing data will be preserved but field will no longer appear on forms.', shows usage count: 'This field is used by X contacts/organizations', on confirm custom field definition deleted (existing data preserved), field no longer appears on forms, success toast: 'Custom field deleted'",
        "Add drag handles or up/down arrows for reordering custom fields, order saved automatically, success toast: 'Field order updated', new order reflected on forms immediately",
        "Cancel buttons close dialogs without saving",
        "Network errors show appropriate toast messages",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 186,
      "passes": true,
      "notes": "PRD-004: US-032, US-033, US-034, US-035, US-036 - Custom fields management UI"
    },
    {
      "id": "US-187",
      "title": "Create avatar upload and removal UI",
      "description": "As a user, I want to upload and remove avatars for contacts and organizations.",
      "acceptanceCriteria": [
        "Avatar upload available on contact and organization detail/edit views",
        "Avatar has hover overlay with 'Change' and 'Remove' options",
        "Clicking 'Change' opens file picker (accepts: jpg, png, gif, max 5MB)",
        "Image uploaded and displayed immediately",
        "Avatar images displayed in lists and detail views",
        "For contacts without avatars, show initials or default icon",
        "For organizations without avatars, show company initials",
        "Create components/contacts/remove-avatar-dialog.tsx with confirmation: 'Remove avatar? Default initials will be shown.', on confirm avatar deleted, fallback to initials or default icon displayed immediately, success toast: 'Avatar removed'",
        "Success toast: 'Avatar updated'",
        "Network errors show toast: 'Failed to upload avatar. Please try again.'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 187,
      "passes": true,
      "notes": "PRD-004: US-030, US-031 - Avatar UI"
    },
    {
      "id": "US-188",
      "title": "Create contact assignment and My Contacts UI",
      "description": "As a user, I want to assign contacts to team members and view my assigned contacts.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/contacts/my-contacts/page.tsx showing contacts assigned to current user",
        "My Contacts can be filtered and searched",
        "Empty state: 'No contacts assigned to you yet.'",
        "Loading state: Skeleton loaders",
        "Add 'Assign To' dropdown on contact/organization detail/edit view (shows all team members, searchable, can select user or 'Unassigned', current assignment displayed)",
        "On save, assignment updated, success toast: 'Contact assigned to [User Name]', contact appears in assigned user's 'My Contacts' view",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 188,
      "passes": true,
      "notes": "PRD-004: US-037, US-038 - Contact assignment UI"
    },
    {
      "id": "US-189",
      "title": "Create contact-to-work-item association UI",
      "description": "As a user, I want to associate contacts and organizations with work items.",
      "acceptanceCriteria": [
        "Work items can be associated with a contact OR an organization",
        "If associated with organization, primary contact can optionally be selected",
        "Contact/org association visible on work item",
        "Work items visible on contact and organization detail views",
        "Empty state on contact/org detail: 'No work items associated yet.'",
        "Work items list shows: name, status, due date, link to work item",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 189,
      "passes": true,
      "notes": "PRD-004: US-039 - Work item association UI"
    },
    {
      "id": "US-190",
      "title": "Add time tracking database schema",
      "description": "As a developer, I need database tables for time entries, stopwatches, billing settings, time settings, and user preferences.",
      "acceptanceCriteria": [
        "Add timeEntries table with fields: timeEntryId, tenantId, userId, workId, date, hours, description, role, taskType, rate, amount, billable, billedStatus (enum: Unbilled, PartiallyBilled, Billed), locked, stopwatchId, splitFromEntryId, createdAt, updatedAt",
        "Add stopwatches table with fields: stopwatchId, tenantId, userId, workId, startTime, elapsedTime, isRunning, notes",
        "Add billingSettings table with fields: tenantId, defaultRate, roleRates (map), userRates (map), workItemRates (map), updatedAt",
        "Add timeTenantSettings table with fields: tenantId, minimumTimeEntryDuration, roundingRule (enum: None, RoundToNearestQuarter, RoundToNearestHalf, RoundUp), timesheetPeriod (enum: Weekly, BiWeekly, Monthly), defaultBillable, timerAutoStopDuration, updatedAt",
        "Add userTimePreferences table with fields: userId, tenantId, favoriteWorkItems (array, max 10), updatedAt",
        "Add indexes: timeEntries on (tenantId, userId, date), timeEntries on (tenantId, workId), stopwatches on (tenantId, userId, isRunning)",
        "Schema validates all required fields and constraints",
        "Typecheck passes"
      ],
      "priority": 190,
      "passes": true,
      "notes": "PRD-005: Schema foundation for all time tracking features"
    },
    {
      "id": "US-191",
      "title": "Create stopwatch backend operations",
      "description": "As a developer, I need backend operations to start, stop, update, and query stopwatches.",
      "acceptanceCriteria": [
        "Create startStopwatch mutation: Creates stopwatch with workId, startTime, isRunning=true, validates only one active stopwatch per user, returns stopwatchId",
        "Create stopStopwatch mutation: Sets isRunning=false, calculates elapsedTime, returns elapsed time in hours",
        "Create updateStopwatch mutation: Updates workId and/or notes for running stopwatch",
        "Create updateStopwatchNotes mutation: Updates notes only (debounced auto-save)",
        "Create getActiveStopwatch query: Returns active stopwatch for current user, returns null if none",
        "Timer auto-stop: If stopwatch running > 24 hours, automatically stop and create warning",
        "Timer persistence: Stopwatch state synced with server, resumes on login within 24 hours",
        "Timer stops on logout: Mutation to stop all active stopwatches for user",
        "Typecheck passes"
      ],
      "priority": 191,
      "passes": true,
      "notes": "PRD-005: US-001, US-002, US-018, US-022 - Stopwatch backend"
    },
    {
      "id": "US-192",
      "title": "Create time entry CRUD backend operations",
      "description": "As a developer, I need backend operations to create, read, update, delete, lock, duplicate, and split time entries.",
      "acceptanceCriteria": [
        "Create createTimeEntry mutation: Creates entry with all fields, calculates rate using hierarchy (work item > user > role > default), calculates amount (hours * rate), validates hours > 0 and <= 24, date not in future",
        "Create updateTimeEntry mutation: Updates entry fields, validates locked/billed entries cannot be updated, updates updatedAt timestamp",
        "Create patchTimeEntry mutation: Partial update for inline editing (hours, notes, billable status), validates locked/billed entries",
        "Create deleteTimeEntry mutation: Deletes entry, validates locked/billed entries cannot be deleted, preserves orphaned entries if work item deleted",
        "Create lockTimeEntry mutation: Sets locked=true, requires confirmation",
        "Create unlockTimeEntry mutation: Sets locked=false, requires administrator permissions",
        "Create duplicateTimeEntry mutation: Creates new entry with same fields except date (defaults to today), original unchanged",
        "Create splitTimeEntry mutation: Reduces original entry hours, creates new entry with split hours, validates minimum 0.25 hours per entry, cannot split locked/billed entries",
        "Create listTimeEntries query: Returns entries filtered by tenantId, userId, date range, workId, role, taskType, billable status, supports sorting by date/hours/amount",
        "Create getTimeEntry query: Returns single entry by ID",
        "Create bulkUpdateBillableStatus mutation: Updates billable status for multiple entries",
        "Rate calculation: Checks work item rate first, then user rate, then role rate, then default rate, uses $0.00 if none found",
        "Typecheck passes"
      ],
      "priority": 192,
      "passes": true,
      "notes": "PRD-005: US-002, US-003, US-005, US-006, US-013, US-020, US-024 - Time entry CRUD backend"
    },
    {
      "id": "US-193",
      "title": "Create timesheet aggregation and utilization backend",
      "description": "As a developer, I need backend operations to aggregate timesheets and calculate utilization.",
      "acceptanceCriteria": [
        "Create getCurrentTimesheet query: Returns timesheet summary for current period (based on tenant settings), includes totalHours, billableHours, nonBillableHours, totalAmount, entries grouped by date",
        "Create getTimesheetSummaries query: Returns list of timesheet periods with summary data",
        "Create getTimesheetDetails query: Returns full timesheet with all entries for a period",
        "Create getUtilizationReport query: Returns team utilization with hoursWorked, capacity, utilizationPercentage for date range, filters by team member",
        "Create getUserUtilization query: Returns detailed utilization for specific user with breakdown by work item, time entries, capacity vs actual, trends",
        "Capacity calculation: Default 8 hours/day, 40 hours/week (configurable per user), accounts for work days only (excludes weekends unless configured)",
        "Utilization calculation: (hoursWorked / capacity) * 100",
        "Timesheet period calculation: Based on tenant settings (Weekly, BiWeekly, Monthly)",
        "Typecheck passes"
      ],
      "priority": 193,
      "passes": true,
      "notes": "PRD-005: US-004, US-008, US-014, US-017 - Timesheet and utilization backend"
    },
    {
      "id": "US-194",
      "title": "Create billing and time settings backend",
      "description": "As a developer, I need backend operations to manage billing rates and time tenant settings.",
      "acceptanceCriteria": [
        "Create getBillingSettings query: Returns billing settings for tenant with defaultRate, roleRates, userRates, workItemRates",
        "Create updateBillingSettings mutation: Updates billing settings, validates rates >= 0",
        "Create getTimeTenantSettings query: Returns time settings for tenant",
        "Create updateTimeTenantSettings mutation: Updates minimumTimeEntryDuration, roundingRule, timesheetPeriod, defaultBillable, timerAutoStopDuration, validates minimum duration > 0, timer duration > 0",
        "Create getUserTimePreferences query: Returns user preferences with favoriteWorkItems",
        "Create updateUserTimePreferences mutation: Updates favoriteWorkItems (max 10), validates array length",
        "Create getRecentWorkItems query: Returns last 5 work items with time entries for user (sorted by most recent)",
        "Settings affect new time entries immediately",
        "Typecheck passes"
      ],
      "priority": 194,
      "passes": true,
      "notes": "PRD-005: US-011, US-015, US-016, US-019 - Settings backend"
    },
    {
      "id": "US-195",
      "title": "Create timer UI components and start/stop flow",
      "description": "As a user, I want to start and stop timers with work item selection.",
      "acceptanceCriteria": [
        "Add 'Start Timer' button to top navigation (header component)",
        "Create timer start modal: Work item selector (with recent/favorites sections), 'Start' button, loading state during initialization",
        "Timer starts and shows persistent indicator in header with elapsed time (updates every second)",
        "Timer indicator shows: elapsed time, work item name, dropdown menu",
        "Timer dropdown shows: current work item, notes textarea (auto-saves debounced), 'Change Work Item' option, 'Stop' button",
        "Stop timer opens modal with time entry form pre-filled: elapsed time, work item, notes, role/task type dropdowns, billable checkbox",
        "Timer persists across page navigation (stored in localStorage and synced with server)",
        "Timer resumes on login within 24 hours if browser was closed",
        "Timer auto-stops after 24 hours with warning",
        "Only one timer can run at a time (disable start if timer already running)",
        "Context auto-fill: When on /work/[workId] page, pre-selects that work item",
        "If timer running and user clicks start again, show confirmation: 'Timer already running on [Work Item]. Stop current timer and start new one?'",
        "Error handling: Error messages with retry option if timer operations fail",
        "Success notifications: Toast messages for start/stop actions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 195,
      "passes": true,
      "notes": "PRD-005: US-001, US-002, US-018, US-022, US-025 - Timer UI"
    },
    {
      "id": "US-196",
      "title": "Create manual time entry form and work item quick-select",
      "description": "As a user, I want to manually enter time with quick access to recent and favorite work items.",
      "acceptanceCriteria": [
        "Add 'Time Entry' button to top navigation and timesheet empty state",
        "Create time entry form modal with fields: work item selector (required), date picker (default today, cannot be future), hours input (min 0.25, max 24, step 0.25), role dropdown (optional), task type dropdown (optional), notes textarea (optional), billable checkbox (default checked)",
        "Work item selector shows: 'Recent' section (last 5 work items with time entries, sorted by most recent), 'Favorites' section (user-pinned items, max 10), star icon to add/remove favorites, search field below for all work items",
        "Recent and favorites persist across sessions (stored in user preferences)",
        "Form validation: Required fields marked with asterisk, validation errors shown inline below fields (red text), validates on blur and submit",
        "Validation rules: Work item required, date required, hours > 0 and <= 24, date not in future",
        "Context auto-fill: When on /work/[workId] page, pre-selects that work item",
        "Save creates time entry, shows success toast, closes modal, refreshes timesheet",
        "Modal can be closed via Cancel, X button, or Escape key (with confirmation if form has changes)",
        "Error handling: Error messages with retry option if save fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 196,
      "passes": true,
      "notes": "PRD-005: US-003, US-019, US-025 - Manual entry UI with quick-select"
    },
    {
      "id": "US-197",
      "title": "Create current timesheet view with daily/weekly/calendar views",
      "description": "As a user, I want to view my current timesheet in daily, weekly, or calendar format.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/time/page.tsx for current timesheet",
        "Loading state: Skeleton loader during initial load (mimics timesheet structure)",
        "Timesheet displays entries grouped by date",
        "View toggle: Daily | Weekly | Calendar (three options)",
        "Daily view: Entries grouped by day, shows date header, total hours per day, billable vs non-billable breakdown",
        "Weekly view: Entries grouped by week, shows week range, total hours per week, billable vs non-billable breakdown",
        "Calendar view: Month grid showing days, each day cell shows: total hours, billable hours (if different), entry count, visual density indicator (light < 4h, medium 4-8h, dark > 8h), click day to expand entry list (inline or side panel), month navigation (prev/next arrows, month picker), today highlighted, weekends visually distinct, '+' button on day cell to create entry",
        "Time entry rows show: Date, Work Item (linked), Role, Task Type, Note (truncated with expand), Rate, Time, Billed Status, Billable indicator (icon/badge/color coding)",
        "Time entry detail view: Clicking on time entry row opens detail view (modal or expandable section) showing all fields: date, work item (linked), user, role, task type, hours, rate, amount calculation (hours * rate), notes/description (fully visible, not truncated), billable status, billed status, lock status, created/updated timestamps",
        "Detail view shows rate and amount calculations clearly displayed",
        "Detail view shows billing status badge/indicator",
        "Empty state: 'No time entries for this period' message with 'Add Time Entry' button",
        "Filter controls: Date range picker, work item dropdown, role dropdown, task type dropdown, billable status toggle",
        "Sort controls: Date (default), hours, amount",
        "Timesheet refreshes automatically when new entries added (polling or websocket)",
        "Error state: Error message with retry button if load fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 197,
      "passes": true,
      "notes": "PRD-005: US-004, US-007, US-023 - Timesheet views with detail view"
    },
    {
      "id": "US-198",
      "title": "Create time entry edit, delete, lock, and bulk operations UI",
      "description": "As a user, I want to edit, delete, lock time entries and perform bulk operations.",
      "acceptanceCriteria": [
        "Edit button on time entry rows (disabled for locked/billed entries with tooltip)",
        "Edit modal: Pre-filled form with all fields editable, same validation as create, saves changes, shows success toast, updates timesheet immediately",
        "Delete button on time entry rows (disabled for locked/billed entries with tooltip)",
        "Delete confirmation dialog: 'Delete this time entry? This action cannot be undone.' with Delete (destructive) and Cancel buttons",
        "Delete removes entry, shows success toast, updates timesheet immediately",
        "Lock button/menu item on time entry rows",
        "Lock confirmation dialog: 'Lock this time entry? Locked entries cannot be edited and will be included in billing runs.' with Lock and Cancel buttons",
        "Locked entries show lock icon, 'Locked' badge, different row styling, edit/delete buttons disabled",
        "Unlock action available (administrator only) with confirmation dialog",
        "Bulk selection: Checkboxes on entries, bulk action menu appears when entries selected",
        "Bulk mark as billable/non-billable: Updates selected entries, shows success toast",
        "Bulk operations disabled for locked/billed entries",
        "Error handling: Error messages with retry option for all operations",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 198,
      "passes": true,
      "notes": "PRD-005: US-005, US-006, US-012, US-013 - Edit/delete/lock/bulk UI"
    },
    {
      "id": "US-199",
      "title": "Create duplicate and split time entry UI",
      "description": "As a user, I want to duplicate and split time entries.",
      "acceptanceCriteria": [
        "Duplicate action available on time entry rows (button or overflow menu)",
        "Duplicate opens create modal with pre-filled data: Work item, role, task type, notes, billable status, hours (date defaults to today)",
        "User can modify any field before saving",
        "Original entry unchanged, new entry created as separate record",
        "Duplicate available on locked/billed entries (creates unlocked/unbilled copy)",
        "Split action available on time entry rows (overflow menu, disabled for locked/billed entries)",
        "Split modal shows: Original entry details (hours, work item, date), hours to split off input (min 0.25, max original - 0.25), work item selector for split portion (required)",
        "Split portion inherits: date, role, task type, billable status from original, notes default empty",
        "Split creates two entries: original reduced, new entry with split hours",
        "Both entries optionally link to indicate split (split indicator)",
        "Success notifications: Toast messages for duplicate and split",
        "Error handling: Error messages with retry option",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 199,
      "passes": true,
      "notes": "PRD-005: US-020, US-024 - Duplicate and split UI"
    },
    {
      "id": "US-200",
      "title": "Create inline timesheet editing for power users",
      "description": "As a power user, I want to edit time entries directly in the timesheet grid.",
      "acceptanceCriteria": [
        "Inline editing available for: hours, notes, billable status",
        "Click on field activates edit mode (field becomes input)",
        "Hours field: Number input with step 0.25, validates > 0 and <= 24",
        "Notes field: Text input (expandable on focus), character limit 500 with counter",
        "Billable status: Checkbox toggle (saves immediately on click)",
        "Enter key saves changes and exits edit mode",
        "Escape key cancels changes and exits edit mode",
        "Clicking outside field saves changes",
        "Tab key saves current field and moves to next editable field",
        "Validation errors shown inline (red border, tooltip with error)",
        "Locked/billed entries not editable inline (fields appear non-interactive)",
        "Loading indicator while saving (subtle spinner or field highlight)",
        "Success indicator: Brief green highlight on saved field",
        "Error handling: If save fails, field reverts and error tooltip shown",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 200,
      "passes": true,
      "notes": "PRD-005: US-021 - Inline editing"
    },
    {
      "id": "US-201",
      "title": "Create utilization report and individual user detail views",
      "description": "As a manager, I want to view team utilization and drill down into individual user details.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/time/utilization/page.tsx for team utilization report",
        "Loading state: Skeleton loader during initial load",
        "Team member list shows: Name, hours worked, capacity, utilization percentage, color coding (green < 80%, yellow 80-100%, red > 100%)",
        "Visual comparison: Bar chart or table showing hours worked vs capacity",
        "Date range selector for filtering",
        "Filter by team member dropdown",
        "Empty state: 'No utilization data for this period' message",
        "Click on team member row opens individual utilization detail view",
        "Individual detail view shows: Detailed breakdown by work item (table/list), time entries for selected period (expandable list), capacity vs actual hours (visual comparison), utilization percentage and trends, date range filter, back button to team report",
        "Empty state on detail view: 'No time entries for this period'",
        "Error state: Error message with retry button if load fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 201,
      "passes": true,
      "notes": "PRD-005: US-008, US-014 - Utilization reporting UI"
    },
    {
      "id": "US-202",
      "title": "Create billing settings and time tenant settings UI",
      "description": "As an administrator, I want to configure billing rates and time tracking settings.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/settings/billing/page.tsx for billing settings",
        "Billing settings page shows: Default rates section, role-based rates (grouped by role), user-specific overrides (grouped by user), work item-specific overrides (grouped by work item), rate hierarchy clearly indicated (visual hierarchy or sections)",
        "Can view rate details (click to expand), edit individual rates (edit button), delete rate overrides (delete button with confirmation)",
        "Empty state: 'Using default rates' with 'Add Rate' button",
        "Create app/(dashboard)/settings/time/page.tsx for time settings",
        "Time settings form: Minimum time entry duration dropdown (0.25, 0.5, 1.0 hours), rounding rules dropdown (None, Round to nearest 0.25, Round to nearest 0.5, Round up), timesheet period radio (Weekly, Bi-weekly, Monthly), default billable checkbox, timer auto-stop duration number input (hours, default 24)",
        "Settings saved with explicit 'Save' button, shows success toast: 'Time settings saved'",
        "Settings affect new time entries immediately",
        "Validation: Minimum duration > 0, timer duration > 0",
        "Loading states: Skeleton loaders during initial load",
        "Error handling: Error messages with retry option if save fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 202,
      "passes": true,
      "notes": "PRD-005: US-011, US-015, US-016 - Settings UI"
    },
    {
      "id": "US-203",
      "title": "Create historical timesheets view",
      "description": "As a user, I want to view historical timesheets.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/time/timesheets/page.tsx for historical timesheets list",
        "List shows timesheet periods (by period start/end dates)",
        "Click on period opens historical timesheet details (same format as current timesheet)",
        "Historical timesheet shows all entries for selected period",
        "Can navigate back to timesheet list",
        "Loading state: Skeleton loader during load",
        "Empty state: 'No historical timesheets' message",
        "Error state: Error message with retry button if load fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 203,
      "passes": true,
      "notes": "PRD-005: US-017 - Historical timesheets UI"
    },
    {
      "id": "US-204",
      "title": "Integrate time tracking with work item Time & Budget tab",
      "description": "As a user, I want to see time entries and budget information on work items.",
      "acceptanceCriteria": [
        "Time & Budget tab on work item detail page shows: Budget overview (budgeted vs actual time and money), budget breakdown by team member, time entry report (all logged time), remaining budget calculation, fees calculated based on time entries",
        "Time entries appear in work item Time & Budget tab (linked from timesheet)",
        "Can start timer from work item detail page (work item pre-selected)",
        "Time entries aggregate automatically on work item",
        "If work item deleted, associated time entries preserved (orphaned entries show 'Work item deleted' indicator)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 204,
      "passes": true,
      "notes": "PRD-005: US-009, US-010 - Work item integration"
    },
    {
      "id": "US-205",
      "title": "Add billing module database schema",
      "description": "As a developer, I need database schema for invoices, payments, billing runs, recurring billing, SOWs, deliverables, and change orders.",
      "acceptanceCriteria": [
        "Add Invoice table: invoiceId, tenantId, invoiceNumber (INV-YYYY-NNNN), clientId, invoiceDate, dueDate, status (Draft/Sent/Paid/Overdue/Cancelled), subtotal, tax, discount, total, amountPaid, amountDue, billingRunId, sowId (optional), sowDeliverableId (optional), createdAt, updatedAt",
        "Add InvoiceLineItem table: lineItemId, invoiceId, timeEntryId (optional), workId (optional), description, quantity, rate, amount, isManual",
        "Add Payment table: paymentId, invoiceId, tenantId, amount, paymentDate, paymentMethod, notes, status (Active/Voided), voidReason, voidedAt, voidedBy, createdAt, createdBy, updatedAt",
        "Add BillingRun table: billingRunId, tenantId, name, status (Pending/Processing/Completed/Failed/Cancelled), timeEntryIds (array), invoiceIds (array), startedAt, completedAt, errors (array), createdAt",
        "Add RecurringBilling table: recurringBillingId, tenantId, clientId, workId (optional), name, frequency (Monthly/Quarterly/Annually), amount (optional), billingMethod (Fixed/TimeBased), nextBillingDate, isActive, lastBillingDate, createdAt, updatedAt",
        "Add SOW table: sowId, tenantId, sowNumber (SOW-YYYY-NNNN), clientId, name, description, referenceNumber, status (Draft/Active/Complete/Cancelled), startDate, endDate, totalValue, amountBilled, amountRemaining, billingSchedule (JSON), createdAt, updatedAt, createdBy",
        "Add SOWDeliverable table: deliverableId, sowId, name, description, budgetedHours, fixedAmount, order, status (NotStarted/InProgress/Completed/Billed), billingTrigger (JSON), templateId (optional), linkedWorkIds (array), actualHours (calculated), actualCost (calculated), completedAt, billedAt, invoiceId",
        "Add ChangeOrder table: changeOrderId, sowId, changeOrderNumber (CO-001), description, changeType (AddDeliverable/ModifyDeliverable/PriceAdjustment), effectiveDate, previousValue, newValue, changeAmount, approvalStatus (Pending/Approved/Rejected), approvedAt, approvedBy, details (JSON), createdAt, createdBy",
        "Add indexes on: invoiceNumber, clientId, invoiceDate, status, sowId, sowNumber, clientId, status, deliverableId, sowId",
        "Typecheck passes"
      ],
      "priority": 205,
      "passes": true,
      "notes": "PRD-006: Schema foundation for all billing features"
    },
    {
      "id": "US-206",
      "title": "Create invoice CRUD operations",
      "description": "As a developer, I need backend operations to create, read, update, and delete invoices.",
      "acceptanceCriteria": [
        "Create listInvoices query: supports filters (status, clientId, dateRange), sorting (date, amount, invoiceNumber), returns invoices with line items",
        "Create getInvoice query: returns invoice with line items, payments, and related data",
        "Create createInvoice mutation: validates input, auto-generates invoice number (INV-YYYY-NNNN), handles conflicts by incrementing, creates line items from time entries or manual entry, calculates totals, sets status to Draft or Sent based on user choice",
        "Create updateInvoice mutation: only allows editing Draft invoices, validates input, recalculates totals, updates line items",
        "Create deleteInvoice mutation: only allows deleting Draft invoices, soft-deletes or marks as Cancelled",
        "Create sendInvoice mutation: updates status from Draft to Sent, handles email sending (if configured)",
        "Create exportInvoice action: generates PDF export",
        "Invoice number generation: format INV-YYYY-NNNN, sequential per tenant per year, auto-increment on conflict",
        "Validation: invoice date cannot be in future, due date must be after invoice date, at least one line item required, all line items must have description, quantity > 0, rate > 0",
        "Typecheck passes"
      ],
      "priority": 206,
      "passes": true,
      "notes": "PRD-006: US-002, US-003, US-004, US-013, US-014, US-020 - Invoice backend operations"
    },
    {
      "id": "US-207",
      "title": "Create unbilled time and billing run operations",
      "description": "As a developer, I need backend operations to view unbilled time and process billing runs.",
      "acceptanceCriteria": [
        "Create listUnbilledTime query: returns time entries where billed = false, supports filters (clientId, workId, dateRange), shows Date, Team Member, Work Item, Client, Hours, Rate, Amount",
        "Create getUnbilledSummary query: returns total unbilled amount and count",
        "Create createBillingRun mutation: validates selected time entries (must be unbilled, same tenant), groups by client, creates BillingRun record with Pending status",
        "Create processBillingRun action: processes billing run (Pending \u2192 Processing), creates invoices grouped by client, handles errors per client, updates status to Completed or Failed, records errors in billingRun.errors array",
        "Create getBillingRun query: returns billing run with created invoices and errors",
        "Create listBillingRuns query: returns all billing runs with filters (status, dateRange), sorted by date",
        "Create cancelBillingRun mutation: cancels Pending or Processing runs, updates status to Cancelled, stops processing if in progress",
        "Billing run grouping: automatically groups time entries by clientId, one invoice per client",
        "Error handling: records errors per client/time entry, allows partial success",
        "Typecheck passes"
      ],
      "priority": 207,
      "passes": true,
      "notes": "PRD-006: US-001, US-005, US-015, US-016, US-041 - Unbilled time and billing runs backend"
    },
    {
      "id": "US-208",
      "title": "Create payment CRUD operations",
      "description": "As a developer, I need backend operations to record, view, edit, and void payments.",
      "acceptanceCriteria": [
        "Create listPayments query: supports filters (dateRange, clientId, invoiceId, paymentMethod), sorting (date, amount, invoiceNumber), returns payments with invoice info",
        "Create getPayment query: returns payment with invoice details",
        "Create recordPayment mutation: validates payment amount (must be > 0, cannot exceed amountDue), validates payment date (cannot be in future), creates payment, updates invoice amountPaid and amountDue, updates invoice status to Paid if fully paid",
        "Create updatePayment mutation: only allows editing Active payments within edit window (configurable, default 7 days), validates amount changes, updates invoice amounts accordingly",
        "Create voidPayment mutation: only allows voiding Active payments within void window (configurable, default 30 days), requires voidReason, updates payment status to Voided, decreases invoice amountPaid, updates invoice status if needed (Paid \u2192 Sent)",
        "Payment method enum: Check, ACH, Credit Card, Wire Transfer, Cash, Other",
        "Validation: payment amount > 0, payment amount <= amountDue, payment date not in future, payment method required",
        "Invoice status updates: automatically updates to Paid when amountPaid >= total, updates to Sent if payment voided",
        "Typecheck passes"
      ],
      "priority": 208,
      "passes": true,
      "notes": "PRD-006: US-007, US-037, US-038, US-039, US-040 - Payment backend operations"
    },
    {
      "id": "US-209",
      "title": "Create receivables and aging report operations",
      "description": "As a developer, I need backend operations to track receivables and generate aging reports.",
      "acceptanceCriteria": [
        "Create listReceivables query: returns invoices with status Sent or Overdue, calculates daysOverdue (max(0, today - dueDate)), supports filters (clientId, dateRange, overdue status), sorting (dueDate, amount, daysOverdue)",
        "Create getAgingReport query: returns aging buckets (0-30, 31-60, 61-90, 90+ days) with totals per bucket",
        "Overdue calculation: automatically marks invoices as Overdue when dueDate < today AND status is Sent",
        "Receivables show: Invoice Number, Client, Amount, Due Date, Days Overdue, Amount Due",
        "Aging buckets: 0-30 days, 31-60 days, 61-90 days, 90+ days, each with total amount",
        "Typecheck passes"
      ],
      "priority": 209,
      "passes": true,
      "notes": "PRD-006: US-006 - Receivables backend operations"
    },
    {
      "id": "US-210",
      "title": "Create recurring billing CRUD operations",
      "description": "As a developer, I need backend operations to create, read, update, and delete recurring billing configurations.",
      "acceptanceCriteria": [
        "Create listRecurringBilling query: returns all recurring billing configs, supports filters (status, clientId), sorting (nextDate, client)",
        "Create getRecurringBilling query: returns recurring billing with billing history (invoices generated)",
        "Create createRecurringBilling mutation: validates client required, nextBillingDate in future, amount > 0 if Fixed method, creates recurring billing record",
        "Create updateRecurringBilling mutation: allows updating all fields, validates nextBillingDate in future, amount > 0 if Fixed method",
        "Create deleteRecurringBilling mutation: deletes recurring billing configuration",
        "Create pauseResumeRecurringBilling mutation: toggles isActive status",
        "Billing frequency enum: Monthly, Quarterly, Annually",
        "Billing method enum: Fixed (uses amount field), TimeBased (calculates from unbilled time entries)",
        "Validation: client required, nextBillingDate must be in future, amount > 0 if Fixed method, frequency required",
        "Typecheck passes"
      ],
      "priority": 210,
      "passes": true,
      "notes": "PRD-006: US-009, US-017, US-018, US-019, US-044 - Recurring billing backend operations"
    },
    {
      "id": "US-211",
      "title": "Create SOW CRUD operations",
      "description": "As a developer, I need backend operations to create, read, update, and manage SOWs.",
      "acceptanceCriteria": [
        "Create listSOWs query: supports filters (status, clientId, dateRange), sorting (date, value, client), returns SOWs with deliverables summary",
        "Create getSOW query: returns SOW with deliverables, change orders, billing history, scope analysis",
        "Create createSOW mutation: validates client required, name required, startDate required, totalValue > 0, at least one deliverable, auto-generates sowNumber (SOW-YYYY-NNNN), creates SOW in Draft status",
        "Create updateSOW mutation: only allows editing Draft SOWs, validates all fields, updates deliverables and billing schedule",
        "Create activateSOW mutation: validates at least one deliverable, totalValue > 0, startDate set, changes status from Draft to Active",
        "Create completeSOW mutation: validates SOW is Active, shows completion summary, warns if unbilled amount > 0, changes status to Complete",
        "Create cancelSOW mutation: allows cancelling Draft or Active SOWs, requires cancellation reason, changes status to Cancelled",
        "SOW number generation: format SOW-YYYY-NNNN, sequential per tenant per year, auto-increment on conflict",
        "SOW status transitions: Draft \u2192 Active (via activate), Active \u2192 Complete (via complete), Draft/Active \u2192 Cancelled (via cancel)",
        "Validation: client required, name required, startDate required, endDate must be after startDate (if provided), totalValue > 0, at least one deliverable required to activate",
        "Typecheck passes"
      ],
      "priority": 211,
      "passes": true,
      "notes": "PRD-006: US-023, US-027, US-028, US-033, US-034, US-035, US-036 - SOW backend operations"
    },
    {
      "id": "US-212",
      "title": "Create SOW deliverable operations",
      "description": "As a developer, I need backend operations to manage SOW deliverables and link work items.",
      "acceptanceCriteria": [
        "Create listDeliverables query: returns deliverables for an SOW with calculated actualHours and actualCost",
        "Create getDeliverable query: returns deliverable with linked work items, time entries, and billing history",
        "Create addDeliverable mutation: validates name required, fixedAmount > 0, budgetedHours >= 0, adds deliverable to SOW",
        "Create updateDeliverable mutation: allows updating deliverable fields (name, description, budgetedHours, fixedAmount, billingTrigger)",
        "Create deleteDeliverable mutation: only allows deleting from Draft SOWs",
        "Create reorderDeliverables mutation: updates order field for deliverables",
        "Create linkWorkItemToDeliverable mutation: validates work item belongs to same client as SOW, prevents double-linking (one work item to one deliverable), updates linkedWorkIds array",
        "Create unlinkWorkItemFromDeliverable mutation: removes work item from deliverable, recalculates actualHours and actualCost",
        "Calculate actualHours: sum of time entries from linked work items",
        "Calculate actualCost: sum of (hours \u00d7 rate) from linked work items",
        "Deliverable status tracking: NotStarted \u2192 InProgress \u2192 Completed \u2192 Billed",
        "Validation: deliverable name required, fixedAmount > 0, budgetedHours >= 0, work item must belong to same client as SOW, work item can only be linked to one deliverable",
        "Typecheck passes"
      ],
      "priority": 212,
      "passes": true,
      "notes": "PRD-006: US-024, US-025, US-046 - SOW deliverable backend operations"
    },
    {
      "id": "US-213",
      "title": "Create SOW billing schedule and invoice creation operations",
      "description": "As a developer, I need backend operations to configure billing schedules and create invoices from SOWs.",
      "acceptanceCriteria": [
        "Create getBillingSchedule query: returns billing schedule with status (Pending, Due, Invoiced) for Fixed Schedule method",
        "Create getBillingHistory query: returns invoices created from SOW",
        "Create createInvoiceFromSOW action: pre-fills invoice from billing schedule, handles Fixed Schedule (uses scheduled amount), Milestone-Based (lists completed deliverables), Progress-Based (calculates from completion %), On Completion (full amount), validates cannot bill more than remaining value (warning, can override), links invoice to SOW (sowId field)",
        "Billing schedule methods: FixedSchedule (recurring dates with amounts), MilestoneBased (bill when deliverables complete), ProgressBased (bill at completion thresholds), OnCompletion (bill full amount when SOW complete)",
        "Fixed Schedule config: frequency (Monthly/Quarterly/Annually/Custom), dayOfMonth (1-31), amounts array with scheduledDate and amount",
        "Milestone config: array of deliverables with amounts, status (Pending/Ready/Invoiced), Ready when deliverable completed",
        "Progress config: basis (sow_completion/deliverable_completion), thresholds array (e.g., [25, 50, 75, 100]), tracks billedPercentage",
        "On Completion config: no additional config, bills full amount when SOW marked complete",
        "Validation: scheduled amounts must not exceed SOW total value, cannot bill more than remaining value (warning)",
        "Typecheck passes"
      ],
      "priority": 213,
      "passes": true,
      "notes": "PRD-006: US-026, US-031 - SOW billing schedule backend operations"
    },
    {
      "id": "US-214",
      "title": "Create scope analysis and change order operations",
      "description": "As a developer, I need backend operations to calculate scope creep and manage change orders.",
      "acceptanceCriteria": [
        "Create getScopeAnalysis query: returns scope analysis for single SOW with overall status, budgeted vs actual hours/cost, variance, per-deliverable breakdown, unlinked work items",
        "Create getScopeAnalysisDashboard query: returns scope analysis for all active SOWs with summary metrics (On Track count, At Risk count, Over Budget count, total scope creep value)",
        "Calculate scope status: On Track (0-10% over budget), At Risk (10-25% over), Over Budget (>25% over) - thresholds configurable",
        "Calculate variance: hoursVariance = actualHours - budgetedHours, costVariance = actualCost - budgetedCost, variancePercent = (variance / budgeted) * 100",
        "Identify unlinked work items: work items for SOW client not linked to any deliverable",
        "Create listChangeOrders query: returns change orders for an SOW",
        "Create getChangeOrder query: returns change order detail with before/after comparison",
        "Create createChangeOrder mutation: validates description required, effectiveDate required, changeType required, creates change order in Pending status, updates SOW value if change type affects it",
        "Create updateChangeOrder mutation: only allows editing Pending change orders, validates all fields",
        "Create deleteChangeOrder mutation: only allows deleting Pending change orders, reverses SOW changes",
        "Create cancelChangeOrder mutation: only allows cancelling Approved change orders (reverses changes)",
        "Create approveChangeOrder mutation: changes status to Approved, applies changes to SOW",
        "Change order types: AddDeliverable (adds new deliverable), ModifyDeliverable (adjusts existing), PriceAdjustment (adjusts SOW total)",
        "Change order numbering: CO-001, CO-002, etc., sequential per SOW",
        "Validation: description required, effectiveDate required, changeType required, cannot delete/cancel if change order has been invoiced",
        "Typecheck passes"
      ],
      "priority": 214,
      "passes": true,
      "notes": "PRD-006: US-029, US-030, US-032, US-042, US-043, US-045 - Scope analysis and change orders backend"
    },
    {
      "id": "US-215",
      "title": "Create financial reporting operations",
      "description": "As a developer, I need backend operations for realization and financial reports.",
      "acceptanceCriteria": [
        "Create getRealizationReport query: calculates realization rate (billed amount / standard rate), supports filters (clientId, workId, teamMemberId, dateRange), returns realization trends",
        "Create getFinancialReports query: returns revenue, receivables, realization data, supports filters (dateRange, clientId, workType), returns data suitable for charts/graphs",
        "Realization calculation: billed amount divided by standard rate (from time entries), can be viewed by client, work item, team member",
        "Financial reports include: revenue (total invoiced), receivables (outstanding invoices), realization rates, date range filtering",
        "Export support: data formatted for PDF/Excel export",
        "Typecheck passes"
      ],
      "priority": 215,
      "passes": true,
      "notes": "PRD-006: US-008, US-010, US-011 - Financial reporting backend operations"
    },
    {
      "id": "US-216",
      "title": "Create unbilled time view UI",
      "description": "As a user, I want to view all unbilled time entries so that I can identify what needs to be billed.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/unbilled/page.tsx",
        "Display unbilled time entries in table: Date, Team Member, Work Item, Client, Hours, Rate, Amount",
        "Add filter functionality with 'Add Filter' button (client, work item, date range)",
        "Add selection checkboxes per row and 'Select All' checkbox in header",
        "Display total unbilled amount prominently at top of list",
        "Add 'Create Invoice' button (enabled when entries selected)",
        "Add bulk actions menu (Create Invoice, Export)",
        "Empty state: 'No unbilled time entries' message with link to Time Tracking",
        "Loading state: Skeleton loader during initial load",
        "Error state: Error banner with retry button if load fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 216,
      "passes": true,
      "notes": "PRD-006: US-001 - Unbilled time view UI"
    },
    {
      "id": "US-217",
      "title": "Create invoice list and detail views UI",
      "description": "As a user, I want to view all invoices and invoice details.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/invoices/page.tsx for invoice list",
        "Invoice list table: Invoice Number, Client, Date, Amount, Status",
        "Status badges: Draft (gray), Sent (blue), Paid (green), Overdue (red), Cancelled (gray)",
        "Filter by status, client, date range",
        "Sort by date, amount, invoice number",
        "Click invoice row opens detail view",
        "Create app/(dashboard)/billing/invoices/[invoiceId]/page.tsx for invoice detail",
        "Invoice detail header: Invoice Number, Date, Due Date, Client, Status",
        "Line items table: Description, Quantity (Hours), Rate, Amount",
        "Line items show source information (time entry link if from time entry)",
        "Totals section: Subtotal, Tax, Discount, Total, Amount Paid, Amount Due",
        "Payment history table: Date, Amount, Method, Notes",
        "Action buttons: Edit (Draft only), Send (Draft only), Export (all), Record Payment (Sent/Overdue), Delete (Draft only)",
        "Empty state: 'No invoices yet' message with 'Create Invoice' button",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 217,
      "passes": true,
      "notes": "PRD-006: US-003, US-004 - Invoice list and detail UI"
    },
    {
      "id": "US-218",
      "title": "Create invoice creation and editing UI",
      "description": "As a user, I want to create and edit invoices.",
      "acceptanceCriteria": [
        "Create invoice creation modal/dialog component",
        "Invoice form fields: Client (auto-filled from time entries), Invoice Date (defaults to today), Due Date (defaults to 30 days from invoice date), Line Items (from time entries or manual), Status (Draft/Sent radio buttons)",
        "Line items table: Description (editable), Quantity, Rate, Amount (calculated), Source indicator (time entry link if from time entry)",
        "Add 'Add Line Item' button for manual line items",
        "Delete icon per line item (can remove manual items, cannot remove source link from time entry items)",
        "Totals recalculate automatically when line items change",
        "Invoice number auto-generated (INV-YYYY-NNNN format, shown as read-only)",
        "Validation: Invoice date cannot be in future (error message), Due date must be after invoice date (error message), At least one line item required (error message), Quantity and rate > 0 for each line item (error message)",
        "Validation errors shown inline below fields",
        "Success toast: 'Invoice created successfully'",
        "Error handling: Error message with retry option if creation fails",
        "Modal can be closed via Cancel button, X button, Escape key (with confirmation if form has changes)",
        "Edit invoice: Same form as creation, only available for Draft invoices, pre-fills all fields",
        "Success toast: 'Invoice updated successfully'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 218,
      "passes": true,
      "notes": "PRD-006: US-002, US-013, US-021 - Invoice creation and editing UI"
    },
    {
      "id": "US-219",
      "title": "Create invoice actions UI (send, delete, export)",
      "description": "As a user, I want to send, delete, and export invoices.",
      "acceptanceCriteria": [
        "Create send invoice dialog component",
        "Send dialog: Delivery method options (Email radio, Download PDF radio), Email address field (pre-filled from client contact, editable), Email validation (valid email format)",
        "If Email selected: Send button sends email and updates status to Sent",
        "If Download PDF selected: PDF generated and downloaded immediately, status updates to Sent",
        "Success toast: 'Invoice sent successfully' (with email address if emailed)",
        "Sent invoices cannot be edited (Edit button hidden)",
        "Create delete confirmation dialog: 'Are you sure you want to delete this invoice? This action cannot be undone.' (shows invoice number and amount)",
        "Delete button only available for Draft invoices",
        "Delete confirmation has Cancel and Delete buttons",
        "Success toast: 'Invoice deleted successfully'",
        "User redirected to invoice list after successful deletion",
        "Create export functionality: Export button generates PDF, supports bulk export",
        "Error handling: Error message with retry option for all actions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 219,
      "passes": true,
      "notes": "PRD-006: US-014, US-020, US-011 - Invoice actions UI"
    },
    {
      "id": "US-220",
      "title": "Create fixed fee invoice creation UI",
      "description": "As a user, I want to create invoices for fixed fee work items.",
      "acceptanceCriteria": [
        "Add 'Create Invoice' button to fixed fee work item detail view",
        "Button only visible for fixed fee work items",
        "Invoice creation modal opens with work item context",
        "Form pre-fills: Client (from work item, read-only), Work Item (from work item, read-only), Fixed Amount (defaults to work item budget amount if available, required)",
        "Line item description field (optional, defaults to work item name)",
        "Invoice date defaults to today, can be changed",
        "Due date defaults to 30 days from invoice date, can be changed",
        "Validation: Fixed amount must be > 0, Invoice date cannot be in future, Due date must be after invoice date",
        "Invoice created with single line item (fixed amount)",
        "Success toast: 'Invoice created successfully'",
        "User redirected to invoice detail view",
        "Error handling: Error message with retry option",
        "Modal can be closed via Cancel button, X button, Escape key (with confirmation if form has changes)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 220,
      "passes": true,
      "notes": "PRD-006: US-022 - Fixed fee invoice creation UI"
    },
    {
      "id": "US-221",
      "title": "Create billing run UI",
      "description": "As a user, I want to process billing runs and view billing run history.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/billing-runs/page.tsx for billing run list",
        "Billing run list table: Date, Name, Status, Invoices Created, Errors",
        "Status badges: Pending (yellow), Processing (blue), Completed (green), Failed (red), Cancelled (gray)",
        "Filter by status and date range",
        "Sort by date (newest first)",
        "Click row opens detail view",
        "Create app/(dashboard)/billing/billing-runs/[runId]/page.tsx for billing run detail",
        "Billing run detail header: Name, Date, Status, Duration",
        "Created invoices list with links to invoice detail",
        "Error details section (if any) with error messages and affected time entries",
        "Retry button (for Failed runs)",
        "Cancel button (for Pending/Processing runs)",
        "Summary statistics: Total Invoices Created, Total Amount, Errors Count",
        "Progress indicator for Processing runs (percentage complete, current operation)",
        "Create billing run creation interface: Time entry selection (checkboxes, Select All), Preview of invoices to be created (grouped by client), Billing run name field (optional, defaults to date), Process button",
        "Empty state: 'No billing runs yet' message with 'Process Billing Run' button",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Success toast: 'Billing run completed successfully. X invoices created.'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 221,
      "passes": true,
      "notes": "PRD-006: US-005, US-015, US-016, US-041 - Billing run UI"
    },
    {
      "id": "US-222",
      "title": "Create receivables and payment recording UI",
      "description": "As a user, I want to track receivables and record payments.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/receivables/page.tsx for receivables view",
        "Receivables table: Invoice Number, Client, Amount, Due Date, Days Overdue, Amount Due",
        "Aging report section: Buckets (0-30, 31-60, 61-90, 90+ days) with totals per bucket",
        "Filter by client, date range, overdue status",
        "Sort by due date, amount, days overdue",
        "Record Payment button per invoice (opens modal)",
        "Create record payment modal component",
        "Payment form: Payment Amount (defaults to amount due, can be changed), Payment Date (defaults to today), Payment Method (dropdown: Check, ACH, Credit Card, Wire Transfer, Cash, Other), Payment Notes (optional)",
        "Invoice information displayed: Invoice Number, Amount Due",
        "Validation: Payment amount must be > 0, Payment amount cannot exceed amount due, Payment date cannot be in future",
        "Validation errors shown inline below fields",
        "Partial payments supported (amount can be less than amount due)",
        "Success toast: 'Payment recorded successfully'",
        "Invoice status updates: Paid when fully paid, Sent if partially paid",
        "Payment history maintained (all payments shown chronologically)",
        "Empty state: 'No outstanding invoices' message",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 222,
      "passes": true,
      "notes": "PRD-006: US-006, US-007 - Receivables and payment recording UI"
    },
    {
      "id": "US-223",
      "title": "Create payment management UI",
      "description": "As a user, I want to view, edit, and void payments.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/payments/page.tsx for payment list",
        "Payment list table: Date, Invoice Number, Client, Amount, Method, Status",
        "Status badges: Active (green), Voided (gray)",
        "Filter by date range, client, invoice, payment method",
        "Sort by date, amount, invoice number",
        "Click row opens detail view",
        "Create app/(dashboard)/billing/payments/[paymentId]/page.tsx for payment detail",
        "Payment detail header: Payment Date, Amount, Method, Status",
        "Payment notes displayed (if any)",
        "Linked invoice information: Invoice Number, Client, Invoice Amount, Amount Due (with link to invoice)",
        "Edit button (if payment is Active and within edit window - default 7 days)",
        "Void button (if payment is Active and within void window - default 30 days)",
        "Create edit payment modal component",
        "Edit form: Payment Amount (editable), Payment Date (editable), Payment Method (dropdown), Payment Notes (editable)",
        "Validation: Payment amount > 0, Payment amount cannot exceed invoice amount due, Payment date cannot be in future, If payment amount changes, invoice status updates accordingly",
        "Success toast: 'Payment updated successfully'",
        "Create void payment confirmation dialog: 'Are you sure you want to void this payment? This will update the invoice status. This action cannot be undone.'",
        "Void reason field required (text area)",
        "Payment status changes to Voided, invoice amount paid decreases, invoice status updates (Paid \u2192 Sent if payment was making it paid)",
        "Voided payments remain visible but marked as voided (grayed out, 'Voided' badge)",
        "Void reason displayed in payment detail view",
        "Success toast: 'Payment voided successfully'",
        "Empty state: 'No payments recorded yet' message",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 223,
      "passes": true,
      "notes": "PRD-006: US-037, US-038, US-039, US-040 - Payment management UI"
    },
    {
      "id": "US-224",
      "title": "Create recurring billing UI",
      "description": "As a user, I want to configure and manage recurring billing.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/recurring-billing/page.tsx for recurring billing list",
        "Recurring billing list table: Client, Work Item, Frequency, Next Date, Status (Active/Paused), Amount",
        "Status badges: Active (green), Paused (gray)",
        "Filter by status (Active, Paused) and client",
        "Sort by next date, client, frequency",
        "Click row opens detail view",
        "Create app/(dashboard)/billing/recurring-billing/[recurringId]/page.tsx for recurring billing detail",
        "Detail header: Client, Work Item (if applicable), Name, Frequency, Billing Method, Status",
        "Configuration details: Amount (if Fixed), Next Billing Date, Last Billing Date",
        "Billing history section: List of invoices generated (Invoice Number, Date, Amount, Status with links)",
        "Pause/Resume toggle (switches isActive status)",
        "Edit button (opens edit form)",
        "Delete button",
        "Create recurring billing creation/edit modal component",
        "Form fields: Client (required, dropdown), Work Item (optional, dropdown), Name/Description (text), Frequency (dropdown: Monthly, Quarterly, Annually), Billing Method (radio: Fixed Amount, Time-Based), Amount (required if Fixed method, must be > 0), Next Billing Date (defaults to first occurrence based on frequency, must be in future)",
        "Validation: Client required, Next billing date must be in future, Amount must be > 0 if Fixed Amount method",
        "Validation errors shown inline below fields",
        "Success toast: 'Recurring billing created successfully' or 'Recurring billing updated successfully'",
        "Empty state: 'No recurring billing configured' message with 'Create Recurring Billing' button",
        "Empty state for billing history: 'No invoices generated yet. Next invoice will be created on [date].'",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 224,
      "passes": true,
      "notes": "PRD-006: US-009, US-017, US-018, US-019, US-044 - Recurring billing UI"
    },
    {
      "id": "US-225",
      "title": "Create SOW list and detail views UI",
      "description": "As a user, I want to view all SOWs and SOW details.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/sows/page.tsx for SOW list",
        "SOW list table: SOW Number, Client, Name, Total Value, Status, Start Date, End Date, Amount Billed, Remaining",
        "Progress bar in each row (billed vs total)",
        "Status badges: Draft (yellow), Active (green), Complete (blue), Cancelled (gray)",
        "Filter by status (Draft, Active, Complete, Cancelled) and client",
        "Sort by date, value, client",
        "'Create SOW' button in header",
        "Click row opens detail view",
        "Create app/(dashboard)/billing/sows/[sowId]/page.tsx for SOW detail",
        "SOW detail header: SOW Number, Name, Client Name, Status badge, Effective dates (Start - End), Total Value (prominent)",
        "Action buttons: Edit (Draft only), Activate (Draft only), Create Invoice (Active only), Mark Complete (Active only), Cancel (Draft/Active only)",
        "Billing Summary Card: Total Contract Value, Amount Billed (with progress bar), Amount Remaining, Next Billing Date and Amount",
        "Tabs: Deliverables, Scope Analysis, Billing History, Change Orders, Details",
        "Deliverables tab: List of deliverables with budget/actual/variance (click to view detail)",
        "Scope Analysis tab: Detailed scope creep analysis",
        "Billing History tab: Invoices generated from this SOW",
        "Change Orders tab: Change order history (click to view detail)",
        "Details tab: SOW metadata, billing schedule configuration",
        "Empty state: 'No SOWs yet' message with 'Create SOW' button",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 225,
      "passes": true,
      "notes": "PRD-006: US-027, US-028 - SOW list and detail UI"
    },
    {
      "id": "US-226",
      "title": "Create SOW creation and editing UI",
      "description": "As a user, I want to create and edit SOWs.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/sows/new/page.tsx for SOW creation (full page form)",
        "Create app/(dashboard)/billing/sows/[sowId]/edit/page.tsx for SOW editing (full page form)",
        "Basic Information section: Client selector (required), SOW Name (required), Description (optional textarea), Reference Number (optional), Start Date (required), End Date (optional)",
        "Deliverables section: Inline table for adding deliverables, Columns: Name, Description, Budgeted Hours, Fixed Amount, Template (optional), 'Add Deliverable' button, Running total of deliverable amounts, Warning if total doesn't match SOW value",
        "Click deliverable row to edit (modal for detailed editing)",
        "Deliverable fields: Name (required), Description (optional), Budgeted Hours (optional, >= 0), Fixed Amount (required, > 0), Template link (optional), Billing milestone (optional)",
        "Deliverables can be reordered via drag-and-drop",
        "Delete icon per deliverable (Draft SOWs only)",
        "Billing Schedule section: Method selector (Fixed Schedule, Milestone, Progress, On Completion), Configuration options based on method, Preview of billing schedule",
        "Fixed Schedule config: Frequency (Monthly/Quarterly/Annually/Custom), Amount per billing cycle, Billing day of month (for recurring)",
        "Milestone-Based config: Select which deliverables trigger billing, Amount per milestone (defaults to deliverable amount)",
        "Progress-Based config: Bill based on SOW completion % or deliverable completion %, Minimum threshold to bill (e.g., 25%, 50%, 75%, 100%)",
        "On Completion config: Full amount billed when SOW status changes to Complete",
        "Totals section: Total Contract Value (required), Calculated: Sum of deliverables, Mismatch warning if different",
        "Actions: 'Save as Draft' button (for new SOWs) or 'Save' button (for edits), 'Save and Activate' button (validates completeness, only for new Draft SOWs), Cancel button (with unsaved changes warning)",
        "Validation: Client required, SOW name required, Start date required, End date must be after start date (if provided), Total value must be > 0, At least one deliverable required to activate, Deliverable name required, Deliverable amount > 0",
        "Validation errors shown inline below fields",
        "SOW number auto-generated (SOW-YYYY-NNNN format, shown as read-only after creation)",
        "Success toast: 'SOW created successfully' or 'SOW updated successfully'",
        "Error handling: Error message with retry option",
        "Form can be cancelled (Cancel button, X button, Escape key) with confirmation if form has changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 226,
      "passes": true,
      "notes": "PRD-006: US-023, US-024, US-026, US-036 - SOW creation and editing UI"
    },
    {
      "id": "US-227",
      "title": "Create SOW deliverable management UI",
      "description": "As a user, I want to manage SOW deliverables and link work items.",
      "acceptanceCriteria": [
        "Deliverables tab in SOW detail shows table: Name, Budgeted Hours, Actual Hours (calculated from linked work items), Hours Variance (with color indicator), Fixed Amount, Status (Not Started, In Progress, Completed, Billed)",
        "'Add Deliverable' button (Draft SOWs only)",
        "Deliverables can be reordered via drag-and-drop",
        "Click deliverable row opens deliverable detail (modal or expanded section)",
        "Deliverable detail view: Name, Status, Fixed Amount, Budgeted Hours, Description, Budget vs Actual section (Hours and cost comparison with variance), Linked Work Items section (List with links, unlink buttons), Time Entries section (Aggregated from linked work items), Billing History section (Invoices that billed this deliverable)",
        "'Link Work Item' button: Opens work item selector (filtered by SOW client), Multiple work items can be linked to one deliverable, One work item can only be linked to one deliverable (prevent double-counting)",
        "Unlink button per work item: Removes work item from deliverable, Recalculates actual hours/cost",
        "Edit button (Draft SOWs only): Opens deliverable edit modal",
        "Mark Complete button (Active SOWs, In Progress deliverables): Updates deliverable status to Completed",
        "Empty state: 'No deliverables yet. Add deliverables to define the scope of work.' with 'Add Deliverable' button",
        "Empty state for linked work items: 'No work items linked yet. Link work items to track time against this deliverable.' with 'Link Work Item' button",
        "Empty state for billing history: 'This deliverable has not been billed yet'",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Success toast: 'Deliverable added', 'Deliverable updated', 'Work item linked to deliverable'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 227,
      "passes": true,
      "notes": "PRD-006: US-024, US-025, US-046 - SOW deliverable management UI"
    },
    {
      "id": "US-228",
      "title": "Create scope analysis UI",
      "description": "As a user, I want to view scope creep analysis for SOWs.",
      "acceptanceCriteria": [
        "Scope Analysis tab in SOW detail shows: Health Summary Card (Overall status: On Track/At Risk/Over Budget, Total budgeted hours vs actual hours, Total budgeted cost vs actual cost, Variance % prominent, color-coded), Deliverable Breakdown Table (All deliverables with scope metrics, Columns: Name, Budget Hrs, Actual Hrs, Variance Hrs, Variance %, Status, Sortable by variance worst first, Color-coded status indicators, Click to expand for time entry details), Work Outside SOW Section (Warning banner if unlinked work exists, List of work items for this client not linked to any deliverable, Shows hours and cost that may be scope creep, 'Link to Deliverable' button per item, 'Create Change Order' button to add as new deliverable)",
        "Create app/(dashboard)/billing/scope-analysis/page.tsx for scope analysis dashboard",
        "Dashboard Summary Cards Row: Total Active SOWs, On Track (count + %), At Risk (count + %), Over Budget (count + %), Total Scope Creep Value ($)",
        "SOW Health Table: All active SOWs with scope metrics, Columns: Client, SOW Name, Budget Hrs, Actual Hrs, Variance %, Status, Default sort: Variance % descending (worst first), Filter by status (On Track, At Risk, Over Budget), Filter by client, Click row to view SOW detail",
        "Client Summary Section: Aggregate view by client, Shows clients with multiple problem SOWs",
        "Time period filter: Active (current period) or Historical (completed SOWs within date range)",
        "Export button (PDF/Excel)",
        "Variance thresholds: On Track (0-10% over budget, green), At Risk (10-25% over, yellow), Over Budget (>25% over, red) - configurable in Settings",
        "Empty state: 'No active SOWs. Scope analysis is available for active SOWs.' with 'View All SOWs' link",
        "Empty state for Work Outside SOW: 'All work items are linked to SOW deliverables' (green indicator)",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 228,
      "passes": true,
      "notes": "PRD-006: US-029, US-030 - Scope analysis UI"
    },
    {
      "id": "US-229",
      "title": "Create SOW actions UI (activate, complete, cancel, create invoice)",
      "description": "As a user, I want to activate, complete, cancel SOWs and create invoices from SOWs.",
      "acceptanceCriteria": [
        "Activate button (Draft SOWs only): Validation before activation (at least one deliverable exists, total value > 0, start date set, deliverable amounts sum matches total value warning), Confirmation dialog: 'Activate SOW '[Name]'? The billing schedule will begin based on the start date.', Success toast: 'SOW activated', SOW status changes to Active",
        "Mark Complete button (Active SOWs only): Completion summary shows (Total billed vs total value, Unbilled deliverables warning if any, Scope creep summary), Warning if unbilled amount > 0: 'There is $X remaining unbilled. Do you want to create a final invoice?', Option to create final invoice before completing, Confirmation dialog: 'Mark SOW '[Name]' as complete? This will close the agreement.', Success toast: 'SOW marked complete', SOW status changes to Complete",
        "Cancel button (Draft/Active SOWs only): Confirmation dialog with reason field (required), Warning if invoices have been created: 'X invoices totaling $Y have been billed against this SOW. Cancelling will not void those invoices.', Confirmation dialog: 'Cancel SOW '[Name]'? This action cannot be undone.', Success toast: 'SOW cancelled', SOW status changes to Cancelled",
        "Create Invoice button (Active SOWs only): Opens invoice creation form pre-filled from billing schedule, For Fixed Schedule: Amount matches scheduled billing amount, For Milestone-Based: Lists completed deliverables not yet billed, For Progress-Based: Calculates amount based on current completion %, Invoice line items reference SOW and deliverable names, User can adjust amounts before creating (with warning if differs from schedule), Invoice is linked to SOW (sowId field), SOW 'Amount Billed' updates after invoice created, Validation: Cannot bill more than SOW remaining value (warning, can override), Success toast: 'Invoice created from SOW'",
        "All actions show appropriate loading states and error handling",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 229,
      "passes": true,
      "notes": "PRD-006: US-031, US-033, US-034, US-035 - SOW actions UI"
    },
    {
      "id": "US-230",
      "title": "Create change order management UI",
      "description": "As a user, I want to create, view, edit, and manage change orders.",
      "acceptanceCriteria": [
        "Change Orders tab in SOW detail shows: List of change orders with Change Order Number, Change Type, Effective Date, Status, Click row opens change order detail",
        "'Create Change Order' button (Active SOWs only)",
        "Create change order modal component",
        "Change order form fields: Change Order Number (auto-generated CO-001, CO-002, etc.), Description of change (required), Effective date (required), Change type (dropdown: Add Deliverable, Modify Deliverable, Price Adjustment)",
        "For Add Deliverable: New deliverable form (same as US-024), Added to SOW deliverables list, SOW total value increases",
        "For Modify Deliverable: Select existing deliverable, Adjust budgeted hours or amount, Describe reason for change",
        "For Price Adjustment: Adjust SOW total value, Describe reason (e.g., annual rate increase)",
        "Change order history maintained on SOW",
        "Change order detail view (modal or expanded section): Change Order Number, Change Type, Effective Date, Status, Description field (full text), Change details section (Before/after comparison based on change type), Approval status (Pending/Approved/Rejected with approver and date if approved/rejected), Impact on SOW (Shows how SOW total value changed), Linked invoices section (Shows if change order has been invoiced with invoice links)",
        "Edit button (Pending status only): Opens change order edit modal, All fields editable based on change type",
        "Delete button (Pending status only): Confirmation dialog: 'Are you sure you want to delete this change order? This will remove the changes to the SOW. This action cannot be undone.' (shows change order number and change amount)",
        "Cancel button (Approved status only, if not invoiced): Confirmation dialog: 'Are you sure you want to cancel this change order? This will reverse the changes to the SOW. This action cannot be undone.', Reverses SOW changes",
        "Approve/Reject buttons (if user has permission and status is Pending)",
        "Validation: Description required, Effective date required, Change type required, Cannot delete/cancel if change order has been invoiced (button disabled with tooltip)",
        "Success toast: 'Change order created', 'Change order updated successfully', 'Change order deleted successfully', 'Change order cancelled successfully'",
        "Empty state: 'No change orders' message",
        "Empty state for linked invoices: 'This change order has not been invoiced yet'",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 230,
      "passes": true,
      "notes": "PRD-006: US-032, US-042, US-043, US-045 - Change order management UI"
    },
    {
      "id": "US-231",
      "title": "Create financial reports UI",
      "description": "As a manager, I want to view financial reports.",
      "acceptanceCriteria": [
        "Create app/(dashboard)/billing/realization/page.tsx for realization report",
        "Realization view: Realization rate calculated (billed amount / standard rate), Can be viewed by client, work item, team member, Date range filtering available, Realization trends displayed (charts/graphs)",
        "Create app/(dashboard)/billing/finance/page.tsx for financial reports",
        "Financial reports show: Revenue (total invoiced), Receivables (outstanding invoices), Realization rates, Reports can be filtered by date range, client, work type, Reports can be exported (PDF/Excel), Visual charts and graphs available",
        "Loading state: Skeleton loader",
        "Error state: Error banner with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 231,
      "passes": true,
      "notes": "PRD-006: US-008, US-010 - Financial reports UI"
    },
    {
      "id": "US-232",
      "title": "Add billing navigation to sidebar",
      "description": "As a user, I need navigation to access all billing features.",
      "acceptanceCriteria": [
        "Add Billing section to sidebar navigation",
        "Billing navigation items: SOWs, Scope Analysis, Unbilled, Invoices, Billing Runs, Receivables, Payments, Recurring Billing, Realization, Finance",
        "Navigation items link to respective pages",
        "Active state indicators (dots, borders) for current page",
        "Hover states with transitions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 232,
      "passes": true,
      "notes": "PRD-006: Navigation structure"
    },
    {
      "id": "US-233",
      "title": "Add queue and category schema and backend operations",
      "description": "As a developer, I need database schema and backend operations for queues, queue memberships, and categories.",
      "acceptanceCriteria": [
        "Add queues table with fields: tenantId, name, description, organizationId (optional), defaultAssigneeId, slaPolicyId, isActive, isDefault, ticketCount, openTicketCount, createdAt, updatedAt",
        "Add queueMemberships table with fields: tenantId, queueId, userId, role ('member' | 'manager'), createdAt",
        "Add ticketCategories table with fields: tenantId, name, parentId (optional), color, isActive, sortOrder, createdAt, updatedAt",
        "Update tickets table: add queueId (required), categoryId (optional), subcategoryId (optional)",
        "Update connectedInboxes table: add queueId (required), remove clientId",
        "Create queues queries: list, get, getMyQueues, getTicketCounts",
        "Create queues mutations: create, update, delete, syncFromClients",
        "Create queueMemberships queries: getForUser, getForQueue",
        "Create queueMemberships mutations: add, remove, updateRole, bulkSet",
        "Create categories queries: list (returns tree structure), get",
        "Create categories mutations: create, update, delete, reorder",
        "Update tickets queries to filter by queueId, queueIds, categoryId",
        "Update tickets mutations to support queueId, categoryId, subcategoryId",
        "Update inboxes mutations to require queueId on create/update",
        "Add indexes on queueId, organizationId, userId for performance",
        "Typecheck passes"
      ],
      "priority": 233,
      "passes": true,
      "notes": "PRD-014: Schema and backend operations combined"
    },
    {
      "id": "US-234",
      "title": "Create queue list page with search and filters",
      "description": "As an administrator, I want to see all queues in the system so that I can manage queue configuration.",
      "acceptanceCriteria": [
        "Create Settings \u2192 Tickets \u2192 Queues page",
        "Table view with columns: Name, Type (Client/General), Organization, Inboxes, Members, Open Tickets, Status",
        "Search/filter by name input field",
        "Sort by any column",
        "Filter by: Active/Inactive, Client/General",
        "Sticky header with 'New Queue' button remains visible while scrolling",
        "Table scrolls independently below header",
        "Client queues show organization name",
        "General queues show '\u2014' for organization",
        "Shows count of connected inboxes per queue",
        "Shows count of assigned members per queue",
        "Shows open ticket count",
        "Empty state: 'No queues yet. Create your first queue or sync from clients.' with 'Create Queue' button",
        "Loading skeleton shown during initial data fetch (5-7 placeholder rows)",
        "Error states handled with retry option",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 234,
      "passes": true,
      "notes": "PRD-014: US-001 - Queue list page"
    },
    {
      "id": "US-235",
      "title": "Create queue create, edit, and delete UI",
      "description": "As an administrator, I want to create, edit, and delete queues so that I can manage queue configuration.",
      "acceptanceCriteria": [
        "Create Queue modal/form: Name (required, max 100 chars), Description (optional), Type radio (Client Queue/General Queue), Organization dropdown (required if Client Queue), Connected Inboxes multi-select, Default Assignee dropdown (optional), SLA Policy dropdown (optional)",
        "Form validation: Cannot create duplicate queue names within tenant, shows inline errors",
        "Inboxes already assigned show '(Currently: [Queue Name])' and selecting them will reassign",
        "Creating queue auto-creates membership for current user as manager",
        "Submit button shows loading spinner, disabled during save",
        "Success toast appears on creation",
        "Edit Queue slide-over panel (600px width) with tabs: General, Inboxes, Members, Settings",
        "General tab: Name, Description, Organization (editable for client queues), Status toggle, Created date (read-only), Ticket count (read-only, links to filtered view)",
        "Inboxes tab: List of connected inboxes, 'Add Inbox' button with dropdown, Remove inbox button per row, Empty state message",
        "Members tab: List of assigned users with role, 'Add Member' button, Change role dropdown per user, Remove member button, Empty state message",
        "Settings tab: Default Assignee dropdown, SLA Policy dropdown, 'Make Default Queue' toggle, Delete Queue button in danger zone",
        "Panel tabs are sticky at top, content scrolls independently",
        "Auto-save with 2-second debounce, 'Saving...' indicator during save",
        "Cannot remove last manager from queue (error shown)",
        "Cannot deactivate queue with open tickets (warning shown)",
        "Organization cannot be changed if queue has tickets (field disabled with tooltip)",
        "Delete Queue: If queue has tickets, shows modal to select destination queue for moving tickets, then deletes",
        "If queue has no tickets, shows confirmation modal before deletion",
        "Cannot delete default queue (error shown)",
        "Success toast appears after save/delete",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 235,
      "passes": true,
      "notes": "PRD-014: US-002, US-003, US-004 - Queue CRUD operations"
    },
    {
      "id": "US-236",
      "title": "Add queue membership management UI",
      "description": "As an administrator, I want to assign users to queues so that team members can see their assigned queues.",
      "acceptanceCriteria": [
        "Add 'Queue Assignments' tab to User menu \u2192 'My Settings'",
        "Shows list of queues user is assigned to with role (Member/Manager), organization name for client queues, open ticket count per queue",
        "Clicking queue links to ticket list filtered to that queue",
        "Empty state: 'You're not assigned to any queues yet. Contact your administrator to be added to queues.'",
        "Loading skeleton shown during data fetch (3-5 placeholder rows)",
        "Add 'Queue Assignments' tab to Settings \u2192 Users \u2192 Click user",
        "Checkbox list of all queues with check/uncheck to assign/unassign",
        "Role dropdown per assignment (Member/Manager)",
        "Shows which queues user is currently in (checked)",
        "Save button shows loading spinner, disabled during save",
        "Cannot remove last manager from any queue (validation error)",
        "Success toast appears after save",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 236,
      "passes": true,
      "notes": "PRD-014: US-006, US-007 - Queue membership management"
    },
    {
      "id": "US-237",
      "title": "Add queue sidebar integration and ticket filtering",
      "description": "As a team member, I want to see my assigned queues in the sidebar and filter tickets by queue.",
      "acceptanceCriteria": [
        "Add 'MY CLIENTS' section to Tickets page sidebar showing queues with organizations",
        "Add 'GENERAL QUEUES' section showing queues without organizations",
        "Queue names show open ticket count in parentheses",
        "Clicking queue name filters ticket list to that queue",
        "Active queue is highlighted",
        "Sections collapse/expand (remember state)",
        "If user has no queue assignments, sections don't appear",
        "Counts update in real-time",
        "Active queue filter shown in breadcrumb/header: '[Queue Name] \u00d7' (X clears filter)",
        "Clicking queue name again toggles filter off",
        "Filter persists in URL for bookmarking/sharing",
        "Can combine queue filter with other filters (status, assignee, etc.)",
        "Clearing queue filter returns to previous view (or 'All Tickets' if no previous view)",
        "Page title updates to queue name when filtered",
        "Empty state if no assignments: 'You're not assigned to any queues yet.'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 237,
      "passes": true,
      "notes": "PRD-014: US-008, US-009 - Queue sidebar and filtering"
    },
    {
      "id": "US-238",
      "title": "Add auto-create queues from clients feature",
      "description": "As an administrator, I want to automatically create queues for clients with connected inboxes.",
      "acceptanceCriteria": [
        "Add 'Sync Queues from Clients' button on queue list page",
        "Confirmation modal shows: 'This will create queues for X clients that have connected inboxes but no queue.'",
        "Lists the clients that will get queues",
        "User clicks 'Create Queues'",
        "Only creates queues for orgs without existing queues",
        "Links all org's inboxes to the new queue automatically",
        "Names queue after organization",
        "Adds current user as queue manager",
        "Toast: 'Created X queues'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 238,
      "passes": true,
      "notes": "PRD-014: US-005 - Auto-create queues"
    },
    {
      "id": "US-239",
      "title": "Create category management UI",
      "description": "As an administrator, I want to manage ticket categories so that tickets can be classified.",
      "acceptanceCriteria": [
        "Create Settings \u2192 Tickets \u2192 Categories page",
        "Tree view showing categories and subcategories (max 2 levels depth)",
        "Columns: Name (with color indicator), Subcategories count, Tickets using, Status",
        "Can expand/collapse categories with children",
        "Shows usage count per category",
        "Can filter Active/Inactive",
        "Sticky header with 'Add Category' button",
        "Tree view scrolls independently below header",
        "Empty state: 'No categories yet. Create your first category to start classifying tickets.' with 'Add Category' button",
        "Loading skeleton shown during initial data fetch (5-7 placeholder rows)",
        "Create Category: Inline form or modal with Name (required, max 50 chars), Color picker (optional with preset colors + custom hex), Save/Cancel buttons",
        "Cannot create duplicate names at same level (within same parent)",
        "Subcategories indent under parent visually",
        "New categories default to Active",
        "Cannot create subcategory of a subcategory (max depth: 2 levels)",
        "Edit Category: Name becomes editable inline, color picker appears, saves automatically or with explicit save",
        "Delete Category: If category has tickets, shows warning 'X tickets use this category. Remove category from these tickets and delete?'",
        "If category has subcategories, shows 'This will also delete X subcategories.'",
        "Confirmation dialog prevents accidental deletion",
        "Tickets lose category assignment (set to null) when category deleted",
        "Success toast appears on create/update/delete",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 239,
      "passes": true,
      "notes": "PRD-014: US-010, US-011, US-012, US-013 - Category management"
    },
    {
      "id": "US-240",
      "title": "Add category assignment to tickets",
      "description": "As a team member, I want to set a category on a ticket so that tickets are properly classified.",
      "acceptanceCriteria": [
        "Add Category dropdown to ticket detail panel showing category hierarchy with color indicators",
        "Subcategory dropdown appears below category dropdown when parent has subcategories",
        "Clear option: 'None' or 'Clear category' option at top of dropdown",
        "Selected category shows color badge/chip",
        "Can set category without subcategory",
        "Can clear category (set to none)",
        "Shows in ticket list table (optional column)",
        "Color indicators shown in dropdown",
        "Changes save automatically (or with explicit save button)",
        "Loading state on dropdown during save",
        "Error toast on save failure with retry option",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 240,
      "passes": true,
      "notes": "PRD-014: US-014 - Category assignment"
    },
    {
      "id": "US-241",
      "title": "Add queue and category navigation to settings",
      "description": "As a user, I need navigation to access queue and category management.",
      "acceptanceCriteria": [
        "Add 'Queues' item to Settings \u2192 Tickets section",
        "Add 'Categories' item to Settings \u2192 Tickets section",
        "Navigation items link to respective pages",
        "Active state indicators (dots, borders) for current page",
        "Hover states with transitions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 241,
      "passes": true,
      "notes": "PRD-014: Settings navigation structure"
    },
    {
      "id": "US-242",
      "title": "Add recurring work schema and schedule configuration",
      "description": "As a developer, I need database schema for recurring work automation including schedule configuration, recurring work subscriptions, and automation run tracking.",
      "acceptanceCriteria": [
        "Extend Template schema: Add defaultSchedule (ScheduleConfig), defaultBudgetHours, defaultBudgetUSD fields",
        "Add ScheduleConfig type: frequency ('weekly'|'monthly'|'quarterly'|'annually'), daySpecification (DaySpecification union), dueDateOffsetDays, leadTimeDays",
        "Add DaySpecification union type supporting: dayOfMonth, dayOfWeek, nthDayOfWeek, lastDayOfMonth, monthAndDay",
        "Create RecurringWork table: recurringWorkId, tenantId, templateId, clientId, status ('active'|'paused'|'ended'), scheduleOverride, budgetHoursOverride, budgetUSDOverride, teamAssignments array, skippedOccurrences, skipReason, namePattern, lastWorkCreatedAt, lastWorkCreatedId, nextScheduledDate, pausedAt, pausedBy, endedAt, endedBy, createdBy, createdAt, updatedBy, updatedAt",
        "Create AutomationRun table: runId, tenantId, triggerType ('scheduled'|'manual'), triggeredBy, startedAt, completedAt, recurringWorkIds array, status ('running'|'completed'|'partial'|'failed'|'cancelled'), workItemsCreated array, errors array, totalProcessed, totalCreated, totalSkipped, totalFailed",
        "Extend WorkItem schema: Add recurringWorkId, automationRunId, period (string), createdByType ('user'|'automation') fields",
        "Add indexes: recurringWorkId on RecurringWork, templateId+clientId on RecurringWork, tenantId+status on RecurringWork, tenantId on AutomationRun",
        "Typecheck passes"
      ],
      "priority": 242,
      "passes": true,
      "notes": "PRD-016: Schema foundation for recurring work automation"
    },
    {
      "id": "US-243",
      "title": "Create recurring work CRUD operations",
      "description": "As a developer, I need backend operations to create, read, update, and manage recurring work subscriptions.",
      "acceptanceCriteria": [
        "Create listRecurringWork query: Filter by tenantId, optional filters (clientId, templateId, status)",
        "Create getRecurringWork query: Get single subscription by ID",
        "Create createRecurringWork mutation: Validate template exists, client exists, schedule config valid, create subscription with status 'active', calculate nextScheduledDate",
        "Create updateRecurringWork mutation: Update schedule overrides, budget overrides, team assignments, name pattern, recalculate nextScheduledDate if schedule changed",
        "Create deleteRecurringWork mutation: Delete subscription (work items remain)",
        "Create pauseRecurringWork mutation: Set status to 'paused', set pausedAt and pausedBy",
        "Create resumeRecurringWork mutation: Set status to 'active', clear pausedAt/pausedBy, recalculate nextScheduledDate",
        "Create endRecurringWork mutation: Set status to 'ended', set endedAt and endedBy",
        "Create skipOccurrences mutation: Set skippedOccurrences count (1-12), optional skipReason",
        "Create duplicateRecurringWork mutation: Create new subscription(s) for other client(s) with copied settings (except team assignments)",
        "Create manualTriggerRecurringWork mutation: Create work item for next scheduled period immediately",
        "Create listRecurringWorkByClient query: Get all subscriptions for a client",
        "Create listRecurringWorkByTemplate query: Get all subscriptions for a template",
        "All mutations validate permissions and tenant isolation",
        "Typecheck passes"
      ],
      "priority": 243,
      "passes": true,
      "notes": "PRD-016: Backend CRUD operations for recurring work subscriptions"
    },
    {
      "id": "US-244",
      "title": "Create automation engine and scheduled work creation",
      "description": "As a system, I need automated job that creates work items based on recurring work schedules.",
      "acceptanceCriteria": [
        "Create scheduled Convex function (runs hourly per tenant): processRecurringWorkAutomation",
        "Query all active RecurringWork subscriptions for tenant",
        "For each subscription: Calculate if work should be created based on lead time and current date",
        "If due for creation: Check skip count (decrement if > 0, skip if still > 0), create work item from template, apply subscription settings (budget, team), set period and due date, link to recurring work, set createdByType='automation'",
        "Duplicate prevention: Check if work exists for same recurringWorkId + period before creating",
        "Error handling: Log errors per subscription but continue processing others",
        "Create AutomationRun record: Track triggerType='scheduled', processed subscriptions, created work items, errors, status",
        "Update RecurringWork: Set lastWorkCreatedAt, lastWorkCreatedId, nextScheduledDate",
        "Handle timezone: Use tenant timezone setting for date calculations",
        "Handle edge cases: Month-end dates (Feb 30 \u2192 Feb 28/29), last day of month",
        "Typecheck passes"
      ],
      "priority": 244,
      "passes": true,
      "notes": "PRD-016: Core automation engine for scheduled work creation"
    },
    {
      "id": "US-245",
      "title": "Add schedule settings section to template editor",
      "description": "As an administrator, I want to configure default schedule settings on templates so recurring work subscriptions inherit sensible defaults.",
      "acceptanceCriteria": [
        "Add 'Schedule Settings' collapsible section to template editor",
        "Show empty state when no schedule: 'No schedule configured. Set up default schedule for recurring work subscriptions.' with 'Configure Schedule' button",
        "Frequency dropdown: Weekly, Monthly, Quarterly, Annually options",
        "Day specification UI adapts to frequency: Weekly (day of week picker), Monthly (day 1-31 or 'Last day'), Quarterly (month in quarter + day), Annually (month + day pickers)",
        "Due date offset: Number input with 'days after period end' label",
        "Lead time: Number input with 'days before due date' label",
        "Preview section: Shows example 'For January 2026: Due Feb 15, Created Feb 5'",
        "Default budget fields: Hours and USD inputs",
        "Required fields marked with asterisk (*)",
        "Validation: Lead time must be positive, due date offset must be non-negative",
        "Validation errors shown inline below fields (on blur or submit)",
        "Error summary at top of form if multiple validation errors",
        "Changes auto-save (draft) or require publish",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 245,
      "passes": true,
      "notes": "PRD-016: US-001 - Template schedule configuration UI"
    },
    {
      "id": "US-246",
      "title": "Create recurring work subscription modal and client list view",
      "description": "As a user, I want to subscribe clients to recurring work templates and view their subscriptions.",
      "acceptanceCriteria": [
        "Add 'Recurring Work' tab to client detail view",
        "Sticky header with 'Add Recurring Work' button",
        "List shows subscriptions: Template name, Status badge (Active/Paused/Ended), Next occurrence date, Team assignments",
        "Empty state: 'No recurring work set up. Add recurring work to automate work creation.' with CTA button",
        "Loading state: 3 skeleton cards",
        "Subscription modal: Template selector (excludes already subscribed), search/filter templates, templates grouped by work type",
        "If template has no default schedule: Show warning 'This template has no default schedule. Please configure a schedule for this subscription.' and require schedule configuration",
        "Settings form: Schedule summary with 'Customize' toggle, Budget fields with 'Use default' option, Team assignments table with role and user picker",
        "If template defines required roles: Show warning if team assignments incomplete",
        "Name pattern field (optional) with preview: '{client} - {template} - {period}'",
        "Name pattern supports variables: {client}, {template}, {period}, {year}, {month}, {dueDate}",
        "Preview shows next 3 occurrences with dates",
        "Required fields marked with asterisk (*): Template, Client",
        "Optional fields labeled '(optional)'",
        "Validation errors shown inline below fields (on blur)",
        "Error summary at top of modal if multiple errors",
        "Success toast: 'Recurring work added'",
        "Subscription appears in list immediately",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 246,
      "passes": true,
      "notes": "PRD-016: US-002, US-005 - Subscription creation and client list view"
    },
    {
      "id": "US-247",
      "title": "Add bulk subscription features",
      "description": "As a user, I want to subscribe clients to multiple templates or assign templates to multiple clients at once.",
      "acceptanceCriteria": [
        "In subscription modal: Add checkbox selection to template list, 'Select All' link, selected count display",
        "Continue button shows count: 'Continue with 3'",
        "Summary screen: Lists selected templates as collapsible cards, expand to customize settings, 'Use defaults for all' option",
        "Progress indicator during bulk creation: Spinner overlay + progress bar 'Creating subscription X of Y...'",
        "Results summary: 'Created 3 subscriptions' with any failures shown",
        "Add 'Assign to Clients' button to template detail view header",
        "Client assignment modal: Client list with subscription status, search/filter, select all unsubscribed option",
        "Already subscribed clients shown but not selectable",
        "Settings can be applied uniformly or per-client",
        "Progress indicator during assignment: Spinner overlay + progress bar",
        "Results summary with success/failure counts, link to view created subscriptions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 247,
      "passes": true,
      "notes": "PRD-016: US-003, US-004 - Bulk subscription operations"
    },
    {
      "id": "US-248",
      "title": "Build recurring work detail panel and management actions",
      "description": "As a user, I want to view subscription details and manage them (edit, pause, resume, skip, end, duplicate, delete).",
      "acceptanceCriteria": [
        "Click subscription row opens slide-over panel from right",
        "Panel header sticky with close button, content scrolls independently",
        "Detail panel shows: Template name, Client name, Status badge, Schedule section (frequency, day, due offset, lead time) with 'Using default' or 'Custom' indicators, Budget section (hours, USD), Team assignments table, Upcoming occurrences (next 5), Recent work items (last 5) with links, Skip status if any, Created by/at metadata",
        "Edit action: Opens modal (same as creation flow) pre-filled with current values, 'Reset to default' option per field, shows comparison 'Was: Day 15, Now: Day 10', validation errors inline, success toast with undo option",
        "Pause action: Confirmation dialog, status changes to 'Paused', paused badge (yellow), pause timestamp recorded, next occurrence shows 'Paused', resume action becomes available",
        "Resume action: No confirmation, status changes to 'Active', next occurrence calculated",
        "Skip action: Modal with number input (1-12), preview shows periods to skip and next active date, optional reason field, skip indicator on row, can modify or cancel skip",
        "End action: Confirmation dialog, status changes to 'Ended', ended badge (gray), end timestamp recorded, cannot be undone",
        "Duplicate action: Client selector (multi-select), pre-filled settings except team assignments, preview shows next 3 occurrences, success toast with view link",
        "Delete action: Destructive confirmation dialog, record removed, work items remain (orphaned)",
        "All actions update UI immediately, show appropriate toasts",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 248,
      "passes": true,
      "notes": "PRD-016: US-006, US-007, US-008, US-009, US-010, US-011, US-012, US-013 - Detail view and management actions"
    },
    {
      "id": "US-249",
      "title": "Build automation dashboard",
      "description": "As an administrator, I want to view an overview of all recurring work and automation activity.",
      "acceptanceCriteria": [
        "Add 'Recurring Work' nav item under Work section in sidebar",
        "Dashboard page with multiple sections (scrolls as one unit)",
        "Stats cards at top: Active subscriptions count, Templates with subscriptions count, Clients with recurring work count, Work created this month count",
        "Stats cards sticky on desktop (sticky top-0), scroll normally on mobile (<768px)",
        "Upcoming Work section: Toggle (7/14/30 days) sticky in header, table with Client, Template, Period, Due Date, Status columns, table header sticky within section, filter by template/client, export option sticky in header",
        "Recent Activity section: List of recent automation runs, each shows timestamp, trigger type, created count, errors, click to expand (accordion) showing work items created",
        "Attention Needed section: Paused subscriptions, failed creations, templates with no subscriptions, or 'All systems operational' message if none",
        "Empty states for each section with appropriate messages",
        "Loading states: Skeleton stats + skeleton table rows",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 249,
      "passes": true,
      "notes": "PRD-016: US-016 - Automation dashboard overview"
    },
    {
      "id": "US-250",
      "title": "Build all recurring work admin table and automation run history",
      "description": "As an administrator, I want to view all recurring work subscriptions and automation run history for management and auditing.",
      "acceptanceCriteria": [
        "Add 'All Recurring Work' tab to dashboard",
        "Table showing all RecurringWork records: Client, Template, Status, Next Occurrence, Team columns",
        "Table header sticky, bulk action bar sticky at top when items selected",
        "Sortable by all columns, filterable by Template/Status/Client, searchable",
        "Checkbox column for bulk selection, 'Select All' checkbox in header",
        "Click row opens detail slide-over panel",
        "Export to CSV option",
        "Pagination or virtual scrolling for 100+ rows",
        "Add 'Run History' tab to dashboard",
        "Table of AutomationRun records: Timestamp, Trigger, Processed, Created, Skipped, Failed, Status columns",
        "Table header sticky",
        "Click row expands accordion showing: Run metadata (trigger type, triggered by, started/completed at, duration, status), Summary statistics, Work items created list with links, Errors section (if any) with client/subscription/error details, Processed subscriptions list",
        "Cancel button visible if status is 'running'",
        "Delete button in overflow menu (for completed/failed runs)",
        "Filter by date range (default: last 30 days), status, trigger type",
        "Empty state: 'No automation runs yet. Runs will appear here after automation executes.'",
        "Loading state: 5 skeleton table rows",
        "Pagination or virtual scrolling for large datasets",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 250,
      "passes": true,
      "notes": "PRD-016: US-017, US-018 - Admin views for recurring work and run history"
    },
    {
      "id": "US-251",
      "title": "Add automation run management and bulk operations",
      "description": "As an administrator, I want to cancel running automations, delete run history, and perform bulk operations on subscriptions.",
      "acceptanceCriteria": [
        "Cancel automation: Cancel button visible for runs with status 'running', confirmation dialog, status changes to 'cancelled', work items remain unchanged",
        "Delete run history: Delete action in overflow menu for completed/failed runs, confirmation dialog, record removed, work items remain",
        "Bulk pause: Select multiple subscriptions, bulk actions menu \u2192 Pause, confirmation dialog with count, progress indicator, results summary",
        "Bulk resume: Select paused subscriptions, bulk actions \u2192 Resume (no confirmation), progress indicator, results summary",
        "Bulk end: Select multiple subscriptions, bulk actions \u2192 End, destructive confirmation dialog, progress indicator, results summary",
        "All bulk operations show progress: Spinner overlay + progress bar 'Operating on subscription X of Y...'",
        "Results summary shows success/failure counts with error details",
        "Status badges update immediately",
        "Success toasts for all operations",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 251,
      "passes": true,
      "notes": "PRD-016: US-022, US-023, US-024, US-025, US-026 - Run management and bulk operations"
    },
    {
      "id": "US-252",
      "title": "Integrate recurring work into work creation flow and template subscriptions view",
      "description": "As a user, I want to see recurring work options when creating work and view template subscriptions.",
      "acceptanceCriteria": [
        "In 'Add Work' dropdown: Add 'From Template' option",
        "Template selector with search, client selector",
        "'Make this recurring?' checkbox (unchecked by default)",
        "If one-off: Creates single work item, no RecurringWork",
        "If recurring: Creates RecurringWork subscription + first work item",
        "When selecting client first: Show 'Suggested' templates section and 'Already set up' section",
        "Already subscribed templates shown with indicator",
        "Selecting subscribed template asks: 'Create one-off or use recurring schedule?'",
        "Add 'Subscriptions' tab/section to template detail view",
        "Table shows: Client name, Status, Next occurrence, Team assignments",
        "Table header sticky, filterable by status, searchable by client name, sortable columns",
        "Click row opens subscription detail slide-over panel",
        "Actions available: Edit, Pause/Resume, End",
        "Empty state: 'No clients subscribed to this template yet. Use 'Assign to Clients' to add subscriptions.'",
        "Loading state: 5 skeleton rows",
        "Pagination or virtual scrolling for large datasets",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 252,
      "passes": true,
      "notes": "PRD-016: US-019, US-020, US-021 - Work creation integration and template subscriptions view"
    },
    {
      "id": "US-253",
      "title": "Add API architecture database schema",
      "description": "As a developer, I need database tables for API keys, usage tracking, rate limits, webhooks, and deliveries.",
      "acceptanceCriteria": [
        "Add apiKeys table with fields: tenantId, name, keyPrefix, keyHash, previousKeyHashes, scopes, environment (test/live), status (active/revoked), lastUsedAt, expiresAt, revokedAt, revokedBy, revokedReason, regeneratedAt, regeneratedBy, createdBy, createdAt",
        "Add indexes on apiKeys: by_tenant_id, by_key_hash, by_status (tenantId + status)",
        "Add apiKeyUsageLogs table with fields: apiKeyId, tenantId, endpoint, method, statusCode, responseTimeMs, requestId, ipAddress, userAgent, timestamp",
        "Add indexes on apiKeyUsageLogs: by_api_key_id, by_tenant_timestamp",
        "Add apiRateLimits table with fields: apiKeyId, windowStart, requestCount",
        "Add index on apiRateLimits: by_api_key_window",
        "Add webhookEndpoints table with fields: tenantId, url, name, secret, events, status (active/disabled/failing), consecutiveFailures, lastDeliveryAt, lastDeliveryStatus, lastDeliveryError, createdBy, createdAt, updatedAt",
        "Add indexes on webhookEndpoints: by_tenant_id, by_status (tenantId + status)",
        "Add webhookDeliveries table with fields: webhookEndpointId, tenantId, event, payload, status (pending/success/failed), httpStatus, responseBody, responseTimeMs, attempts, nextRetryAt, createdAt, completedAt",
        "Add indexes on webhookDeliveries: by_endpoint_id, by_tenant_created",
        "Schema deploys successfully with 'npx convex dev'",
        "Typecheck passes"
      ],
      "priority": 253,
      "passes": true,
      "notes": "PRD-013: Data Model - All schema tables for API architecture"
    },
    {
      "id": "US-254",
      "title": "Create API key management queries and mutations",
      "description": "As a developer, I need backend functions to create, list, validate, regenerate, and revoke API keys.",
      "acceptanceCriteria": [
        "Create createApiKey mutation: generates random key (32 bytes), stores SHA-256 hash, returns full key ONCE, creates prefix (pm_live_ or pm_test_ + first 8 chars)",
        "Create listApiKeys query: returns keys for tenant with name, prefix, scopes, environment, status, lastUsedAt, createdAt (never returns hash)",
        "Create getApiKey query: returns single key details including usage stats summary",
        "Create validateApiKey query: takes full key, returns key record if valid and active, null otherwise. Uses hash comparison.",
        "Create regenerateApiKey mutation: generates new key, moves current hash to previousKeyHashes, stores new hash, returns new full key ONCE, updates regeneratedAt/regeneratedBy",
        "Create revokeApiKey mutation: sets status to 'revoked', records revokedAt, revokedBy, revokedReason",
        "Create logApiKeyUsage mutation: logs endpoint, method, statusCode, responseTimeMs, requestId, ipAddress, userAgent",
        "Create getApiKeyUsageStats query: returns request counts, error breakdown, requests per day for last 30 days",
        "All mutations require authenticated user with admin role",
        "All queries/mutations scoped to tenant",
        "Typecheck passes"
      ],
      "priority": 254,
      "passes": true,
      "notes": "PRD-013: US-001, US-002, US-003, US-007, US-008 - API key CRUD operations"
    },
    {
      "id": "US-255",
      "title": "Create webhook management queries and mutations",
      "description": "As a developer, I need backend functions to create, list, update, delete, and test webhook endpoints.",
      "acceptanceCriteria": [
        "Create createWebhookEndpoint mutation: validates URL is HTTPS, generates random secret (32 bytes hex), stores endpoint with status 'active', consecutiveFailures 0",
        "Create listWebhookEndpoints query: returns endpoints for tenant with url, name, events, status, lastDeliveryAt, lastDeliveryStatus",
        "Create getWebhookEndpoint query: returns endpoint details including delivery stats (success rate, avg response time)",
        "Create updateWebhookEndpoint mutation: allows updating url, name, events. Cannot update secret.",
        "Create deleteWebhookEndpoint mutation: removes endpoint, optionally retains delivery logs for 30 days",
        "Create testWebhookEndpoint mutation: sends test payload to endpoint, returns success/failure with HTTP status and response preview",
        "Create listWebhookDeliveries query: paginated list with filters for date range, status, event type, search by requestId",
        "Create retryWebhookDelivery mutation: immediately retries failed delivery (max 3 manual retries per delivery), updates delivery status",
        "Create internal dispatchWebhook function: called by other mutations to queue webhook deliveries",
        "All mutations require authenticated user with admin role",
        "All queries/mutations scoped to tenant",
        "Typecheck passes"
      ],
      "priority": 255,
      "passes": true,
      "notes": "PRD-013: US-005, US-006, US-009, US-010, US-011, US-012 - Webhook CRUD operations"
    },
    {
      "id": "US-256",
      "title": "Build Settings > API Keys page with list view and create dialog",
      "description": "As a tenant administrator, I want to view and create API keys from the settings page.",
      "acceptanceCriteria": [
        "Create route at /settings/api with 'API Keys' title",
        "Add 'API' link to settings sidebar navigation",
        "Sticky header with 'API Keys' title and '+ Create Key' button",
        "List of API key cards showing: name, prefix (pm_live_xxx...), scopes badges, created date, last used (relative time), requests this month",
        "Each card has 'View Details', 'Regenerate', 'Revoke' action buttons",
        "Empty state: 'No API keys created yet' with illustration, 'Create your first API key' button, brief explanation",
        "Create Key dialog: name input (required, max 100 chars, validation on blur), environment toggle (Test/Live), scope checkboxes with 'Select All' (at least one required), optional expiration date picker (must be future)",
        "Submit button disabled until all required fields valid",
        "On success: modal shows full key with copy button, warning 'This is the only time you'll see this key. Copy it now.'",
        "After copy: 'Key copied to clipboard' toast notification",
        "Modal closes only via 'Done' button (no click-outside dismiss)",
        "Loading state: skeleton loaders during initial load",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 256,
      "passes": true,
      "notes": "PRD-013: US-001, US-002 - API keys list and create"
    },
    {
      "id": "US-257",
      "title": "Build API key detail panel with usage stats and management actions",
      "description": "As a tenant administrator, I want to view API key details, usage statistics, and manage key lifecycle.",
      "acceptanceCriteria": [
        "Click on key card or 'View Details' opens slide-over detail panel",
        "Panel shows: name, prefix, scopes list, environment badge, created date, last used, expiration (if set)",
        "Usage chart: bar chart showing requests per day for last 30 days",
        "Recent requests table: last 20 requests with endpoint, status code, timestamp",
        "Table filters: status code dropdown, date range picker, endpoint search",
        "Table pagination: 50 entries per page",
        "Export to CSV button for usage data",
        "Error breakdown section: count of errors by status code (4xx, 5xx)",
        "Key regeneration history: shows previous key hashes (masked) with timestamps",
        "Regenerate Key button: confirmation dialog 'This will generate a new key value. The current key will be invalidated immediately.', warning about updating integrations, shows new key ONCE on success",
        "Revoke button: confirmation dialog with reason dropdown (Compromised, No longer needed, Rotating keys, Other), warning about immediate rejection",
        "Loading state: skeleton loaders during data fetch",
        "Error state: 'Failed to load usage data' with retry button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 257,
      "passes": true,
      "notes": "PRD-013: US-002, US-007, US-008 - API key detail view and management"
    },
    {
      "id": "US-258",
      "title": "Build Settings > Webhooks page with list view and add endpoint dialog",
      "description": "As a tenant administrator, I want to view and configure webhook endpoints from the settings page.",
      "acceptanceCriteria": [
        "Create route at /settings/webhooks with 'Webhooks' title",
        "Add 'Webhooks' link to settings sidebar navigation",
        "Sticky header with 'Webhooks' title and '+ Add Endpoint' button",
        "List of webhook endpoint cards showing: URL (truncated), name (if set), status indicator (Active green dot, Failing red dot, Disabled gray dot), events badges, last delivery (relative time + status)",
        "Each card has 'View Details', 'Edit', 'Test', 'Delete' action buttons",
        "Empty state: 'No webhook endpoints configured' with illustration, 'Add your first endpoint' button, brief explanation",
        "Add Endpoint dialog: URL input (required, must be HTTPS, validation on blur), friendly name input (optional), event checkboxes grouped by category (Work, Tickets, Contacts, Time & Billing, Recurring Work), at least one event required",
        "Submit button disabled until all required fields valid",
        "On success: endpoint added to list, success toast 'Webhook endpoint created'",
        "Test button available after creation",
        "Loading state: skeleton loaders during initial load",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 258,
      "passes": true,
      "notes": "PRD-013: US-005 - Webhooks list and add endpoint"
    },
    {
      "id": "US-259",
      "title": "Build webhook detail panel with delivery logs and management actions",
      "description": "As a tenant administrator, I want to view webhook endpoint details, delivery history, and manage endpoints.",
      "acceptanceCriteria": [
        "Click on endpoint card or 'View Details' opens slide-over detail panel",
        "Panel shows: URL, name, events subscribed (badges), status badge, created date, last delivery timestamp",
        "Stats section: success rate percentage, average response time",
        "Recent failures section: last 10 failed deliveries with event, error details, timestamp",
        "Delivery history table: all deliveries with timestamp, event, status code badge, response time",
        "Table filters: date range (last 7/30/90 days or custom), status code, event type",
        "Table search: by request ID",
        "Table pagination: 50 entries per page",
        "Export to CSV button for delivery logs",
        "Expandable rows: click to see full request payload and response body",
        "Retry button on failed deliveries (disabled after 3 manual retries)",
        "Test Endpoint button: sends sample payload, shows success/failure notification with HTTP status",
        "Edit button: opens dialog to edit URL, name, events (cannot edit secret)",
        "Delete button: confirmation dialog with option to retain delivery logs for 30 days",
        "Loading state: skeleton loaders during data fetch",
        "Error state: 'Failed to load endpoint data' with retry button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 259,
      "passes": true,
      "notes": "PRD-013: US-005, US-009, US-010, US-011, US-012 - Webhook detail view and management"
    },
    {
      "id": "US-260",
      "title": "Set up OpenAPI schema generation and Scalar documentation",
      "description": "As a developer integrating with the platform, I want to access comprehensive API documentation.",
      "acceptanceCriteria": [
        "Install dependencies: @scalar/nextjs-api-reference, @asteasolutions/zod-to-openapi, zod",
        "Create lib/openapi/schemas/ directory with Zod schemas for: work-items, contacts, organizations, time-entries, invoices, tickets, users",
        "Each schema has OpenAPI metadata (descriptions, examples) via .openapi() extension",
        "Create lib/openapi/registry.ts with OpenAPIRegistry, register security scheme (bearerAuth)",
        "Register all API paths with request/response schemas, tags, and descriptions",
        "Create generateOpenApiSpec() function that produces OpenAPI 3.1.0 spec",
        "Create /api/openapi route that serves JSON spec",
        "Create /developers/[[...slug]]/page.tsx with Scalar ApiReferenceReact component",
        "Configure Scalar with purple theme, modern layout, sidebar, authentication helper",
        "Documentation shows all endpoints with method, path, parameters, request/response examples",
        "Code examples available in cURL, TypeScript, Python",
        "Authentication instructions are clear at top of docs",
        "Typecheck passes",
        "Verify in browser: visit /developers, see interactive API docs"
      ],
      "priority": 260,
      "passes": true,
      "notes": "PRD-013: US-004, Documentation Strategy - Auto-generated API docs"
    },
    {
      "id": "US-261",
      "title": "Create API middleware for rate limiting and authentication",
      "description": "As a developer, I need edge middleware to enforce rate limits and validate API keys before requests reach the API routes.",
      "acceptanceCriteria": [
        "Install dependencies: @upstash/ratelimit, @vercel/kv (or use in-memory fallback for dev)",
        "Create middleware.ts with rate limiting for /api/v1/* routes",
        "Rate limit: 1000 requests per minute per API key (using key prefix for identification)",
        "Return 401 Unauthorized if Authorization header missing",
        "Return 429 Too Many Requests if rate limit exceeded",
        "Include rate limit headers in all responses: X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset",
        "Include Retry-After header on 429 responses",
        "Create lib/api/auth.ts with validateApiKeyFromRequest helper",
        "Helper extracts Bearer token from Authorization header, validates via Convex query, returns key record or null",
        "Create lib/api/response.ts with standardized response helpers: successResponse(data), errorResponse(code, message, details), listResponse(data, pagination)",
        "All responses include meta object with requestId and timestamp",
        "Typecheck passes"
      ],
      "priority": 261,
      "passes": true,
      "notes": "PRD-013: US-003, Infrastructure Architecture - Edge middleware for rate limiting"
    },
    {
      "id": "US-262",
      "title": "Create external REST API routes for work items",
      "description": "As an external developer, I want to access work items via REST API.",
      "acceptanceCriteria": [
        "Create app/api/v1/work-items/route.ts with GET (list) and POST (create) handlers",
        "Create app/api/v1/work-items/[id]/route.ts with GET (detail), PATCH (update), DELETE handlers",
        "GET /api/v1/work-items: validate API key, check work:read scope, call existing listWorkItems query, return paginated response",
        "Query params: status, client_id, assignee_id, work_type, due_before, due_after, include_archived, page, page_size (max 100)",
        "POST /api/v1/work-items: validate API key, check work:write scope, validate request body against Zod schema, call createWorkItem mutation",
        "GET /api/v1/work-items/:id: validate API key, check work:read scope, call getWorkItem query",
        "PATCH /api/v1/work-items/:id: validate API key, check work:write scope, validate partial body, call updateWorkItem mutation",
        "DELETE /api/v1/work-items/:id: validate API key, check work:write scope, call deleteWorkItem mutation",
        "All routes log usage via logApiKeyUsage mutation",
        "Return appropriate HTTP status codes: 200, 201, 400, 401, 403, 404, 422, 500",
        "Error responses use standard format with code, message, details",
        "Typecheck passes"
      ],
      "priority": 262,
      "passes": true,
      "notes": "PRD-013: API Endpoints - Work Items REST API"
    },
    {
      "id": "US-263",
      "title": "Create external REST API routes for contacts and organizations",
      "description": "As an external developer, I want to access contacts and organizations via REST API.",
      "acceptanceCriteria": [
        "Create app/api/v1/contacts/route.ts with GET and POST handlers",
        "Create app/api/v1/contacts/[id]/route.ts with GET, PATCH, DELETE handlers",
        "Create app/api/v1/organizations/route.ts with GET and POST handlers",
        "Create app/api/v1/organizations/[id]/route.ts with GET, PATCH, DELETE handlers",
        "Contacts GET query params: organization_id, email, search, client_group_id, page, page_size",
        "Organizations GET query params: search, domain, client_group_id, page, page_size",
        "All routes validate API key and check contacts:read or contacts:write scope as appropriate",
        "All routes call existing Convex queries/mutations (reuse business logic)",
        "All routes log usage via logApiKeyUsage mutation",
        "Return appropriate HTTP status codes",
        "Typecheck passes"
      ],
      "priority": 263,
      "passes": true,
      "notes": "PRD-013: API Endpoints - Contacts and Organizations REST API"
    },
    {
      "id": "US-264",
      "title": "Create external REST API routes for tickets",
      "description": "As an external developer, I want to access tickets via REST API.",
      "acceptanceCriteria": [
        "Create app/api/v1/tickets/route.ts with GET and POST handlers",
        "Create app/api/v1/tickets/[id]/route.ts with GET, PATCH, DELETE handlers",
        "Create app/api/v1/tickets/[id]/messages/route.ts with GET (list), POST (reply) handlers",
        "Create app/api/v1/tickets/[id]/notes/route.ts with POST handler",
        "Create app/api/v1/tickets/[id]/assign/route.ts with POST handler",
        "Create app/api/v1/tickets/[id]/close/route.ts with POST handler",
        "Tickets GET query params: status, priority, queue_id, assignee_id, requester_email, client_id, category_id, tags, created_after, created_before, page, page_size",
        "All routes validate API key and check tickets:read or tickets:write scope as appropriate",
        "All routes call existing Convex queries/mutations",
        "All routes log usage",
        "Return appropriate HTTP status codes",
        "Typecheck passes"
      ],
      "priority": 264,
      "passes": true,
      "notes": "PRD-013: API Endpoints - Tickets REST API"
    },
    {
      "id": "US-265",
      "title": "Create external REST API routes for time entries and billing",
      "description": "As an external developer, I want to access time entries, invoices, and payments via REST API.",
      "acceptanceCriteria": [
        "Create app/api/v1/time-entries/route.ts with GET, POST handlers",
        "Create app/api/v1/time-entries/[id]/route.ts with GET, PATCH, DELETE handlers",
        "Create app/api/v1/invoices/route.ts with GET, POST handlers",
        "Create app/api/v1/invoices/[id]/route.ts with GET, PATCH, DELETE handlers",
        "Create app/api/v1/invoices/[id]/send/route.ts with POST handler",
        "Create app/api/v1/payments/route.ts with GET, POST handlers",
        "Create app/api/v1/payments/[id]/route.ts with GET handler",
        "Create app/api/v1/payments/[id]/void/route.ts with POST handler",
        "Time entries GET query params: user_id, work_id, client_id, date_from, date_to, billable, billed_status, page, page_size",
        "Invoices GET query params: client_id, status, date_from, date_to, page, page_size",
        "All routes validate API key and check time:read/write or billing:read/write scopes",
        "All routes call existing Convex queries/mutations",
        "All routes log usage",
        "Typecheck passes"
      ],
      "priority": 265,
      "passes": true,
      "notes": "PRD-013: API Endpoints - Time Entries and Billing REST API"
    },
    {
      "id": "US-266",
      "title": "Implement webhook dispatch system",
      "description": "As a developer, I need webhooks to be dispatched when events occur in the system.",
      "acceptanceCriteria": [
        "Create convex/webhooks.ts with internal dispatch function",
        "Dispatch function: looks up active webhook endpoints for tenant that subscribe to the event, creates pending webhook delivery records, schedules delivery via Convex scheduler",
        "Create deliverWebhook scheduled function: makes HTTP POST to endpoint URL, includes JSON payload with id, type, created timestamp, data object",
        "Include X-Webhook-Signature header with HMAC-SHA256 signature: sha256=hmac(secret, timestamp.payload)",
        "Include X-Webhook-Timestamp header with Unix timestamp",
        "On success (2xx): update delivery status to 'success', record httpStatus and responseTimeMs, reset consecutiveFailures to 0",
        "On failure: update delivery status to 'failed', record error, increment attempts, schedule retry with exponential backoff (1m, 5m, 30m, 2h, 8h)",
        "After 6 consecutive failures: set endpoint status to 'failing'",
        "Add webhook dispatch calls to key mutations: work item create/update/complete, ticket create/update/close, contact create/update, time entry create, invoice create/send/paid",
        "Typecheck passes"
      ],
      "priority": 266,
      "passes": true,
      "notes": "PRD-013: US-006, Webhook Delivery - Event dispatch system"
    },
    {
      "id": "US-267",
      "title": "Add API and Webhooks links to settings navigation and polish",
      "description": "As a user, I want easy access to API settings from the main settings navigation with consistent styling.",
      "acceptanceCriteria": [
        "Add 'API' and 'Webhooks' items to settings sidebar navigation (after existing items)",
        "API link uses Key or similar icon, Webhooks link uses Webhook or Radio icon",
        "Active state styling matches other settings nav items",
        "Both pages use consistent card styling with other settings pages",
        "Scope bundles shown in create dialog: 'Read Only', 'Full Access', 'Accounting Integration', 'Support Integration', 'Project Management Integration'",
        "Event checkboxes grouped by category with collapsible sections: Work (work.created, work.updated, etc.), Tickets, Contacts, Time & Billing, Recurring Work",
        "Revoked keys section: optionally show revoked keys at bottom with 'Show revoked keys' toggle, grayed out styling",
        "Disabled/failing endpoints section: visual distinction with warning badge",
        "Page headers match settings page pattern",
        "Loading and empty states consistent with rest of app",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 267,
      "passes": true,
      "notes": "PRD-013: UI Specifications - Settings navigation and polish"
    },
    {
      "id": "US-268",
      "title": "Add client context section to Work page",
      "description": "As a user, I want to see client context when viewing work filtered to a single client so that I understand what work exists and what's automated for this client.",
      "acceptanceCriteria": [
        "Client context section appears ONLY when exactly one client is filtered",
        "Does NOT appear when multiple clients selected or no client filter",
        "Shows client name: 'Work for [Client Name]'",
        "Shows recurring work summary: 'X active recurring work subscriptions' or 'No recurring work set up'",
        "While recurring work count is loading, shows skeleton loader or 'Loading...' text",
        "If query fails, shows 'Unable to load recurring work status' with retry option",
        "'Manage recurring work' link opens client's Recurring Work tab",
        "Section is collapsible (collapsed state persists per user)",
        "Collapsed state stored in user preferences table (applies globally, not per-client)",
        "Section uses subtle styling: bg-muted/30, border border-border/50, p-4",
        "Client name uses text-lg font-semibold, recurring work text uses text-sm text-muted-foreground",
        "Section is sticky below filters (doesn't scroll away)",
        "On mobile (< 768px), section is collapsed by default",
        "On mobile, section can be expanded via tap/click",
        "Work items list displays normally below context section",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-003: Client context section with recurring work status"
    },
    {
      "id": "US-269",
      "title": "Implement client-specific empty states",
      "description": "As a user, I want to see helpful guidance when a client has no work items so that I can quickly create work or understand if recurring work is set up.",
      "acceptanceCriteria": [
        "Empty state appears when Work page filtered to single client with zero work items",
        "When client HAS recurring work (but no work items yet):",
        "  - Empty state title: 'No work items yet for [Client Name]'",
        "  - Message: 'This client has recurring work set up. Work items will be created automatically.'",
        "  - Shows: 'Next scheduled: [Subscription Name] on [Date]'",
        "  - Shows list of active subscriptions (max 3, then 'and X more')",
        "  - CTA: 'Create Work Item Now' (creates one-off)",
        "  - Secondary CTA: 'Run Scheduled Work Now' (triggers automation for next period)",
        "  - Link: 'Manage recurring work \u2192'",
        "When client has NO recurring work:",
        "  - Empty state title: 'No work items for [Client Name]'",
        "  - Message: 'Create a one-time work item, or set up recurring work to automate work creation.'",
        "  - Primary CTA: 'Create Work Item' (pre-fills client)",
        "  - Secondary CTA: 'Set Up Recurring Work' (navigates to client's Recurring Work tab)",
        "  - Visual hint: Small illustration distinguishing one-off vs recurring",
        "  - Brief explainer (collapsible): 'What's recurring work? \u2192'",
        "On mobile, CTAs stack vertically with full-width buttons",
        "Empty state does NOT show generic 'No work items match your filters' message",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-003: Contextual empty states based on recurring work status"
    },
    {
      "id": "US-270",
      "title": "Pre-fill client in Create Work dialog",
      "description": "As a user, I want to create work for the currently filtered client so that I don't have to re-select the client in the creation form.",
      "acceptanceCriteria": [
        "Create Work dialog opens with client field pre-filled and locked when triggered from client-filtered empty state",
        "Client field shows: '[Client Name]' with disabled/readonly state",
        "'Change client' link available to unlock if user wants different client",
        "Clicking 'Change client' unlocks field and enables full client selector dropdown/search",
        "User can select different client or cancel to keep original pre-filled client",
        "All other fields work normally",
        "On save, user returns to Work page (still filtered to client)",
        "New work item appears in list",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-003: Pre-filled client in creation dialog"
    },
    {
      "id": "US-271",
      "title": "Quick setup recurring work from Work page",
      "description": "As a user, I want to set up recurring work directly when I see a client has none so that I don't have to navigate to a different part of the app.",
      "acceptanceCriteria": [
        "'Set Up Recurring Work' button visible in empty state when no recurring work exists",
        "Clicking opens Add Recurring Work dialog (from PRD-016) with client pre-filled",
        "Client field is pre-filled and locked (same as US-003)",
        "After successful creation, user can either stay on Work page or navigate to view subscription details",
        "Success toast: 'Recurring work set up for [Client Name]'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-003: Quick setup recurring work from empty state"
    },
    {
      "id": "US-272",
      "title": "Run scheduled work now from empty state",
      "description": "As a user, I want to trigger the next scheduled work creation immediately so that I can see work items appear without waiting for automation.",
      "acceptanceCriteria": [
        "'Run Scheduled Now' button visible when client has recurring work but 0 work items",
        "Clicking shows confirmation: 'Create work items for [Client Name]?'",
        "Confirmation lists what will be created (subscription name, period, due date)",
        "Only shows subscriptions that are currently due or overdue",
        "If nothing is due yet, button is disabled with tooltip: 'Next work scheduled for [date]'",
        "On confirm, work items created using same mutation as manual trigger (US-015 from PRD-016)",
        "If work creation fails, shows error toast with specific failure reason",
        "If partial success (some items created, others fail), shows summary: 'Created X of Y work items. [View errors]'",
        "Error details show which subscriptions failed and why",
        "Work page refreshes to show new items",
        "Success toast: 'Created X work items'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-003: Manual trigger from empty state"
    },
    {
      "id": "US-273",
      "title": "Add creation path from Automation Dashboard",
      "description": "As a user, I want to create recurring work directly from the Automation Dashboard so that I can set up automation without navigating to a client first.",
      "acceptanceCriteria": [
        "'Add Recurring Work' button visible in dashboard header (primary variant)",
        "Button visible in empty state as well",
        "Modal supports template-first selection flow",
        "Template selector shows search box (filters by name)",
        "Template selector shows filter by category/tags (if templates have categories)",
        "Shows templates user has permission to use",
        "Shows indicator for templates without default schedule (\u26a0\ufe0f icon)",
        "Selected template shows preview: schedule, budget, team requirements",
        "Can select single or multiple clients (multi-select checkbox list)",
        "Single client \u2192 standard subscription form",
        "Multiple clients \u2192 bulk assignment preview",
        "Created subscriptions appear in dashboard immediately",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-016: Template-first creation flow from dashboard"
    },
    {
      "id": "US-274",
      "title": "Add onboarding guide for recurring work concepts",
      "description": "As a first-time user, I want to understand how recurring work automation works so that I can set it up correctly.",
      "acceptanceCriteria": [
        "Onboarding shown only on first visit OR when no recurring work exists",
        "Visual format: Horizontal flow diagram with icons (Template \ud83d\udccb \u2192 Subscription \ud83d\udd04 \u2192 Work Item \u2705)",
        "Text labels below each icon with arrows between steps",
        "'Don't show again' checkbox checked by default",
        "If unchecked, onboarding shows again on next visit (until checked and dismissed)",
        "Dismissal is permanent (doesn't re-show even if all recurring work deleted)",
        "Once dismissed, never shows again automatically",
        "Manual re-trigger available via help menu or '?' icon",
        "Manual re-trigger shows same onboarding regardless of recurring work state",
        "'Get Started' button navigates to creation flow (US-001)",
        "Onboarding state stored per user in user preferences table (not localStorage, for cross-device consistency)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-016: Concept onboarding guide"
    },
    {
      "id": "US-275",
      "title": "Configure schedule inline when template has no default",
      "description": "As a user, I want to configure a schedule when subscribing to a template that has no default so that I can complete the subscription without leaving the modal.",
      "acceptanceCriteria": [
        "When template has no default schedule, schedule section expands automatically (not blocking warning)",
        "Warning text: 'This template has no default schedule. Configure one for this subscription:'",
        "Schedule form appears inline (not separate modal or page)",
        "All schedule options available (frequency, day specification, due date offset, lead time)",
        "Live preview of next 3 occurrences as user configures",
        "Validation: all schedule fields required when template has no default",
        "Schedule saved as subscription override (not written back to template)",
        "Configured schedule saved to subscription record only",
        "Template's default schedule remains unchanged",
        "Subscription detail view shows '(custom schedule)' indicator",
        "User can reset to template default via 'Use template default' button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-016: Inline schedule configuration for templates without defaults"
    },
    {
      "id": "US-276",
      "title": "Add bulk assignment preview table",
      "description": "As a user, I want to preview what each client's subscription will look like before bulk assigning so that I can customize per-client settings without editing after creation.",
      "acceptanceCriteria": [
        "Preview table shows all selected clients after client selection",
        "Columns: Client name, Schedule summary, Budget, Team summary, Actions",
        "Default values shown with '(default)' indicator",
        "'Edit' action per row opens inline expandable form below row",
        "If row expanded, clicking 'Edit' on another row collapses previous and expands new",
        "Only one row expanded at a time",
        "Inline form shows: Schedule dropdown, Budget fields, Team selector",
        "'Save' button saves changes and collapses form",
        "'Cancel' discards changes and collapses form",
        "If preview table has many rows (>10), use modal instead of inline",
        "Customized rows show 'Custom' badge (small pill badge with bg-blue-100 text-blue-800 styling)",
        "Badge appears next to customized value in Schedule column",
        "'Use defaults for all' button resets all to template defaults",
        "Confirmation dialog before final assignment: 'Assign to X clients?'",
        "Bulk progress indicator during creation",
        "Results summary shows success/failure per client",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-016: Bulk assignment preview with per-client customization"
    },
    {
      "id": "US-277",
      "title": "Add navigation links in automation error details",
      "description": "As an administrator, I want to click directly from an automation error to the affected subscription so that I can fix the issue without manual navigation.",
      "acceptanceCriteria": [
        "Error list shows client name as link (navigates to client detail page)",
        "Error list shows subscription/template name as link (opens subscription detail panel)",
        "Clicking client link navigates to client detail page (full page navigation)",
        "Clicking subscription link opens subscription detail panel (slide-over)",
        "Panel overlays run history view (backdrop dims background)",
        "Panel has 'Close' button (X) that returns to run history",
        "Panel can be closed via backdrop click or Escape key",
        "Scroll position in run history preserved when panel opens",
        "Panel includes 'Run Now' action for immediate retry",
        "After fixing issue in panel, 'Run Now' creates work and closes panel",
        "Returning to run history shows updated status (error resolved)",
        "Back/close returns to same position in run history",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-016: Direct navigation from errors to subscriptions"
    },
    {
      "id": "US-278",
      "title": "Add explicit period selection for manual trigger",
      "description": "As a user, I want to choose which period to create work for when manually triggering so that I can create work for a specific month, not just 'next scheduled'.",
      "acceptanceCriteria": [
        "'Run Now' opens modal with period selection dropdown",
        "Period selector dropdown shows next 3-6 periods based on frequency",
        "Periods with existing work items show indicator '(exists)'",
        "Periods with skip flag show '(skipped)' indicator in dropdown",
        "Skipped periods are selectable but show warning when selected",
        "Warning explains: 'This period is set to be skipped. Creating work will bypass the skip.'",
        "Skip status comes from subscription's skipPeriods array or similar",
        "Default selects first period without existing work",
        "Warning shown if selecting period with existing work",
        "Link to view existing work item if one exists",
        "'View existing work item' link opens work item detail panel (slide-over) or navigates to work item page",
        "After viewing existing work, user can return to period selection modal",
        "Modal state preserved (selected period remains selected)",
        "Option to create anyway with confirmation",
        "Due date preview updates based on selected period",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-016: Explicit period selection for manual triggers"
    },
    {
      "id": "US-279",
      "title": "Preserve filter and scroll state across navigation",
      "description": "As a user, I want filters, sort order, and scroll position preserved when navigating to detail views so that I can return to my previous context.",
      "acceptanceCriteria": [
        "Filters preserved when navigating to detail panel and back",
        "Sort order preserved when navigating to detail panel and back",
        "Scroll position preserved when navigating to detail panel and back",
        "Selected item highlighted when returning from detail view",
        "Returning from detail panel restores exact scroll position",
        "State preservation works for: Client Recurring Work List, All Recurring Work (Admin), Automation Run History",
        "Use URL parameters or session storage to preserve state",
        "On panel close, restore from stored state",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-016: State preservation across navigation"
    },
    {
      "id": "US-280",
      "title": "Clarify tab labels and add team role source indicators",
      "description": "As a user, I want clearer tab labels and role source indicators so that I understand what I'm viewing and where team assignments come from.",
      "acceptanceCriteria": [
        "Tab label includes count: 'Recurring Work (3)' OR subtitle '3 active subscriptions'",
        "Team assignments table shows role source: '(from template)' or '(custom)'",
        "Required roles from template shown even if unassigned, with 'Unassigned' indicator",
        "Duplicate action shows clear source indicator in modal header",
        "'Upcoming Work' section clarified: 'Work Items to be Created'",
        "'All Recurring Work' tab clarified: 'Subscription Configurations'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-016: Tab labels and role source indicators"
    },
    {
      "id": "US-281",
      "title": "Add UserPreferences schema fields for ticket layout",
      "description": "As a developer, I need to extend UserPreferences to store ticket layout settings.",
      "acceptanceCriteria": [
        "Add ticketListMode field: 'list-only' | 'preview' (default: 'list-only')",
        "Add sidebarCollapsed object: { listOnly: boolean, preview: boolean, previewPinned: boolean }",
        "Add previewPaneSplit field: number (percentage 0-100, default: 40)",
        "Add closeOnSave field: boolean (default: true)",
        "Add advanceOnSave field: boolean (default: true)",
        "Add ticketListColumns object: { visible: string[], widths: Record<string, number> }",
        "Default visible columns: ['subject', 'requester', 'status', 'sla']",
        "Create or update mutations to get/set these preferences",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-017: Schema foundation for all layout features"
    },
    {
      "id": "US-282",
      "title": "Implement collapsible views sidebar",
      "description": "As an agent, I want to collapse the views sidebar to icons so that I have more horizontal space for ticket content.",
      "acceptanceCriteria": [
        "Collapse button (chevron-left) visible at bottom of expanded sidebar",
        "Expand button (chevron-right) visible at bottom of collapsed sidebar",
        "Collapsed sidebar shows icons only (~48px width)",
        "Icons for views: All Tickets (inbox), My Tickets (user), Unassigned (users), etc.",
        "Clicking icon in collapsed mode switches to that view",
        "Sidebar collapse/expand has smooth CSS transition (150-200ms)",
        "Sidebar state persisted in UserPreferences.sidebarCollapsed.listOnly",
        "Keyboard shortcut: '[' to toggle sidebar collapse/expand",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-017: US-035 basic collapse functionality"
    },
    {
      "id": "US-283",
      "title": "Add sidebar hover overlay with pin",
      "description": "As an agent, I want to hover over collapsed sidebar to see full labels temporarily.",
      "acceptanceCriteria": [
        "Hovering over collapsed sidebar shows overlay with full view labels",
        "Overlay appears after 200ms hover delay (prevents flicker on mouse pass-through)",
        "Overlay slides in from left with subtle animation (150ms)",
        "Overlay has pin button ('Keep open' or pin icon)",
        "Clicking pin button expands sidebar permanently and updates preference",
        "Clicking outside overlay or pressing Escape closes overlay",
        "Clicking a view in overlay navigates to view AND closes overlay",
        "Separate pin state stored for preview mode: UserPreferences.sidebarCollapsed.previewPinned",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-017: US-035 hover overlay and pin functionality"
    },
    {
      "id": "US-284",
      "title": "Add preview pane mode toggle and layout",
      "description": "As an agent, I want to toggle between list-only and list+preview modes for efficient triage.",
      "acceptanceCriteria": [
        "Toggle button in ticket list header shows current mode (list icon vs split-view icon)",
        "Toggle button toggles between 'list-only' and 'preview' mode",
        "Preview mode shows split layout: list (left) | preview pane (right)",
        "Default split: 40% list, 60% preview",
        "Single click on ticket row loads it in preview pane",
        "Active/selected row highlighted in list",
        "Clicking different row switches preview to that ticket",
        "Views sidebar auto-collapses when preview mode enabled (unless user has pinned)",
        "Switching to preview mode: auto-collapse if not pinned",
        "Switching to list-only mode: restore to user's list-only preference",
        "Toggle state persisted in UserPreferences.ticketListMode",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-017: US-034 preview mode foundation"
    },
    {
      "id": "US-285",
      "title": "Build preview pane content and interactions",
      "description": "As an agent, I want the preview pane to show full ticket content with reply capability.",
      "acceptanceCriteria": [
        "Preview pane shows full ticket conversation thread",
        "Preview pane shows properties sidebar (status, priority, assignee, SLA, tags, linked items)",
        "Properties sidebar same format as full ticket detail view",
        "'Open in tab' button (expand icon) in preview header",
        "If no ticket selected, show placeholder: 'Select a ticket to preview'",
        "Loading state: skeleton in preview pane while ticket loads",
        "Preview header (subject, requester info) is sticky - scrolls with conversation below",
        "Properties sidebar scrolls independently from conversation thread",
        "List and preview panes scroll independently",
        "Selecting new ticket resets preview scroll to top",
        "Reply/note composition works in preview pane (same editor as detail view)",
        "Submit updates ticket and stays in preview mode (doesn't navigate away)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-017: US-034 preview content and basic interactions"
    },
    {
      "id": "US-286",
      "title": "Add preview pane resizing and keyboard navigation",
      "description": "As an agent, I want to resize the preview split and navigate with keyboard.",
      "acceptanceCriteria": [
        "Drag handle between list and preview allows resizing split",
        "Minimum widths enforced: list 300px, preview 400px",
        "Resize state persisted in UserPreferences.previewPaneSplit",
        "Smooth resize animation (no lag during drag)",
        "Keyboard navigation: up/down arrows navigate list rows and update preview",
        "Keyboard: Enter opens selected ticket in tab (same as double-click)",
        "Keyboard: Escape closes preview mode (returns to list-only)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-017: US-034 resize and keyboard support"
    },
    {
      "id": "US-287",
      "title": "Implement ticket tab bar and tab opening",
      "description": "As an agent, I want to open multiple tickets in tabs to work on them simultaneously.",
      "acceptanceCriteria": [
        "Tab bar appears below main header when at least one ticket open",
        "Tab bar hidden when no tabs open",
        "Home icon (house or list icon) pinned at far left of tab bar, not closeable",
        "Double-click ticket row opens ticket in new tab",
        "'Open in tab' button in preview header opens ticket in tab",
        "Each tab shows: Subject (truncated ~20 chars) + colored status dot + X close button",
        "Active tab visually distinct (highlighted background, bottom border)",
        "Maximum 10 tabs - attempting 11th shows toast: 'Maximum tabs reached. Close a tab to open another.'",
        "If ticket already open in tab, clicking 'Open in tab' switches to existing tab (no duplicate)",
        "Tab bar is sticky below header - remains visible when scrolling content",
        "Clicking home icon returns to list view (or list+preview if in preview mode)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-017: US-036 core tab functionality"
    },
    {
      "id": "US-288",
      "title": "Add tab state management and navigation",
      "description": "As an agent, I want each tab to maintain its own state when switching between tabs.",
      "acceptanceCriteria": [
        "Clicking any tab loads that ticket in main content area",
        "Tab switch is instant (no full page reload)",
        "Each tab maintains its scroll position independently",
        "Returning to home preserves: filter state, sort order, scroll position, selected row",
        "In preview mode: returning to home shows list+preview with last selected ticket",
        "Closing active tab activates: previous tab (to the left) OR home if no tabs remain",
        "Closing all tabs hides tab bar and shows list view",
        "Tab state stored in session storage (survives page refresh within session)",
        "Tab state NOT persisted across sessions (fresh tabs on new login)",
        "Keyboard: Cmd/Ctrl+W closes active tab",
        "Keyboard: Cmd/Ctrl+Tab cycles between tabs",
        "Keyboard: Cmd/Ctrl+1 goes to home, Cmd/Ctrl+2-9 jumps to tab by position",
        "Lazy load ticket data on tab activation (don't pre-load all tabs)",
        "Show skeleton loader if data not loaded when switching tabs",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-017: US-036, US-037, US-038 tab state and navigation"
    },
    {
      "id": "US-289",
      "title": "Add tab error handling and overflow",
      "description": "As an agent, I want tabs to handle errors gracefully and overflow when many are open.",
      "acceptanceCriteria": [
        "If ticket fails to load in tab, show error: 'Failed to load ticket. [Retry] [Close Tab]'",
        "Retry button attempts to reload ticket",
        "Failed tab shows error indicator (red dot) instead of status dot",
        "If tabs exceed available width, show horizontal scroll or scroll arrows",
        "Active tab always visible (auto-scrolls into view if needed)",
        "Truncate tab labels with ellipsis if needed",
        "Tooltip on tab hover shows full ticket subject",
        "Tab overflow handles up to 10 tabs gracefully",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-017: US-036 error handling and overflow"
    },
    {
      "id": "US-290",
      "title": "Implement draft auto-save to localStorage",
      "description": "As an agent, I want my draft replies auto-saved so I don't lose work if I navigate away.",
      "acceptanceCriteria": [
        "Draft saved to localStorage after 2 second debounce of typing",
        "Separate drafts for reply vs internal note per ticket",
        "Draft keyed by ticketId: 'draft-reply-{ticketId}', 'draft-note-{ticketId}'",
        "Draft includes: ticketId, type, content, savedAt timestamp, ticketUpdatedAt for conflict detection",
        "Tab shows dot/asterisk indicator when draft exists",
        "Editor shows subtle 'Draft saved' text that fades after 2 seconds",
        "When opening ticket with existing draft, restore draft content into editor",
        "Show toast: 'Draft restored' when draft is loaded",
        "When ticket is submitted (reply sent), delete associated draft from localStorage",
        "On app load, delete drafts older than 7 days",
        "Same draft behavior applies to preview pane",
        "If draft exists but ticket was updated by someone else, show warning about conflict",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-017: US-041 draft auto-save"
    },
    {
      "id": "US-291",
      "title": "Add draft confirmation dialog on tab close",
      "description": "As an agent, I want a confirmation when closing a tab with unsaved draft.",
      "acceptanceCriteria": [
        "When closing tab with unsaved draft, show confirmation dialog",
        "Dialog title: 'Unsaved Draft'",
        "Dialog message: 'You have an unsaved draft for this ticket.'",
        "Dialog buttons: 'Cancel' (ghost), 'Discard' (destructive/red), 'Save Draft' (primary)",
        "Cancel: keeps tab open",
        "Discard: closes tab, deletes draft from localStorage",
        "Save Draft: closes tab, draft remains in localStorage for later",
        "Draft persists in localStorage across browser close/reopen",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-017: US-041 draft close confirmation"
    },
    {
      "id": "US-292",
      "title": "Implement auto-advance after action",
      "description": "As an agent, I want to automatically advance to the next ticket after completing an action.",
      "acceptanceCriteria": [
        "Tab View: 'Close on save' checkbox appears to left of Submit button",
        "Tab View: Default checked for new users, state persisted in UserPreferences.closeOnSave",
        "Tab View: When checked and submitting, close current tab and activate previous tab or home",
        "Tab View: When unchecked, stay on current ticket after submit (existing behavior)",
        "Preview Mode: 'Advance on save' checkbox appears to left of Submit button",
        "Preview Mode: Default checked, state persisted in UserPreferences.advanceOnSave",
        "Preview Mode: When checked and submitting, select next ticket in list and load in preview",
        "Preview Mode: 'Next ticket' = next row down in current list order",
        "Preview Mode: If current ticket is last in list, show empty state: 'No more tickets in this view'",
        "Preview Mode: When unchecked, stay on current ticket after submit",
        "Checkbox only appears when there's something to submit (has editor content)",
        "Checkbox is subtle styling, doesn't compete with Submit button prominence",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-017: US-039 auto-advance"
    },
    {
      "id": "US-293",
      "title": "Add quick actions to preview pane header",
      "description": "As an agent, I want quick actions in the preview pane to triage without opening full detail.",
      "acceptanceCriteria": [
        "Quick actions row in preview header, near 'Open in tab' button",
        "Actions: 'Assign to me' button (UserPlus icon), Status dropdown, Snooze dropdown",
        "'Assign to me' disabled if already assigned to current user",
        "Status dropdown shows colored dot + current status, dropdown shows all status options",
        "Snooze dropdown has options: 'Tomorrow morning', 'Next week'",
        "Actions execute immediately (same behavior as list quick actions)",
        "After action, preview pane updates to reflect changes",
        "If 'Advance on save' enabled and status changed to closed/solved, advance to next ticket",
        "Quick actions always visible (not hover-dependent like list rows)",
        "Keyboard shortcuts in preview: 'A' for assign, 'S' for status dropdown",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-017: US-040 quick actions"
    },
    {
      "id": "US-294",
      "title": "Implement column customization for ticket list",
      "description": "As an agent, I want to customize which columns appear in the ticket list.",
      "acceptanceCriteria": [
        "Column settings button (gear icon) in list header, right side near view toggle",
        "Clicking gear opens column settings panel/popover",
        "Panel shows available columns with checkboxes: Subject*, Requester*, Status, Priority, SLA, Tags, Assignee, Group, Created, Updated, Last Reply",
        "Subject and Requester are mandatory (checkbox disabled, always visible)",
        "Default columns: Subject, Requester, Status, SLA (existing layout)",
        "Toggling checkbox immediately shows/hides column (live preview)",
        "Drag handle on each column row to reorder (changes column order)",
        "Drag column dividers in header to resize columns",
        "Each column has minimum width (Subject 200px, Requester 150px, Status 80px, etc.)",
        "'Reset to defaults' button in column settings panel",
        "Right-click column header shows context menu: 'Hide column', 'Sort ascending', 'Sort descending'",
        "Column configuration stored in UserPreferences.ticketListColumns",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-017: US-042 column customization"
    },
    {
      "id": "US-295",
      "title": "Add search schema and backend functions",
      "description": "As a developer, I need database schema and backend functions for global search functionality.",
      "acceptanceCriteria": [
        "Add recentSearches table to schema with fields: userId, tenantId, query, scope, filters (optional object), timestamp",
        "Add indexes: by_user_id, by_user_tenant, by_timestamp",
        "Add entityAccessHistory table with fields: userId, tenantId, entityId, entityType, title, url, accessCount, lastAccessedAt",
        "Add indexes: by_user, by_user_tenant, by_user_entity, by_user_recency, by_user_frequency",
        "Create globalSearch query function that searches across entity types with fuzzy matching, relevance scoring, and permission filtering",
        "Create saveRecentSearch mutation that upserts recent searches (deduplicates by query+scope+filters)",
        "Create getRecentSearches query that returns user's recent searches ordered by timestamp",
        "Create clearRecentSearches mutation that deletes all recent searches for user",
        "Create deleteRecentSearch mutation that deletes a single recent search",
        "Create trackEntityAccess mutation that upserts access records (increments count, updates timestamp)",
        "Create getSuggestions query that returns type-ahead suggestions based on access history",
        "Create getEntityPreview query that returns entity-specific preview data",
        "Search respects user permissions (tenant, role, assignment)",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "PRD-018: Schema and backend foundation"
    },
    {
      "id": "US-296",
      "title": "Create search modal with keyboard shortcuts and context awareness",
      "description": "As a user, I want to open global search quickly and have it default to my current context.",
      "acceptanceCriteria": [
        "Create GlobalSearchProvider context component",
        "Create GlobalSearchModal component with centered layout, backdrop blur, max-w-2xl width",
        "Modal opens via \u2318K (Mac) or Ctrl+K (Windows) keyboard shortcut from any page",
        "Modal opens via search button click in header",
        "Input field auto-focuses on modal open",
        "Modal animates in (fade + scale from 0.96)",
        "Esc key closes modal, clicking outside closes modal",
        "Body scroll locked when modal open",
        "Focus returns to previous element when modal closes",
        "Context-aware default scope: /tickets/* \u2192 tickets, /work/* \u2192 workItems, /contacts/* \u2192 contacts+organizations, /billing/* \u2192 invoices, /time/* \u2192 timeEntries, /settings/users/* \u2192 users, /work/templates/* \u2192 templates, other \u2192 all",
        "Scope chip appears when scope is set (shows entity type name with icon)",
        "Scope chip removable (X button) to search all entities",
        "Placeholder text updates based on scope",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "PRD-018: US-001, US-002 modal foundation"
    },
    {
      "id": "US-297",
      "title": "Implement search input with scope prefixes and query parsing",
      "description": "As a user, I want to search with scope prefixes and have my query parsed correctly.",
      "acceptanceCriteria": [
        "Search input component with 300ms debounce",
        "Minimum 2 characters before search executes",
        "Scope prefix recognition: t:/ticket: \u2192 tickets, w:/work: \u2192 workItems, c:/contact: \u2192 contacts, o:/org: \u2192 organizations, i:/invoice: \u2192 invoices, @ \u2192 users",
        "Prefixes case-insensitive, only recognized at start of query",
        "Prefix text removed from visible query when recognized",
        "Scope chip updates when prefix recognized",
        "Prefix with no following text shows empty results",
        "Invalid prefix treated as regular query text",
        "Space after prefix normalized to single space",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "PRD-018: US-009 scope prefixes"
    },
    {
      "id": "US-298",
      "title": "Display search results with grouping and navigation",
      "description": "As a user, I want to see search results grouped by entity type with rich metadata.",
      "acceptanceCriteria": [
        "Results grouped by entity type when scope is 'all'",
        "Group headers show entity type name and count (e.g., 'Tickets (3)')",
        "Groups shown in priority order: Tickets, Work Items, Contacts, Organizations, Invoices, Time Entries, Users, Templates",
        "Maximum 5 results per group initially, 'Show all X results' link for groups with 5+ results",
        "Expanding group shows all results inline, 'Show less' collapses back",
        "Expanded state persists while query unchanged",
        "Each result shows entity-appropriate icon, title, subtitle with metadata, status badge where applicable",
        "Match highlighting on matched text in results",
        "Results keyboard-navigable with \u2191/\u2193 arrows",
        "Selected result has accent background, scrolls into view",
        "Hover state on results",
        "Enter key navigates to selected result",
        "\u2318Enter opens result in new tab",
        "Click navigates to result",
        "Navigation paths: tickets \u2192 /tickets/[id], workItems \u2192 /work/[id], contacts \u2192 /contacts/[id], organizations \u2192 /contacts/organizations/[id], invoices \u2192 /billing/invoices/[id], timeEntries \u2192 /time?entry=[id], users \u2192 /settings/users/[id], templates \u2192 /work/templates/[id]",
        "Recent search saved after navigation via saveRecentSearch",
        "Entity access tracked via trackEntityAccess after navigation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "PRD-018: US-004, US-005, US-006, US-017 results display"
    },
    {
      "id": "US-299",
      "title": "Add filter dropdowns and scoped search",
      "description": "As a user, I want to filter search results by status, assignee, client, and date range.",
      "acceptanceCriteria": [
        "Filter dropdowns below search input: Status, Assignee, Client, Date Range",
        "Filters contextual to current scope (e.g., no Assignee filter for invoices)",
        "Selected filters shown as removable chips below input",
        "Multiple filters combinable (AND logic)",
        "Results update on filter change (with debounce)",
        "Clear all filters button when filters active",
        "Filter state included in saved recent searches",
        "Filters reset when modal closes",
        "Dropdowns positioned below button, max-height 300px with scroll",
        "Multi-select filters use checkboxes, single-select highlight on hover",
        "Arrow keys navigate dropdown options, Enter selects and closes",
        "Dropdown closes on outside click or Escape",
        "Filter chips show count badges for multi-select (e.g., 'Status (2)')",
        "Scoped search (single entity type) shows flat list without group headers, up to 20 results",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "PRD-018: US-008, US-014 filters and scoped search"
    },
    {
      "id": "US-300",
      "title": "Implement keyboard navigation and initial state",
      "description": "As a user, I want full keyboard navigation and helpful initial state with recent searches.",
      "acceptanceCriteria": [
        "Arrow keys (\u2191/\u2193) navigate between results, suggestions, and actions (wraps at ends)",
        "Tab key accepts top suggestion and navigates immediately",
        "Shift+Tab moves to previous section",
        "Esc with text clears input, Esc with empty input closes modal",
        "\u23181-9 shortcuts jump to numbered results",
        "\u2318Backspace clears search input",
        "Space shows preview for selected result",
        "Focus trap within modal",
        "Initial state shows Recent Searches section (up to 10, newest first)",
        "Each recent search shows: query text, scope icon, relative time",
        "Clear button clears all recent searches",
        "Individual recent search deletable (X button on hover)",
        "Clicking recent search re-runs that search",
        "Quick Actions section shows: New Ticket (\u2318E), New Work Item (\u2318W), New Contact (\u2318C), New Time Entry (\u2318T)",
        "Quick actions have keyboard shortcuts displayed",
        "Clicking quick action triggers corresponding creation modal",
        "Empty state shows 'Start typing to search' if no recent searches",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "PRD-018: US-003, US-007, US-010 keyboard navigation and initial state"
    },
    {
      "id": "US-301",
      "title": "Add quick actions and command palette",
      "description": "As a user, I want to execute actions and commands from search without navigating away.",
      "acceptanceCriteria": [
        "Quick actions visible in empty state and when search has results",
        "Keyboard shortcuts work globally when search open: \u2318E (New Ticket), \u2318W (New Work Item), \u2318C (New Contact), \u2318T (New Time Entry)",
        "Quick actions open corresponding creation modals, search modal closes",
        "Command palette recognizes natural language commands via fuzzy matching",
        "Commands shown in 'Actions' section at top of results",
        "Maximum 3 commands shown (most relevant matches)",
        "Each command shows: icon, name, description, keyboard shortcut (if any)",
        "Commands executable via Enter when selected",
        "Direct keyboard shortcuts work even when command not visible",
        "Commands that need input show sub-prompt (e.g., 'Start timer' \u2192 work item selection)",
        "Sub-prompt has '\u2190 Back' button to return to main search",
        "Sub-prompt has search input for filtering work items",
        "Sub-prompt search uses same debounce (300ms) and minimum characters (2)",
        "Arrow keys navigate sub-prompt results, Enter selects and executes",
        "Escape closes sub-prompt and returns to main search",
        "Command execution closes modal (unless sub-prompt needed)",
        "Recently used commands ranked higher",
        "Context-aware commands shown first",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "PRD-018: US-011, US-021 quick actions and commands"
    },
    {
      "id": "US-302",
      "title": "Add type-ahead suggestions and hover preview",
      "description": "As a user, I want smart suggestions and previews to find items faster.",
      "acceptanceCriteria": [
        "Suggestions appear on first keystroke (no debounce, from local/cached data)",
        "Maximum 3 suggestions shown",
        "Suggestions ranked by: recency \u00d7 frequency \u00d7 context relevance",
        "Suggestions shown in 'Suggested' section above full search results",
        "Tab key accepts top suggestion and navigates immediately",
        "Suggestions section hidden when empty or no matches",
        "'Suggested' section has hint text showing Tab shortcut",
        "Suggestions blend into results after 3+ characters",
        "Hover preview appears after 300ms hover delay on result",
        "Preview positioned to right of results list, max-width 320px",
        "Preview repositions if would overflow viewport (shows on left instead)",
        "Preview dismissed on mouse leave, scroll, or keyboard navigation",
        "Preview content loads async (skeleton shown if data not loaded within 200ms)",
        "Preview skeleton matches preview card structure",
        "If preview load fails, shows 'Unable to load preview' message",
        "Keyboard users can trigger preview with Space on selected item",
        "Preview has subtle entrance animation (fade + slide)",
        "Preview card has shadow to distinguish from results",
        "Moving directly from result to preview keeps preview open",
        "Clicking within preview navigates to entity",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "PRD-018: US-019, US-020 suggestions and preview"
    },
    {
      "id": "US-303",
      "title": "Add result actions menu and mouse navigation",
      "description": "As a user, I want to take actions on results and navigate with mouse.",
      "acceptanceCriteria": [
        "Action menu appears on hover (right side of row) or \u2318. on selected item",
        "Menu shows entity-relevant actions: Open, Open in New Tab, Copy Link, Add to My Week (tickets/work items), Start Timer (work items)",
        "Actions execute and close search",
        "Copy Link copies URL to clipboard with toast confirmation (2s duration, bottom-right)",
        "Add to My Week adds item and shows confirmation toast (2s duration, bottom-right)",
        "Start Timer starts timer for work item and shows toast (2s duration, bottom-right)",
        "Toast appears bottom-right, auto-dismisses after 2s, has subtle slide-up animation",
        "Arrow keys navigate menu items, Enter executes selected action, Escape closes menu",
        "Menu closes after action execution",
        "Menu position adjusts to prevent off-screen placement",
        "Hovering result highlights it (same as keyboard selection)",
        "Clicking result navigates (same as Enter)",
        "Mouse selection doesn't interfere with keyboard selection",
        "Clicking outside results area doesn't close modal",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "PRD-018: US-015, US-018 result actions and mouse support"
    },
    {
      "id": "US-304",
      "title": "Add loading, error, and empty states",
      "description": "As a user, I want clear feedback for loading, errors, and empty results.",
      "acceptanceCriteria": [
        "Loading skeleton appears in results area after debounce elapses",
        "Skeleton shows 3-4 placeholder rows matching result row structure",
        "Loading state appears within 100ms of query, no flash for fast queries (< 200ms)",
        "Input remains editable during loading",
        "Empty state shows search icon and 'No results for [query]'",
        "Empty state shows suggestions: check spelling, fewer keywords, remove filters",
        "Empty state shows quick action buttons for creating new items",
        "If filters active, empty state suggests removing them",
        "Empty state maintains query in input for easy modification",
        "Network errors show: 'Connection error. Check your internet and try again.'",
        "API errors show: 'Search unavailable. Please try again.'",
        "Timeout errors show: 'Search timed out. Try a shorter query.'",
        "Retry button re-runs last query",
        "Error state maintains query in input",
        "Error state shows quick actions as fallback",
        "Error messages announced via ARIA live regions",
        "Error state replaces loading state (no flash)",
        "Command execution errors show specific toast messages",
        "Error toast appears bottom-right, auto-dismisses after 5s",
        "Retryable actions show 'Retry' button in toast",
        "Modal remains open on error (doesn't close)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "PRD-018: US-012, US-013, US-016, US-023 states and error handling"
    },
    {
      "id": "US-305",
      "title": "Transform ticket list to email-style cards in preview mode",
      "description": "As an agent, I want the ticket list to display as email-style cards when preview mode is enabled so that I can efficiently scan tickets with meaningful information in limited space.",
      "acceptanceCriteria": [
        "When preview mode enabled, list renders card-based layout instead of table",
        "Each card shows: avatar (40x40 circle with 2-letter initials), requester name, subject (2 lines max), message snippet (~50 chars), relative timestamp, status dot",
        "Avatar background color derived deterministically from requester name (consistent per person)",
        "Timestamp shows relative format: '3:50 PM' (today), 'Yesterday', 'Mon' (this week), 'Jan 28' (older)",
        "Unread tickets show bold requester name and subject",
        "Hover state: subtle background highlight (bg-accent/50)",
        "Selected state: accent background with 3px left border in primary color",
        "Cards stack vertically using full width of list pane (no columns)",
        "Card height consistent (~80px) regardless of content length",
        "Column headers and column settings button hidden in preview mode",
        "Sort dropdown appears in list header with options: Newest, Oldest, Requester A-Z, Status, SLA urgency",
        "Arrow keys navigate cards and update preview pane",
        "Single click selects card and loads in preview pane",
        "Enter key opens selected ticket in tab",
        "Sort selection persists in UserPreferences",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-018: US-043 email-style cards for preview mode"
    },
    {
      "id": "US-306",
      "title": "Fix sidebar hover to slide smoothly without overlay",
      "description": "As an agent, I want the collapsed sidebar to smoothly slide open when I hover so that I don't see a confusing double-sidebar effect.",
      "acceptanceCriteria": [
        "Hovering collapsed sidebar triggers expansion after 200ms delay",
        "Sidebar animates width from 48px to 220px over 150ms (ease-out)",
        "NO double-sidebar effect - collapsed icons not visible during/after expansion",
        "Labels fade in during last 50% of expansion animation",
        "Expanded sidebar has drop shadow (shadow-lg) to indicate floating state",
        "Hover-out triggers collapse after 300ms delay (prevents flicker)",
        "Collapse animation: 150ms ease-in, labels fade out first",
        "Clicking expand button (>>) while hovering pins sidebar permanently",
        "Expanded state looks identical to click-expanded sidebar (same styling)",
        "Content behind does NOT resize during hover (overlay mode)",
        "Clicking a view navigates AND collapses sidebar immediately (no delay)",
        "Keyboard shortcut '[' still toggles collapsed/expanded as before",
        "Hover expansion also triggers on keyboard focus (Tab into sidebar)",
        "Escape key collapses sidebar if expanded via hover",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-018: US-044 smooth sidebar slide animation"
    },
    {
      "id": "US-307",
      "title": "Add layout mode context and conditional rendering",
      "description": "As a developer, I need components to be aware of layout mode so they render appropriately for list-only vs preview mode.",
      "acceptanceCriteria": [
        "LayoutModeContext provides: mode ('list-only' | 'preview'), sidebarState ('expanded' | 'collapsed' | 'hover-expanded')",
        "TicketList component conditionally renders TicketTableList or TicketCardList based on mode",
        "ColumnSettings button hidden when mode === 'preview'",
        "SortDropdown shown when mode === 'preview'",
        "CSS transitions used for sidebar width changes (not JavaScript animation)",
        "Sidebar uses data-state attribute for animation states",
        "Animation timing: 150ms ease-out for expand, 150ms ease-in for collapse",
        "Layout mode persisted in UserPreferences (survives page refresh)",
        "Smooth transition when switching between modes (200ms ease-in-out)",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-018: US-045 layout mode context and conditional rendering"
    },
    {
      "id": "US-308",
      "title": "Add work item linking schema fields and indexes",
      "description": "As a developer, I need schema fields to support bidirectional linking between tickets and work items.",
      "acceptanceCriteria": [
        "Add workItemIds array field to tickets table (v.array(v.id('workItems')), default: [])",
        "Add ticketIds array field to workItems table (v.array(v.id('tickets')), default: [])",
        "Add index 'by_work_item_ids' on tickets table for reverse lookups",
        "Add index 'by_ticket_ids' on workItems table for reverse lookups",
        "Existing records default to empty arrays (no migration needed)",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-019: Schema changes for ticket-work item linking"
    },
    {
      "id": "US-309",
      "title": "Create linking mutations and queries",
      "description": "As a developer, I need mutations to link/unlink tickets and work items, and queries to fetch related items.",
      "acceptanceCriteria": [
        "Create linkWorkItemToTicket mutation (updates both ticket and work item arrays)",
        "Create unlinkWorkItemFromTicket mutation (removes IDs from both arrays)",
        "Create createWorkItemFromTicket mutation (creates work item and links bidirectionally)",
        "Create getWorkItemsByTicketId query (returns linked work items)",
        "Create getTicketsByWorkItemId query (returns linked tickets)",
        "Mutations handle duplicate prevention (check if ID already in array)",
        "Mutations update both entities atomically",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-019: Backend operations for linking"
    },
    {
      "id": "US-310",
      "title": "Add Create Work Item from Ticket dialog",
      "description": "As a team member, I want to create a work item directly from a ticket so that I can track larger efforts without losing context.",
      "acceptanceCriteria": [
        "'Create Work Item' button visible on ticket detail page",
        "Dialog opens with pre-populated fields: name (ticket subject), client (from ticket), assignee (from ticket), description (first message truncated)",
        "User can modify all pre-populated fields",
        "Work type selection required",
        "Template selection optional",
        "On create: work item created with ticketIds array including source ticket",
        "On create: ticket workItemIds array updated with new work item ID",
        "Success toast confirms creation and linking",
        "User navigated to new work item detail page",
        "Warning shown if ticket has no client",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-019: Create work item from ticket flow"
    },
    {
      "id": "US-311",
      "title": "Add Link Work Item dialogs and Related Items sections",
      "description": "As a team member, I want to link existing work items to tickets and see related items on both detail pages.",
      "acceptanceCriteria": [
        "'Link Work Item' button on ticket detail page opens searchable work item selector",
        "'Link Ticket' button on work item detail page opens searchable ticket selector",
        "Selectors support filtering by client, status, work type/queue",
        "Bidirectional linking updates both entities",
        "'Related Work Items' section on ticket detail page shows linked work items",
        "'Related Tickets' section on work item detail page shows linked tickets",
        "Sections show empty states with action buttons when no items linked",
        "Each item shows name, status, assignee, progress (for work items)",
        "Items are clickable links to detail pages",
        "'Unlink' button on each item with confirmation dialog",
        "Sections update in real-time when items are linked/unlinked",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-019: Link existing items and display related items"
    },
    {
      "id": "US-312",
      "title": "Replace bulk actions text input with UserPicker",
      "description": "As a user, I want to search and select users when reassigning work items in bulk so that I don't have to type user IDs manually.",
      "acceptanceCriteria": [
        "Reassign button opens Popover with UserPicker component (not text input)",
        "UserPicker shows searchable list of users with avatars and names",
        "UserPicker shows groups as separate section",
        "User can search by name or email",
        "Selected user displayed with avatar in confirmation dialog",
        "'Unassign' option available if items are currently assigned",
        "Confirmation dialog shows user name (not user ID)",
        "Success message shows user name (not user ID)",
        "Keyboard navigation works (arrow keys, Enter, Escape)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-020: Bulk reassign UX improvement"
    },
    {
      "id": "US-313",
      "title": "Replace native date input with Calendar component in bulk actions",
      "description": "As a user, I want to use a visual calendar picker when changing due dates in bulk so that date selection is consistent with the rest of the app.",
      "acceptanceCriteria": [
        "Change Due Date button opens Popover with Calendar component (not native input)",
        "Calendar component matches design pattern from time entries and invoices",
        "Selected date displayed in readable format (e.g., 'Jan 15, 2026') in confirmation dialog",
        "Calendar closes automatically on date selection",
        "Calendar shows current month with navigation arrows",
        "Today's date highlighted",
        "Selected date visually distinct",
        "Confirmation dialog shows formatted date (not timestamp)",
        "Success message shows formatted date",
        "Keyboard navigation works (arrow keys, Enter)",
        "Mobile-friendly touch interactions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-020: Bulk due date UX improvement"
    },
    {
      "id": "US-314",
      "title": "Add Assigned to Me tab to Assignments page",
      "description": "As a user, I want to see all items delegated to me in one place so that I don't miss work assigned to me.",
      "acceptanceCriteria": [
        "'Assigned to Me' tab exists on Assignments page",
        "Tab shows items from assignments table where assignedTo === currentUser",
        "Table columns: Item, Item Type, Delegated By, Delegation Status, Item Status, Date Assigned, Actions",
        "Items show name, client, status",
        "Clicking item navigates to work item or ticket detail page",
        "Filters work: Status (pending/in progress/completed), Item Type (work item/ticket), Date Range",
        "Delegation status can be updated via dropdown",
        "Empty state shows: 'No items have been delegated to you'",
        "Uses existing listAssignedToMe query",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-021: Assigned to Me tab"
    },
    {
      "id": "US-315",
      "title": "Add delegated items toggle to My Week",
      "description": "As a user, I want to see delegated items in My Week so that I have a complete view of my weekly work.",
      "acceptanceCriteria": [
        "Toggle 'Include delegated items' exists in My Week header",
        "Toggle state persisted per user (UserPreferences)",
        "Default: OFF (only direct assignments shown)",
        "When enabled, My Week queries both direct assignments and delegated items",
        "Delegated items show visual indicator: 'Delegated' badge",
        "Badge shows who delegated it (e.g., 'Delegated by John')",
        "Items appear in correct day section based on due date",
        "Delegated items can be hidden/dismissed",
        "Hidden delegated items don't reappear when toggle re-enabled",
        "Toggle tooltip explains: 'Show items delegated to you via the assignments system'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-021: My Week delegated items"
    },
    {
      "id": "US-316",
      "title": "Add assignment source indicators and terminology clarification",
      "description": "As a user, I want to see visual indicators showing how an item was assigned so that I understand the assignment type.",
      "acceptanceCriteria": [
        "Visual indicator appears on items with assignments",
        "'Direct' badge for assigneeId assignments (blue)",
        "'Delegated' badge for assignments table items (purple)",
        "Tooltip on hover shows: 'Directly assigned to you' or 'Delegated by [Name] on [Date]'",
        "In My Week, delegated items show 'Delegated by [Name]' text",
        "UI distinguishes 'Assign' vs 'Delegate' actions in dropdowns",
        "Tooltips explain difference: Assign = direct, Delegate = tracked",
        "Consistent terminology across app",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-021: Assignment source indicators and terminology"
    },
    {
      "id": "US-317",
      "title": "Add Billing tab to Contact and Organization detail pages",
      "description": "As a user, I want to view billing history (invoices) for a contact's organization so that I can see all billing activity without leaving the contact page.",
      "acceptanceCriteria": [
        "'Billing' tab appears on Contact detail page (after Overview tab)",
        "'Billing' tab appears on Organization detail page (after Recurring Work tab)",
        "Tabs show count badge: 'Billing (12)' if invoices exist",
        "Contact tab shows invoices for all organizations contact is member of",
        "Organization tab shows invoices where invoice.clientId === organization._id",
        "Invoice list shows: Invoice Number, Date, Amount, Status, Due Date",
        "Invoice rows are clickable and open invoice detail page",
        "Filters: Status (Draft, Sent, Paid, Overdue, Cancelled), Date Range",
        "Sorting: Date, Amount, Invoice Number",
        "Summary section shows: Total Invoiced, Outstanding Amount, Paid Amount",
        "Empty state: 'No invoices found for this contact/organization'",
        "Empty state includes 'Create Invoice' button (if permissions)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-022: Billing tabs on contact pages"
    },
    {
      "id": "US-318",
      "title": "Make client names clickable for navigation",
      "description": "As a user, I want to click client names to navigate to client detail pages so that I can quickly access client information.",
      "acceptanceCriteria": [
        "Client name in work item header is clickable link",
        "Client name in work item list is clickable link",
        "Client name in work item cards is clickable link",
        "Client name in invoice detail page is clickable link",
        "Client name in invoice list is clickable link",
        "Links navigate to /contacts/{clientId} (Organization detail)",
        "Links show hover state (underline or color change)",
        "Tooltip on hover: 'View client details'",
        "If client unknown/missing, show 'Unknown Client' (not clickable)",
        "Keyboard accessible (Enter/Space activates)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-022: Client name navigation"
    },
    {
      "id": "US-319",
      "title": "Add Source section to work item Details tab",
      "description": "As a team member, I want to see where a work item came from (template, recurring work, automation) so that I can understand its origin and navigate to related resources.",
      "acceptanceCriteria": [
        "'Source' section appears in Details tab below existing details",
        "If templateId exists: shows 'Template: [Name]' with 'View Template' link",
        "If recurringWorkId exists: shows 'Recurring Work: [Name]' with 'View Recurring Work' link",
        "If automationRunId exists: shows 'Created by automation on [Date]'",
        "If period exists: shows 'Period: [Formatted Period]' (e.g., 'January 2026')",
        "Shows 'Created by: [User/Automation]' based on createdByType",
        "If no source fields: shows 'Created manually' or hides section",
        "Template link navigates to /work/templates/[templateId]",
        "Recurring work link opens recurring work detail panel",
        "Loading states shown while fetching template/recurring work names",
        "Error handling: If deleted, show 'Template deleted' or 'Recurring work deleted'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-023: Work item source section"
    },
    {
      "id": "US-320",
      "title": "Add Generated Work Items tab to template detail page",
      "description": "As a team member, I want to see all work items created from a template so that I can understand how the template is being used.",
      "acceptanceCriteria": [
        "'Generated Work Items' tab added to template detail page",
        "Tab shows list of work items with matching templateId",
        "List displays: name, client, status, assignee, created date, period",
        "Work item names are clickable links (navigate to work item detail)",
        "Filters available: status, client, assignee, period",
        "Search filters by work item name",
        "Empty state: 'No work items created from this template yet'",
        "Loading state shown while fetching work items",
        "Pagination if more than 20 items",
        "List sorted by creation date (newest first) by default",
        "Tab shows count badge: 'Generated Work Items (12)'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-023: Template generated work items tab"
    },
    {
      "id": "US-321",
      "title": "Add auto-generated badge to work items list",
      "description": "As a team member, I want to see visual indicators on work items that were auto-generated so that I can quickly identify which items came from automation.",
      "acceptanceCriteria": [
        "Badge/icon visible on auto-generated work items in list views",
        "Badge appears when recurringWorkId OR automationRunId exists",
        "Badge uses automation/robot icon (Bot icon from lucide-react)",
        "Tooltip shows on hover with creation details",
        "Badge visible in all list views: Work items list, Client detail page, Organization detail page",
        "Badge styling matches app design system (subtle, not distracting)",
        "Badge accessible (screen reader: 'Auto-generated work item')",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-023: Auto-generated badge"
    },
    {
      "id": "US-322",
      "title": "Create ClientPicker shared component",
      "description": "As a developer, I need a reusable ClientPicker component so that client selection is consistent and searchable across all modules.",
      "acceptanceCriteria": [
        "ClientPicker component created at components/shared/client-picker.tsx",
        "Uses Popover + Command pattern (matches Contacts module style)",
        "Search filters by client/organization name in real-time",
        "Shows client name prominently",
        "Shows organization name as secondary text (if contact belongs to org)",
        "Shows 'Standalone contact' indicator if no organization",
        "Empty state: 'No clients found' when search has no matches",
        "Loading state: Shows spinner while fetching clients",
        "Keyboard navigation: Arrow keys navigate, Enter selects, Escape closes",
        "Accessible: Proper ARIA labels, keyboard support",
        "Trigger button shows selected client name or placeholder",
        "Supports 'clear selection' option (if field is optional)",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": true,
      "notes": "CHANGE-024: ClientPicker component"
    },
    {
      "id": "US-323",
      "title": "Create UserPicker shared component",
      "description": "As a developer, I need a reusable UserPicker component so that user selection is consistent and searchable across all modules.",
      "acceptanceCriteria": [
        "UserPicker component created at components/shared/user-picker.tsx",
        "Uses Popover + Command pattern (extracted from AssigneeCombobox)",
        "Search filters by name or email in real-time",
        "Shows user avatar (initials fallback)",
        "Shows user name prominently",
        "Shows email as secondary text",
        "Shows role badge if available (optional)",
        "Empty state: 'No users found' when search has no matches",
        "Loading state: Shows spinner while fetching users",
        "Keyboard navigation: Arrow keys navigate, Enter selects, Escape closes",
        "Accessible: Proper ARIA labels, keyboard support",
        "Trigger button shows selected user (avatar + name) or 'Unassigned' placeholder",
        "Supports 'Unassign' option (clear selection)",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": true,
      "notes": "CHANGE-024: UserPicker component"
    },
    {
      "id": "US-324",
      "title": "Replace client Selects with ClientPicker in Work module",
      "description": "As a team member, I want to use the searchable client picker when creating or editing work items so that I can find clients quickly even with many clients.",
      "acceptanceCriteria": [
        "Create Work Item dialog uses ClientPicker for client selection",
        "Create Work from Template dialog uses ClientPicker for client selection",
        "Work Item Header edit mode uses ClientPicker (replaces Input field)",
        "All work item forms consistently use ClientPicker",
        "Pre-filled client IDs work correctly with ClientPicker",
        "Validation errors display correctly with ClientPicker",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "CHANGE-024: Work module ClientPicker integration"
    },
    {
      "id": "US-325",
      "title": "Replace client Selects with ClientPicker in Billing module",
      "description": "As a team member, I want to use the searchable client picker when creating invoices, SOWs, or recurring billing so that I can find clients quickly.",
      "acceptanceCriteria": [
        "Invoice dialog uses ClientPicker for client selection",
        "SOW create/edit pages use ClientPicker for client selection",
        "Recurring billing dialog uses ClientPicker for client selection",
        "All billing forms consistently use ClientPicker",
        "Pre-filled client IDs work correctly with ClientPicker",
        "Validation errors display correctly with ClientPicker",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 18,
      "passes": true,
      "notes": "CHANGE-024: Billing module ClientPicker integration"
    },
    {
      "id": "US-326",
      "title": "Create StatusBadge shared component",
      "description": "As a developer, I need a StatusBadge component with standardized status-to-color mapping so that status displays are consistent across all modules.",
      "acceptanceCriteria": [
        "StatusBadge component created at components/shared/status-badge.tsx",
        "Component normalizes status strings (lowercase, handle variations)",
        "Status color mappings: active (emerald), pending (amber), complete (blue), review (purple), planned (gray), cancelled (gray), failed (red), archived (gray), draft (yellow), etc.",
        "Formats status text for display (Title Case)",
        "Supports compact variant for dense layouts",
        "Handles unknown statuses gracefully (fallback to default)",
        "Uses Badge component from @/components/ui/badge",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": "CHANGE-025: StatusBadge component"
    },
    {
      "id": "US-327",
      "title": "Create EmptyState shared component",
      "description": "As a developer, I need an EmptyState component with consistent messaging patterns so that empty states are helpful and actionable across all modules.",
      "acceptanceCriteria": [
        "EmptyState component created at components/shared/empty-state.tsx",
        "Supports three layout variants: default, minimal, inline",
        "Accepts custom icons or uses defaults",
        "Supports primary and secondary actions",
        "Follows messaging guidelines: 'No {items} yet' for unfiltered, 'No {items} match your filters' when filtered",
        "Centered layout (default variant) with icon, title, description, actions",
        "Accessible: Proper heading hierarchy, ARIA labels",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": true,
      "notes": "CHANGE-025: EmptyState component"
    },
    {
      "id": "US-328",
      "title": "Create ConfirmationDialog shared component",
      "description": "As a developer, I need a ConfirmationDialog component with standardized terminology so that confirmation dialogs are consistent and clear.",
      "acceptanceCriteria": [
        "ConfirmationDialog component created at components/shared/confirmation-dialog.tsx",
        "Supports three action types: delete, remove, confirm",
        "Automatically includes 'This cannot be undone' for delete actions",
        "Uses consistent button styling (destructive for delete/remove)",
        "Shows loading states during async actions",
        "Handles both string and ReactNode descriptions",
        "Uses AlertDialog components from @/components/ui/alert-dialog",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": "CHANGE-025: ConfirmationDialog component"
    },
    {
      "id": "US-329",
      "title": "Migrate status badges to use StatusBadge component",
      "description": "As a user, I want to see consistent status badge colors across all modules so that I can quickly understand status without learning different color schemes.",
      "acceptanceCriteria": [
        "All status badges in Work module use StatusBadge component",
        "All status badges in Tickets module use StatusBadge component",
        "All status badges in Billing module use StatusBadge component",
        "All status badges in Contacts module use StatusBadge component",
        "Remove local getStatusVariant() functions and STATUS_VARIANTS objects",
        "Same status values show same colors across modules",
        "Status text is consistently formatted (Title Case)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 22,
      "passes": true,
      "notes": "CHANGE-025: Status badge migration"
    },
    {
      "id": "US-330",
      "title": "Migrate empty states to use EmptyState component",
      "description": "As a user, I want to see consistent empty state messages with clear actions so that I know what to do when lists are empty.",
      "acceptanceCriteria": [
        "All empty states in Tickets module use EmptyState component",
        "All empty states in Work module use EmptyState component",
        "All empty states in Contacts module use EmptyState component",
        "All empty states in Billing module use EmptyState component",
        "All empty states follow messaging guidelines",
        "Primary lists always have action buttons in empty states",
        "Empty states are visually consistent (icon, title, description, actions)",
        "Filtered empty states show 'match your filters' messaging",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 23,
      "passes": true,
      "notes": "CHANGE-025: Empty state migration"
    },
    {
      "id": "US-331",
      "title": "Migrate confirmation dialogs to use ConfirmationDialog component",
      "description": "As a user, I want to see consistent confirmation dialogs with clear terminology so that I understand the consequences of my actions.",
      "acceptanceCriteria": [
        "All delete confirmation dialogs use ConfirmationDialog with type='delete'",
        "All remove confirmation dialogs use ConfirmationDialog with type='remove'",
        "All delete actions include 'This cannot be undone'",
        "All remove actions clarify entity is not deleted",
        "All confirmation dialogs use consistent button styling",
        "Loading states shown during async actions",
        "Dialog titles and descriptions are clear and specific",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 24,
      "passes": true,
      "notes": "CHANGE-025: Confirmation dialog migration"
    },
    {
      "id": "US-332",
      "title": "Add Time section sub-items to sidebar navigation",
      "description": "As a team member, I want to see Time sub-items in the sidebar navigation so that I can easily access timesheet management and utilization reports.",
      "acceptanceCriteria": [
        "Time section appears as expandable section (not single link)",
        "Time section has chevron icon indicating expandable state",
        "Clicking Time section header expands/collapses sub-items",
        "Sub-items visible when expanded: 'My Time' (/time), 'Timesheets' (/time/timesheets), 'Utilization' (/time/utilization)",
        "Sub-items use appropriate icons (Clock, FileText, BarChart3)",
        "Active sub-item is highlighted when on that route",
        "Time section auto-expands when user navigates to any /time/* route",
        "Pattern matches Work, Contacts, and Billing sections",
        "Collapsed sidebar shows Time icon with tooltip listing sub-items",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 25,
      "passes": true,
      "notes": "CHANGE-026: Time module navigation"
    },
    {
      "id": "US-333",
      "title": "Create formatStatus helper function and standardize status display",
      "description": "As a developer, I need a centralized formatStatus() helper function so that status values are displayed consistently across the application.",
      "acceptanceCriteria": [
        "formatStatus() helper function created in lib/utils.ts",
        "Function converts lowercase_with_underscores to Title Case",
        "Function handles common variations (complete/completed, cancelled/canceled)",
        "All status displays use formatStatus() helper",
        "Status values in data layer are lowercase with underscores",
        "Status values in display layer are Title Case",
        "Function has JSDoc documentation",
        "Typecheck passes"
      ],
      "priority": 26,
      "passes": true,
      "notes": "CHANGE-027: Status formatting standardization"
    },
    {
      "id": "US-334",
      "title": "Remove 'project' terminology from search keywords",
      "description": "As a user, I want to use the correct terminology when searching so that I can find work items using the canonical term 'work item'.",
      "acceptanceCriteria": [
        "'project' and 'new project' removed from search keywords in global-search-modal.tsx",
        "Search still works with 'work item', 'work', 'new work', 'create work', 'add work'",
        "Command palette uses only canonical terminology",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 27,
      "passes": true,
      "notes": "CHANGE-027: Search terminology cleanup"
    },
    {
      "id": "US-335",
      "title": "Add SOW documents schema and backend operations",
      "description": "As a developer, I need database schema and backend operations for SOW document storage and management.",
      "acceptanceCriteria": [
        "Add sowDocuments table to convex/schema.ts with fields: sowId, storageId, fileName, fileSize, mimeType, description (optional), uploadedBy, uploadedAt",
        "Add index 'by_sow_id' on sowId field",
        "Create sowDocuments.listBySow query that returns documents with uploaderName resolved from users table",
        "Create sowDocuments.getById query that returns single document with uploaderName",
        "Create sowDocuments.upload mutation that accepts sowId, storageId, fileName, fileSize, mimeType, description (optional) and returns document ID",
        "Create sowDocuments.updateDescription mutation that updates document description",
        "Create sowDocuments.deleteDocument mutation that removes document from storage and database",
        "Create sowDocuments.generateUploadUrl action that returns upload URL",
        "Create sowDocuments.getDownloadUrl action that generates download URL for document (expires after 1 hour)",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": true,
      "notes": "CHANGE-028: SOW Document Uploads - Schema + backend"
    },
    {
      "id": "US-336",
      "title": "Add Documents tab and list view to SOW detail page",
      "description": "As a user, I want to see a Documents tab on the SOW detail page with a list of uploaded documents.",
      "acceptanceCriteria": [
        "Documents tab appears between 'Change Orders' and 'Details' tabs on SOW detail page",
        "Tab shows document icon and 'Documents' label",
        "Tab is accessible for all SOW statuses",
        "CardHeader shows title 'Documents', description 'Signed agreements and related files', and 'Upload Document' button",
        "CardHeader with upload button is sticky (remains visible while scrolling)",
        "Document table displays columns: Name (with file type icon), Description, Size (formatted KB/MB), Uploaded (date), Uploaded By (user name), Actions",
        "File type icons: PDF/Word \u2192 FileText, Excel \u2192 FileSpreadsheet, Images \u2192 Image (from lucide-react)",
        "Documents sorted by upload date (newest first)",
        "Uploader name resolved from Clerk user ID via users table (fallback to Clerk API, then 'Unknown User')",
        "Empty state shows when no documents: FileText icon, 'No documents yet' heading, description, 'Upload Document' button",
        "Loading skeleton shows 3-5 skeleton rows while fetching",
        "Error state shows retry button if fetch fails",
        "CardContent with table scrolls independently",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 29,
      "passes": true,
      "notes": "CHANGE-028: SOW Document Uploads - Tab and list view"
    },
    {
      "id": "US-337",
      "title": "Implement document upload with progress tracking",
      "description": "As a user, I want to upload documents to an SOW with progress tracking and validation.",
      "acceptanceCriteria": [
        "Upload button enabled for Draft and Active SOWs",
        "Upload button disabled for Complete and Cancelled SOWs with tooltip: 'Cannot upload documents to {status} SOWs'",
        "Multiple file selection supported",
        "Supported file types: PDF, DOC, DOCX, XLS, XLSX, PNG, JPG, JPEG, GIF",
        "Maximum file size: 25MB per file",
        "Files exceeding size limit show error before upload: 'File [filename] exceeds 25MB limit'",
        "Invalid file types show error before upload: 'File [filename] type not supported'",
        "Upload flow: generateUploadUrl \u2192 upload file \u2192 create record via mutation",
        "Upload progress bar shows percentage (0-100%) for each file",
        "Each file shows visual status: uploading (progress bar), completed (checkmark), failed (error icon)",
        "Cancel button available during upload for each file",
        "Network errors show toast: 'Upload failed. Please check your connection and try again.' with retry button",
        "Storage quota errors show toast: 'Storage limit reached. Please contact administrator.'",
        "Upload success shows toast: 'Document uploaded' (or 'X documents uploaded' for multiple)",
        "Partial upload failures show: 'X of Y documents uploaded. [List failed files]'",
        "Newly uploaded documents appear in list immediately (optimistic update)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 30,
      "passes": true,
      "notes": "CHANGE-028: SOW Document Uploads - Upload functionality"
    },
    {
      "id": "US-338",
      "title": "Add download, delete, edit description, and detail view actions",
      "description": "As a user, I want to download, delete, edit descriptions, and view details for SOW documents.",
      "acceptanceCriteria": [
        "Download action visible on each document row (icon button)",
        "Clicking download generates download URL on-demand (not cached)",
        "Download URLs expire after 1 hour (Convex default)",
        "Expired URLs automatically trigger regeneration and retry",
        "File downloads with original filename preserved",
        "Download errors show toast: 'Failed to download file. Please try again.'",
        "Delete action visible on each document row (icon button)",
        "Delete enabled only for Draft and Active SOWs",
        "Delete disabled for Complete and Cancelled SOWs with tooltip: 'Cannot delete documents from {status} SOWs'",
        "Confirmation dialog prevents accidental deletion: 'Delete [filename]? This cannot be undone.'",
        "Confirming deletion removes file from list immediately and from Convex storage",
        "Success toast shows after deletion",
        "Edit description icon visible on each document row",
        "Clicking edit icon or description area triggers inline editing",
        "Description field supports max 500 characters with character counter",
        "Save button or Enter key updates description immediately",
        "Cancel button or Escape key reverts to original description",
        "Edit available for Draft/Active SOWs only, disabled for Complete/Cancelled with tooltip",
        "Success toast shows 'Description updated'",
        "Detail view opens as sheet/panel (right side on desktop, bottom on mobile)",
        "Detail view shows: filename, size, upload date/time, uploader name, description, file type",
        "Upload date shows both date and time (e.g., 'Jan 15, 2025 at 2:30 PM')",
        "Preview available for images (PNG, JPG, JPEG, GIF) - displays inline",
        "Preview available for PDFs - shows download link or iframe preview",
        "Download, Delete, and Edit description actions available in detail view",
        "Close button (X) returns to list view",
        "Clicking outside sheet closes detail view",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 31,
      "passes": true,
      "notes": "CHANGE-028: SOW Document Uploads - Actions and detail view"
    },
    {
      "id": "US-339",
      "title": "Create TaskDetailSheet component",
      "description": "As a user, I want to view and edit task details in a side panel so that I can manage tasks without losing context of the task list.",
      "acceptanceCriteria": [
        "Create TaskDetailSheet component (components/work/task-detail-sheet.tsx)",
        "Sheet slides in from right (500px width on desktop, full-width on mobile)",
        "Sheet has sticky header with task name and close button",
        "Task name is editable inline (large input at top)",
        "Completion checkbox visible in sheet header",
        "Section shown as dropdown selector",
        "Assignee shown with UserPicker component",
        "Due date shown with calendar picker",
        "Description shown as textarea (auto-expanding)",
        "Checklist section shows all checklist items with add/toggle/delete/reorder",
        "Delete task button at bottom of sheet (destructive red)",
        "All edits auto-save with debounce (500ms)",
        "Saving indicator shows in sheet header during save",
        "Sheet closes on X, Escape, or overlay click",
        "Clicking checkbox in task row completes task WITHOUT opening sheet",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-029: Task detail sheet foundation"
    },
    {
      "id": "US-340",
      "title": "Wire task row click to open TaskDetailSheet",
      "description": "As a user, I want to click on a task to see its full details in a side panel.",
      "acceptanceCriteria": [
        "Clicking task row (anywhere except checkbox or drag handle) opens TaskDetailSheet",
        "TaskDetailSheet displays task name, section, status, assignee, due date, description, and checklist",
        "Task list reflects any changes made in sheet",
        "Checkbox click on row does NOT open sheet (event stopped)",
        "Drag handle click does NOT open sheet (event stopped)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-029: Task row interaction"
    },
    {
      "id": "US-341",
      "title": "Create TaskQuickAddInput component",
      "description": "As a user, I want to quickly add tasks by typing and pressing Enter so that I can rapidly create multiple tasks without clicking buttons.",
      "acceptanceCriteria": [
        "Create TaskQuickAddInput component (components/work/task-quick-add-input.tsx)",
        "Add a task... placeholder visible at bottom of every section (including Uncategorized)",
        "Placeholder has subtle styling (muted text, dashed border or just text)",
        "Clicking placeholder focuses text input in its place",
        "No save/cancel buttons - keyboard only",
        "Enter key creates task and clears input (keeps focus for rapid entry)",
        "Escape key dismisses input (if empty) or clears text (if has content)",
        "Blur with text triggers task creation (auto-save)",
        "Blur with empty text dismisses input",
        "New task appears immediately with optimistic UI",
        "Task is assigned to the section where the input lives",
        "Input shows subtle Press Enter to add hint on focus",
        "Loading state shows spinner on task row during creation",
        "On creation error, toast shows: Failed to create task. Please try again. with retry button",
        "On error, task disappears (optimistic UI rollback)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-029: Quick-add input component"
    },
    {
      "id": "US-342",
      "title": "Add persistent quick-add inputs to all sections",
      "description": "As a user, I want to see quick-add inputs at the bottom of each section so that I can rapidly create tasks.",
      "acceptanceCriteria": [
        "Quick-add input appears at bottom of every section (including Uncategorized)",
        "Quick-add input appears at bottom of empty sections",
        "Quick-add input persists even when section has tasks",
        "Each section has its own independent quick-add input",
        "Input state (focused/empty) is independent per section",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-029: Quick-add integration"
    },
    {
      "id": "US-343",
      "title": "Create CreateTaskSheet component",
      "description": "As a user, I want to create a task with all details filled in from the start so that I dont have to create first and then expand to add details.",
      "acceptanceCriteria": [
        "Create CreateTaskSheet component (components/work/create-task-sheet.tsx)",
        "Sheet slides in from right (500px width on desktop, full-width on mobile)",
        "Sheet title is New Task",
        "Task name field is required and auto-focused",
        "Task name field shows asterisk (*) after label: Name *",
        "Task name field shows red border and error message if empty on blur or submit attempt",
        "Error message: Name is required",
        "Section dropdown shows all existing sections + Uncategorized",
        "Section defaults to Uncategorized",
        "Assignee uses UserPicker component",
        "Due date uses calendar picker",
        "Description is optional textarea",
        "Add checklist expands to show checklist item inputs",
        "Cancel button closes sheet without creating",
        "Create Task button is disabled until name is entered",
        "Create Task button shows Creating... text and spinner during creation",
        "Create Task creates task and closes sheet",
        "Success toast: Task created",
        "New task appears in selected section immediately (optimistic UI)",
        "On creation error, toast shows: Failed to create task. Please try again. with retry button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-029: Create task sheet"
    },
    {
      "id": "US-344",
      "title": "Wire header Add Task button to CreateTaskSheet",
      "description": "As a user, I want to create tasks with full details from the header button.",
      "acceptanceCriteria": [
        "Header + Add Task button opens CreateTaskSheet",
        "Button is visible and accessible in Tasks tab header",
        "Sheet opens with form ready for input",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-029: Header button integration"
    },
    {
      "id": "US-345",
      "title": "Fix empty state with functional quick-add",
      "description": "As a user, I want to see a helpful empty state when there are no tasks so that I can quickly create my first task.",
      "acceptanceCriteria": [
        "Empty state shows when tasks.length === 0 (regardless of sections)",
        "Empty state includes centered icon (ListChecks)",
        "Title: No tasks yet",
        "Description: Add tasks to track work items and their progress.",
        "Inline quick-add input with placeholder Add your first task...",
        "Quick-add input is functional (type + Enter creates task)",
        "+ Add Task with Details button opens CreateTaskSheet",
        "After first task created, normal section view appears",
        "First task goes to Uncategorized section",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-029: Empty state fix"
    },
    {
      "id": "US-346",
      "title": "Add visible Add Task button to section headers",
      "description": "As a user, I want to see a visible + Add Task button on each section header so that I can easily add tasks to a specific section.",
      "acceptanceCriteria": [
        "+ Add Task button visible on every section header (not in dropdown)",
        "Button has icon (Plus) and text Add Task",
        "Button uses ghost or outline variant (subtle but visible)",
        "Clicking button focuses the quick-add input at bottom of that section",
        "If section is collapsed, clicking expands it first, then focuses quick-add input",
        "Three-dot menu (\u22ee) only contains Delete Section now",
        "Section name is still inline-editable on click (except Uncategorized)",
        "Section collapse state persists across page refreshes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-029: Section header actions"
    },
    {
      "id": "US-347",
      "title": "Make Uncategorized section always visible",
      "description": "As a user, I want to always see the Uncategorized section when named sections exist so that I have a consistent place for tasks without a specific category.",
      "acceptanceCriteria": [
        "Uncategorized section shown when sections.length > 0",
        "Uncategorized section always appears at the bottom (after all named sections)",
        "Uncategorized section has special styling (dashed border, muted header)",
        "Uncategorized section cannot be renamed (no inline edit)",
        "Uncategorized section cannot be deleted (no delete option)",
        "Uncategorized section can be collapsed/expanded",
        "Uncategorized section has same quick-add input as named sections",
        "When only Uncategorized tasks exist (no named sections), show as flat list without section header",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-029: Uncategorized section behavior"
    },
    {
      "id": "US-348",
      "title": "Implement auto-save for task edits in sheet",
      "description": "As a user, I want task edits to auto-save so that I can update information without clicking save buttons.",
      "acceptanceCriteria": [
        "All fields in sheet are editable",
        "Name field: inline text input, large font",
        "Description field: auto-expanding textarea",
        "Section field: dropdown with all sections + Uncategorized",
        "Assignee field: UserPicker component (searchable)",
        "Due date field: Calendar picker",
        "Changes trigger debounced auto-save (500ms)",
        "Saving... text or spinner shows in sheet header during save",
        "No explicit Save button needed",
        "Escape key closes sheet (auto-saves pending changes first)",
        "Changing section moves task in list immediately (optimistic UI)",
        "On save error, toast shows: Failed to update task. Please try again. with retry button",
        "On error, changes revert to last saved state",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-029: Task edit auto-save"
    },
    {
      "id": "US-349",
      "title": "Implement task deletion from sheet",
      "description": "As a user, I want to delete a task from the detail sheet so that I can remove tasks without going back to the list.",
      "acceptanceCriteria": [
        "Delete task button at bottom of sheet",
        "Button is destructive style (red text or red background)",
        "Button has trash icon",
        "Single click deletes immediately (no confirmation modal)",
        "Sheet closes after deletion",
        "Toast shows Task deleted with Undo action",
        "Clicking Undo restores task within 5 seconds",
        "Task list updates immediately (optimistic)",
        "Work item progress recalculates",
        "On deletion error, toast shows: Failed to delete task. Please try again. with retry button",
        "On error, task reappears in list (optimistic UI rollback)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-029: Task deletion"
    },
    {
      "id": "US-350",
      "title": "Implement task completion from row or sheet",
      "description": "As a user, I want to mark a task complete from either the list row or the detail sheet so that I can track progress quickly.",
      "acceptanceCriteria": [
        "Checkbox click on row does NOT open sheet (event stopped)",
        "Checkbox in sheet header toggles completion",
        "Completed tasks show strikethrough on name",
        "Completed tasks show Completed status badge (muted green badge)",
        "Completed tasks have muted styling in list (reduced opacity, grayed out)",
        "Completed tasks remain visible in their original position (do not move to bottom)",
        "Completed tasks can be reordered (drag handle still works)",
        "Checkbox is disabled for already-completed tasks (no un-complete)",
        "Progress percentage on work item updates immediately",
        "Task count in section header includes completed tasks (shows X tasks not X active tasks)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-029: Task completion"
    },
    {
      "id": "US-351",
      "title": "Implement checklist management in task sheet",
      "description": "As a user, I want to manage checklist items within the task detail sheet so that I can track sub-steps for complex tasks.",
      "acceptanceCriteria": [
        "Checklist section visible in TaskDetailSheet",
        "Shows progress: Checklist (2/4) in section header",
        "Each item has: drag handle, checkbox, text, delete (on hover)",
        "+ Add item input at bottom of checklist",
        "Enter creates item, keeps focus for rapid entry",
        "Escape dismisses empty input",
        "Toggle checkbox marks complete with strikethrough",
        "Delete shows on hover, single click removes with undo toast",
        "Drag handle allows reordering",
        "Maximum 20 items per checklist (show limit message)",
        "If no checklist items, show Add checklist link to start",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-029: Checklist management"
    },
    {
      "id": "US-352",
      "title": "Implement keyboard navigation shortcuts",
      "description": "As a power user, I want to use keyboard shortcuts for common task actions so that I can work efficiently without reaching for the mouse.",
      "acceptanceCriteria": [
        "n key opens quick-add input (focuses Uncategorized section input)",
        "Escape key closes open sheet",
        "Enter in quick-add creates task",
        "Escape in quick-add dismisses input",
        "Focus trap in sheets (Tab cycles through sheet elements, Shift+Tab reverses)",
        "Screen reader announces sheet open/close (Task detail panel opened, Task detail panel closed)",
        "Screen reader announces task creation (Task [name] created)",
        "All interactive elements have visible focus states (outline ring)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-029: Keyboard navigation"
    },
    {
      "id": "US-353",
      "title": "Implement section creation and management",
      "description": "As a user, I want to create, edit, and delete sections to organize tasks.",
      "acceptanceCriteria": [
        "+ Add Section button visible and accessible in Tasks tab header",
        "Button appears after existing sections or at top when no sections exist",
        "Clicking button creates inline editable input",
        "Section name is required (min 1 character, max 50 characters)",
        "Empty name shows validation error: Section name is required",
        "Enter key saves section and creates it",
        "Escape key cancels creation (dismisses input)",
        "Blur with valid name saves section",
        "Section appears immediately after creation (optimistic UI)",
        "Section is expanded by default",
        "Uncategorized section appears automatically below new section",
        "Duplicate section names are allowed (no validation error)",
        "Loading state shows spinner during creation",
        "Error toast appears if creation fails: Failed to create section. Please try again. with retry button",
        "Clicking section name activates inline edit (except Uncategorized)",
        "Input shows current name pre-filled and selected",
        "Enter key saves changes",
        "Escape key cancels edit (reverts to original name)",
        "Blur saves changes (if name changed)",
        "Empty name shows validation error: Section name is required",
        "Name length validation: max 50 characters",
        "Changes auto-save with debounce (500ms)",
        "Saving... indicator shows during save",
        "Error toast appears if save fails: Failed to update section name. Please try again. with retry button",
        "Uncategorized section cannot be renamed (no click handler, cursor: default)",
        "Delete Section option visible in three-dot menu on section header",
        "Uncategorized section cannot be deleted (option hidden or disabled)",
        "If section has tasks, confirmation dialog appears before deletion",
        "Confirmation dialog shows: Move [X] task(s) to Uncategorized and delete [Section Name]?",
        "Confirmation dialog has Cancel and Delete Section buttons",
        "Delete Section button in dialog is destructive style (red)",
        "Empty section deletes immediately (no confirmation dialog)",
        "Deletion happens immediately (optimistic UI)",
        "Toast shows Section deleted with Undo action (available for 5 seconds)",
        "Clicking Undo restores section and moves tasks back to original section",
        "Tasks moved to Uncategorized appear at bottom of Uncategorized section",
        "Loading state shows spinner during deletion",
        "Error toast appears if deletion fails: Failed to delete section. Please try again. with retry button",
        "If only one named section exists and is deleted, Uncategorized section disappears (shows flat list)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "CHANGE-029: Section CRUD operations"
    },
    {
      "id": "US-354",
      "title": "Implement task and section reordering",
      "description": "As a user, I want to drag tasks and sections to reorder them so that I can prioritize work.",
      "acceptanceCriteria": [
        "Drag handle visible on task row (always visible or on hover)",
        "Drag handle does NOT trigger task click (event.stopPropagation)",
        "Dragging shows visual feedback (opacity reduced to 50%, cursor changes to grabbing)",
        "Drop indicator shows where task will land (highlighted area or insertion line)",
        "Can reorder tasks within same section",
        "Can drag task to different section (changes sectionId automatically)",
        "When dragging to different section, drop indicator shows target section",
        "Order updates immediately (optimistic UI)",
        "Order persists on page refresh",
        "Loading state shows during reorder save (subtle spinner or disabled state)",
        "Error toast appears if reorder fails: Failed to reorder task. Please try again. with retry button",
        "On error, task reverts to original position",
        "Completed tasks can be reordered (stay in place by default, but can be moved)",
        "Drag handle visible on section header (always visible or on hover)",
        "Can reorder sections by dragging",
        "Uncategorized section cannot be dragged (drag handle hidden or disabled)",
        "Uncategorized section always stays at bottom (cannot be moved above named sections)",
        "Drop indicator shows where section will land",
        "Order updates immediately (optimistic UI)",
        "Order persists on page refresh",
        "All tasks within section maintain their relative order when section is moved",
        "Loading state shows during reorder save",
        "Error toast appears if reorder fails: Failed to reorder section. Please try again. with retry button",
        "On error, section reverts to original position",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "CHANGE-029: Drag-drop reordering"
    },
    {
      "id": "US-355",
      "title": "Manage Custom Fields (Admin)",
      "description": "As a user, I want manage custom fields (admin) so that I can use this feature.",
      "acceptanceCriteria": [
        "Custom Fields page accessible via Settings > Work > Custom Fields",
        "**Empty state:** When no custom fields exist, shows empty state with message \"No custom fields yet\" and \"Create your first custom field\" CTA button",
        "Page shows list of all custom fields in table format",
        "Table columns: Name, Type, Work Types, Required, Created Date, Actions",
        "\"Add Custom Field\" button opens creation dialog",
        "Field type selector shows all available types with descriptions",
        "Selecting type reveals type-specific configuration",
        "Text/LongText: max length, placeholder",
        "Number: min, max, precision, prefix, suffix",
        "Date: include time toggle",
        "Checkbox: label text",
        "**Dropdown:** Options list with:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-001"
    },
    {
      "id": "US-356",
      "title": "Configure Status Field Stages",
      "description": "As a user, I want configure status field stages so that I can use this feature.",
      "acceptanceCriteria": [
        "Status field config shows stages list",
        "\"Add Stage\" button adds new stage row",
        "Each stage has: drag handle, name input, color picker, \"Final\" toggle, delete button",
        "Color picker shows preset palette (red, orange, yellow, green, blue, purple, gray) plus custom hex input",
        "Stages can be reordered via drag-and-drop",
        "At least one stage is required",
        "Stage names must be unique within the field",
        "Delete removes stage (with confirmation if values exist)",
        "\"Is Final\" toggle marks stage as completion state (shows checkmark badge)",
        "Preview shows stages as colored pills in order",
        "Default stage can be selected from dropdown",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-002"
    },
    {
      "id": "US-357",
      "title": "Assign Custom Fields to Work Types",
      "description": "As a user, I want assign custom fields to work types so that I can use this feature.",
      "acceptanceCriteria": [
        "Work Types configuration accessible from Custom Fields page",
        "Each work type shows its assigned custom fields count",
        "Clicking work type opens detail panel (see US-CF-016)",
        "\"Add Field\" opens field picker with available fields",
        "Fields already assigned are shown as disabled/checked",
        "Selected fields appear in work type's field list",
        "Drag-and-drop to reorder fields within work type",
        "\"Required\" override toggle per field per work type",
        "\"Default Value\" override per field per work type",
        "Remove field from work type (doesn't delete field)",
        "Changes save with success toast",
        "Global fields shown separately (cannot be removed, but can be reordered)",
        "Global fields can be reordered within the global set",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-003"
    },
    {
      "id": "US-358",
      "title": "see custom field values on a work item",
      "description": "As a user, I want see custom field values on a work item so that I can view all relevant metadata in one place",
      "acceptanceCriteria": [
        "\"Properties\" section appears in Details tab (below or alongside existing fields)",
        "Section shows custom fields for this work item's work type",
        "Global custom fields also shown",
        "Fields display in configured sort order",
        "Field display formats:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-004"
    },
    {
      "id": "US-359",
      "title": "edit custom field values on a work item",
      "description": "As a user, I want edit custom field values on a work item so that I can keep metadata up to date as work progresses",
      "acceptanceCriteria": [
        "\"Edit\" button toggles Properties section into edit mode",
        "Alternatively, clicking a field value starts inline edit",
        "Field edit controls:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-005"
    },
    {
      "id": "US-360",
      "title": "change a work item's status stage",
      "description": "As a user, I want change a work item's status stage so that I can track progress through my workflow",
      "acceptanceCriteria": [
        "Status badge is clickable",
        "Clicking opens stage selector",
        "Stage selector shows all stages in order",
        "Each stage shows colored indicator and name",
        "Current stage is highlighted",
        "Final stages show checkmark icon",
        "Selecting stage updates immediately",
        "Timeline activity created with old \u2192 new stage",
        "Undo available for 5 seconds (toast with Undo button)",
        "Stage change timestamp recorded",
        "Stage change user recorded",
        "**Keyboard navigation:**",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-006"
    },
    {
      "id": "US-361",
      "title": "see custom field values in the work item list view",
      "description": "As a user, I want see custom field values in the work item list view so that I can quickly scan important metadata across multiple items",
      "acceptanceCriteria": [
        "Column configuration accessible via gear icon or column header menu",
        "Custom fields appear in \"Available Columns\" list",
        "Fields grouped by \"Custom Fields\" section",
        "Selecting field adds column to table",
        "Column position can be reordered",
        "Column width can be resized",
        "Field display in column:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-007"
    },
    {
      "id": "US-362",
      "title": "filter work items by custom field values",
      "description": "As a user, I want filter work items by custom field values so that I can find specific items based on metadata",
      "acceptanceCriteria": [
        "Custom fields appear in filter type selector",
        "Fields grouped under \"Custom Fields\" section",
        "Filter operators by field type:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-008"
    },
    {
      "id": "US-363",
      "title": "group work items by a status-type custom field",
      "description": "As a user, I want group work items by a status-type custom field so that I can see items organized by workflow stage",
      "acceptanceCriteria": [
        "\"Group by\" dropdown shows custom fields",
        "Status-type fields prioritized in list",
        "Grouping creates collapsible sections in list view",
        "Each group header shows: stage color, stage name, item count",
        "Groups appear in stage order (not alphabetical)",
        "Empty groups can be shown/hidden (toggle)",
        "In Kanban view, status field stages become columns",
        "Drag work item between groups changes the field value",
        "Group totals show in header (e.g., \"7 items\")",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-009"
    },
    {
      "id": "US-364",
      "title": "set custom field values when creating a work item",
      "description": "As a user, I want set custom field values when creating a work item so that metadata is captured from the start",
      "acceptanceCriteria": [
        "Custom fields appear in Create Work Item dialog",
        "Fields appear after standard fields (name, client, due date, etc.)",
        "Fields appear in configured sort order",
        "Required fields show asterisk and validation",
        "Default values pre-populate fields",
        "Status fields default to configured default stage (or first stage)",
        "Validation prevents creation if required fields empty",
        "All field types have appropriate create-time controls",
        "Creating from template includes template-associated fields",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-010"
    },
    {
      "id": "US-365",
      "title": "Custom Fields on Work Item Templates",
      "description": "As a user, I want custom fields on work item templates so that I can use this feature.",
      "acceptanceCriteria": [
        "Template editor shows \"Custom Fields\" configuration section",
        "Section shows fields associated with template's work type",
        "Admin can add additional fields beyond work type defaults",
        "Admin can set default values per field per template",
        "Default values override work type defaults",
        "Creating work item from template includes all configured fields",
        "Field values editable during work item creation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-011"
    },
    {
      "id": "US-366",
      "title": "understand that custom fields are available",
      "description": "As a user viewing a work item without custom fields configured, I want understand that custom fields are available so that I'm aware of the feature's existence",
      "acceptanceCriteria": [
        "Properties section still appears (not hidden)",
        "If no fields configured, shows \"No custom fields configured\"",
        "For admins: \"Add custom fields to track additional metadata for [Work Type] items\"",
        "Link to Settings > Work > Custom Fields for admins",
        "Non-admins see clean state without configuration prompts",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-012"
    },
    {
      "id": "US-367",
      "title": "Archive Custom Field",
      "description": "As a user, I want archive custom field so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Archive\" action available on each custom field",
        "Confirmation dialog: \"Archive '[Field Name]'?\"",
        "Message explains: \"This field will be hidden from new work items. Existing values on [X] work items will be preserved but read-only.\"",
        "Archived fields hidden from:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-013"
    },
    {
      "id": "US-368",
      "title": "Edit Custom Field (Admin)",
      "description": "As a user, I want edit custom field (admin) so that I can use this feature.",
      "acceptanceCriteria": [
        "Edit dialog opens with all current field values",
        "Field name editable (field key auto-updates if name changes, with uniqueness check)",
        "**Field type NOT editable** (would break existing values) - shown as read-only with tooltip: \"Field type cannot be changed after creation\"",
        "Description editable",
        "Type-specific config editable:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-014"
    },
    {
      "id": "US-369",
      "title": "clear a custom field value on a work item",
      "description": "As a user, I want clear a custom field value on a work item so that I can remove incorrect or unwanted data",
      "acceptanceCriteria": [
        "Clear icon appears on editable custom field values (in edit mode)",
        "Clicking clear removes value immediately (for optional fields)",
        "**Required fields:** Show confirmation dialog: \"This field is required. Clear anyway? This may prevent saving the work item.\"",
        "Clearing creates timeline activity: \"[User] cleared [Field Name]\" with timestamp",
        "Cleared fields show empty state (\u2014 or \"Not set\")",
        "Undo available for 5 seconds after clear (toast with Undo button)",
        "Clear action disabled for read-only work items",
        "Clear action disabled for archived fields",
        "If field has default value, clearing sets to empty (not default)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-015"
    },
    {
      "id": "US-370",
      "title": "View Work Type Field Configuration Detail",
      "description": "As a user, I want view work type field configuration detail so that I can use this feature.",
      "acceptanceCriteria": [
        "Clicking work type opens detail panel/modal",
        "Panel shows work type name and \"Close\" button (sticky header)",
        "Shows all assigned fields in sort order",
        "Each field shows:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-016"
    },
    {
      "id": "US-371",
      "title": "update custom field values for multiple work items at once",
      "description": "As a user, I want update custom field values for multiple work items at once so that I can efficiently manage metadata across items",
      "acceptanceCriteria": [
        "Bulk action \"Update Custom Fields\" available when 2+ items selected",
        "Dialog shows field picker dropdown",
        "Field picker only shows fields that exist on ALL selected work items",
        "If no common fields, shows message: \"No common custom fields found across selected items\"",
        "Value input matches field type:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-017"
    },
    {
      "id": "US-372",
      "title": "receive clear validation feedback when entering custom field values",
      "description": "As a user, I want receive clear validation feedback when entering custom field values so that I can correct errors before saving",
      "acceptanceCriteria": [
        "**Required fields:**",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 18,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-018"
    },
    {
      "id": "US-373",
      "title": "Delete Custom Field (Admin)",
      "description": "As a user, I want delete custom field (admin) so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Delete\" action only available on archived fields",
        "Confirmation dialog: \"Permanently delete '[Field Name]'?\"",
        "Dialog shows impact:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 19,
      "passes": true,
      "notes": "CHANGE-030-Work-Item-Custom-Fields: US-CF-019"
    },
    {
      "id": "US-374",
      "title": "View Teams List",
      "description": "As a user, I want view teams list so that I can use this feature.",
      "acceptanceCriteria": [
        "Teams page accessible via Settings > Teams navigation",
        "Teams displayed as cards (consistent with Roles page design)",
        "Each card shows: Team name, description (truncated), member count, manager name(s)",
        "Teams sorted alphabetically by name (default)",
        "Sort options available: Name (A-Z), Member Count (high to low), Created Date (newest first)",
        "Active teams shown by default",
        "Inactive teams shown with filter or toggle",
        "Search filters teams by name in real-time",
        "\"Create Team\" button prominent in header",
        "Header stays sticky on scroll, team cards grid scrolls independently",
        "Empty state: \"No teams yet. Create your first team to organize your members.\"",
        "Loading skeleton shown while fetching",
        "Click on team card navigates to team detail page",
        "Permission errors: Non-admins see only teams they belong to or manage",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-001"
    },
    {
      "id": "US-375",
      "title": "view all members of a team",
      "description": "As a user with team access, I want view all members of a team so that I can see who is on the team and their roles",
      "acceptanceCriteria": [
        "Members displayed in table format",
        "Columns: User (avatar + name), Email, Role, Joined",
        "Managers displayed first with \"Manager\" badge",
        "Members displayed alphabetically within each role group",
        "\"Add Member\" button visible for admins and team managers",
        "Loading skeleton shown while fetching members",
        "Empty state: \"No members yet. Add members to this team.\"",
        "Member count in header matches list count (includes both managers and members - total unique users)",
        "Click on member row opens user detail (if permitted)",
        "Network error handling: Shows error message with retry button if fetch fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-008"
    },
    {
      "id": "US-376",
      "title": "filter work items by team",
      "description": "As a user, I want filter work items by team so that I can see all work for a specific team",
      "acceptanceCriteria": [
        "Team filter added to work list filter bar",
        "\"My Teams\" option shows combined work from all user's teams (union of all teams user belongs to, not a single selection)",
        "Filter shows team name with member count",
        "Inactive teams hidden from filter (unless viewing archived work)",
        "Filter combines with existing filters (status, assignee, client)",
        "URL parameter: `?team=<teamId>`",
        "Clear filter resets to \"All Teams\"",
        "Results show work items assigned to team OR assigned to team members",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-012"
    },
    {
      "id": "US-377",
      "title": "view time utilization for my team",
      "description": "As a team manager, I want view time utilization for my team so that I can understand workload distribution and capacity",
      "acceptanceCriteria": [
        "Date range picker: This Week, Last Week, This Month, Custom",
        "Table shows all team members (including those with 0 hours)",
        "Columns: Member, Total Hours, Billable, Non-Billable, Utilization %",
        "Utilization % calculated against expected hours (40hr week default)",
        "Team totals row shows aggregate stats",
        "Expandable rows show hours by work item",
        "Export option: CSV download",
        "CSV format: Columns: Member Name, Email, Total Hours, Billable Hours, Non-Billable Hours, Utilization %, Date Range (in header)",
        "Loading skeleton shown while fetching utilization data",
        "Empty state: \"No time entries found for this period\"",
        "Color coding: Red if under capacity, Green if on target",
        "Click member name goes to user's time entries for period",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-015"
    },
    {
      "id": "US-378",
      "title": "see how work is distributed across my team",
      "description": "As a team manager, I want see how work is distributed across my team so that I can balance workloads and identify overloaded members",
      "acceptanceCriteria": [
        "Summary stats at top: Total open, By status breakdown",
        "Member distribution table with key metrics",
        "Visual indicator for overloaded members (e.g., red badge if >10 open items)",
        "Filters: Work Type, Status, Due Date range",
        "Expand row to see member's work items inline",
        "Click work item goes to work item detail",
        "Empty state: \"This team has no work items. Work items assigned to team members will appear here.\"",
        "Loading skeleton shown while fetching work distribution data",
        "Refresh button to update stats",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-016"
    },
    {
      "id": "US-379",
      "title": "View User's Teams",
      "description": "As a user, I want view user's teams so that I can use this feature.",
      "acceptanceCriteria": [
        "Teams tab added to user detail page",
        "Shows all teams user is member of",
        "For each team: Team name, role badge, joined date",
        "Click team name navigates to team detail",
        "\"Add to Team\" button for admins",
        "\"Remove\" action for each team membership",
        "Empty state: \"This user is not a member of any teams\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-017"
    },
    {
      "id": "US-380",
      "title": "Route Tickets to Team",
      "description": "As a user, I want route tickets to team so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Route to team\" action added to routing rules",
        "Team picker shows active teams",
        "Routed tickets have teamId set",
        "Team members can filter tickets by their team",
        "Works alongside existing queue routing",
        "Team routing logged in ticket timeline",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-018"
    },
    {
      "id": "US-381",
      "title": "filter tickets by team",
      "description": "As a user, I want filter tickets by team so that I can see all tickets for a specific team",
      "acceptanceCriteria": [
        "Team filter added to ticket list filter bar",
        "\"My Teams\" option shows combined tickets from all user's teams (union of all teams user belongs to)",
        "Filter shows team name with member count",
        "Inactive teams hidden from filter (unless viewing archived tickets)",
        "Filter combines with existing filters (status, assignee, queue)",
        "URL parameter: `?team=<teamId>`",
        "Clear filter resets to \"All Teams\"",
        "Results show tickets assigned to team OR assigned to team members",
        "Filter bar stays sticky on scroll, ticket list scrolls below",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-031-Team-Management: US-TEAM-019"
    },
    {
      "id": "US-382",
      "title": "create a personal view with custom filters and configuration",
      "description": "As a user, I want create a personal view with custom filters and configuration so that I can quickly access a filtered set of items matching my workflow",
      "acceptanceCriteria": [
        "\"Save View\" button visible when filters are applied",
        "\"+\" icon visible in views sidebar to create new view",
        "View creation dialog shows filter summary",
        "View name is required (validation error if empty: \"View name is required\")",
        "View name max 50 characters",
        "Duplicate names allowed per user (no unique constraint for personal views)",
        "System view names must be unique globally",
        "Shared view names can duplicate across different owners",
        "Icon picker shows common icons (inbox, star, clock, user, etc.)",
        "Color picker shows preset colors (8-10 options)",
        "Filters can be modified in dialog before saving",
        "View appears in sidebar immediately after creation",
        "Success toast: \"View created\"",
        "Error handling: Network errors show \"Failed to create view. Please try again.\" with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-001"
    },
    {
      "id": "US-383",
      "title": "see items grouped by a field (status, assignee, client, etc.)",
      "description": "As a user, I want see items grouped by a field (status, assignee, client, etc.) so that I can organize and navigate items more efficiently",
      "acceptanceCriteria": [
        "\"Group by\" dropdown in view display settings",
        "Available grouping fields based on context:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-012"
    },
    {
      "id": "US-384",
      "title": "see and navigate between views in a sidebar",
      "description": "As a user, I want see and navigate between views in a sidebar so that I can quickly switch contexts",
      "acceptanceCriteria": [
        "Views sidebar visible on left side of list pages",
        "Sidebar organized in sections:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-015"
    },
    {
      "id": "US-385",
      "title": "see helpful information when a view has no matching items",
      "description": "As a user, I want see helpful information when a view has no matching items so that I understand why it's empty and what to do",
      "acceptanceCriteria": [
        "Empty state shows centered content",
        "Shows relevant icon (search, filter, inbox)",
        "Title: \"No items match this view\"",
        "Description shows filter summary: \"Filters: Status = In Progress, Assignee = Me\"",
        "Suggestions:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-017"
    },
    {
      "id": "US-386",
      "title": "have useful default views available",
      "description": "As a user, I want have useful default views available so that I can start using the system immediately",
      "acceptanceCriteria": [
        "Migration script converts `savedViews` entries to `customViews`",
        "Migration script converts `ticketViews` entries to `customViews`",
        "Legacy tables marked as deprecated but not deleted",
        "View names, filters, and order preserved",
        "Personal views remain personal",
        "System/shared ticket views mapped appropriately",
        "Migration runs on deployment automatically",
        "Rollback plan if migration fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-019"
    },
    {
      "id": "US-387",
      "title": "create folders to organize my views",
      "description": "As a user, I want create folders to organize my views so that I can group related views together",
      "acceptanceCriteria": [
        "\"New Folder\" button visible in sidebar (in \"My Views\" section)",
        "\"New Folder\" option in sidebar context menu (right-click)",
        "Folder name required, max 50 characters",
        "Folder name validation: \"Folder name is required\" if empty",
        "Can nest folders up to 2 levels deep (parent folder dropdown disabled at max depth)",
        "Folder appears collapsed by default",
        "Can drag views into folder (visual drop indicator)",
        "Folder shows view count badge: \"Folder Name (3)\"",
        "Success toast: \"Folder created\"",
        "Error handling: Network errors show \"Failed to create folder. Please try again.\" with retry",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-022"
    },
    {
      "id": "US-388",
      "title": "see detailed information about a view",
      "description": "As a user, I want see detailed information about a view so that I understand its configuration without editing",
      "acceptanceCriteria": [
        "Info icon visible on hover or always visible next to view name",
        "Double-click view name also opens details",
        "Details panel shows read-only configuration:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-032-Custom-Views-System: US-VIEW-026"
    },
    {
      "id": "US-389",
      "title": "Start Time Tracker (Modified)",
      "description": "As a user, I want start time tracker (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-001"
    },
    {
      "id": "US-390",
      "title": "Track Time Against Work Item (Modified)",
      "description": "As a user, I want track time against work item (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-009"
    },
    {
      "id": "US-391",
      "title": "start a timer with one click from the header",
      "description": "As a user viewing a work item, I want start a timer with one click from the header so that I can immediately begin tracking time without navigating or scrolling",
      "acceptanceCriteria": [
        "Timer button visible in work item header (not in dropdown menu)",
        "Button shows play icon with optional \"Start Timer\" text when no timer exists",
        "Button shows \"Resume Timer (HH:MM:SS)\" if paused timer exists for this work item",
        "Button shows \"\u23f9 [HH:MM:SS]\" if active timer running for this work item",
        "Button shows \"Start Timer\" with badge if active timer running for different work item",
        "Button is visible on all screen sizes (responsive design)",
        "Timer button disabled (not hidden) for archived work items (with tooltip)",
        "Timer button hidden for deleted work items",
        "Single click starts/resumes timer for current work item (when appropriate)",
        "Confirmation dialog shown when switching from different active timer",
        "Timer indicator updates in global header immediately",
        "Toast notification confirms timer action",
        "Button shows loading state briefly during timer start/resume",
        "Button state updates in real-time as timer state changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-001"
    },
    {
      "id": "US-392",
      "title": "click the global \"Start Timer\" button and have it auto-suggest the current work item",
      "description": "As a user viewing a work item page, I want click the global \"Start Timer\" button and have it auto-suggest the current work item so that I don't have to search for a work item I'm already viewing",
      "acceptanceCriteria": [
        "Global timer button detects URL path `/work/[workId]`",
        "When on work item page, modal opens with work item pre-selected",
        "Context indicator shows: \"For: [Work Item Name]\" below modal title",
        "Context indicator has subtle styling (muted text, small font)",
        "User can still change work item selection (not locked to context)",
        "If work item not found or error, falls back to default behavior (no pre-selection)",
        "Works correctly on initial page load and after navigation",
        "Does not affect timer behavior when not on work item page",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-002"
    },
    {
      "id": "US-393",
      "title": "see confirmation of which work item I'm tracking time against",
      "description": "As a user starting a timer from context, I want see confirmation of which work item I'm tracking time against so that I can verify I'm tracking to the correct item before starting",
      "acceptanceCriteria": [
        "Context indicator appears below modal title when work item is pre-selected",
        "Format: \"For: [Work Item Name]\" in muted text",
        "Work item name truncates with ellipsis if too long (max-width: 280px)",
        "Clicking context indicator does NOT change selection (read-only indicator)",
        "If user manually changes selection, indicator updates immediately (not on blur)",
        "If user clears selection, indicator shows \"No work item selected\" or is hidden",
        "Context indicator has icon (Briefcase) for visual consistency",
        "Indicator updates synchronously with selection changes (no delay)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-003"
    },
    {
      "id": "US-394",
      "title": "see a timer button immediately visible at the top of the tab",
      "description": "As a user viewing the Time & Budget tab, I want see a timer button immediately visible at the top of the tab so that I can start tracking time without scrolling past budget summary cards",
      "acceptanceCriteria": [
        "Timer button visible at top of Time & Budget tab (above budget cards)",
        "Button is first interactive element in tab content",
        "Button styling matches work item header timer button behavior",
        "Original timer button location (after budget cards) removed (single button at top)",
        "Timer button shows \"Resume Timer (HH:MM:SS)\" if paused timer exists for this work item",
        "Timer button shows \"\u23f9 Stop Timer (HH:MM:SS)\" if active timer running for this work item",
        "Timer button shows \"Start Timer\" with indicator if active timer running for different work item",
        "Button state matches work item header timer button (consistent behavior)",
        "Button updates in real-time as timer state changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-004"
    },
    {
      "id": "US-395",
      "title": "see that the timer is already running for this work item",
      "description": "As a user with a timer running for the current work item, I want see that the timer is already running for this work item so that I don't accidentally start a duplicate timer",
      "acceptanceCriteria": [
        "Timer button detects if timer is running for current work item",
        "If timer running for this work item, button shows \"\u23f9 [HH:MM:SS]\" or \"\u23f9 Stop Timer\"",
        "Button styling changes to indicate active state (primary color, animated pulse on icon)",
        "Clicking button while timer running opens stop timer modal",
        "Timer button tooltip shows \"Stop timer for this work item\"",
        "If timer running for DIFFERENT work item, button shows \"\u25b6 Start Timer\" with badge indicator \"(1 running)\"",
        "If timer running for different work item, clicking shows confirmation dialog to switch timers",
        "Button state updates in real-time as elapsed time increments",
        "Button reflects timer state immediately on page load (no delay)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-005"
    },
    {
      "id": "US-396",
      "title": "see that a paused timer exists for this work item",
      "description": "As a user viewing a work item with a paused timer, I want see that a paused timer exists for this work item so that I can resume it easily",
      "acceptanceCriteria": [
        "Button detects paused timer for current work item",
        "Button shows \"Resume Timer (HH:MM:SS)\" format",
        "Button styling indicates paused state (outline variant, different from start)",
        "Clicking resumes timer (pauses current active if exists)",
        "Toast confirms resume action",
        "Button updates immediately when timer state changes",
        "If multiple paused timers exist for different work items, only shows paused timer for current work item",
        "Button state consistent between header and Time & Budget tab",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-033-Timer-UX-Improvements: US-TIMER-006"
    },
    {
      "id": "US-397",
      "title": "Start Time Tracker (Modified)",
      "description": "As a user, I want start time tracker (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-001"
    },
    {
      "id": "US-398",
      "title": "Stop Time Tracker (Modified)",
      "description": "As a user, I want stop time tracker (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-002"
    },
    {
      "id": "US-399",
      "title": "start a new timer without losing my current timer's progress",
      "description": "As a user with an active timer running, I want start a new timer without losing my current timer's progress so that I can context-switch between tasks while preserving tracked time",
      "acceptanceCriteria": [
        "Current running timer pauses automatically when new timer starts",
        "Paused timer preserves elapsed time exactly",
        "New timer starts at 0:00:00",
        "Header indicator updates to show new active timer",
        "Toast confirms both actions (new started, old paused)",
        "No confirmation dialog required for auto-pause",
        "Paused timer remains accessible in timer dropdown",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-001"
    },
    {
      "id": "US-400",
      "title": "see all my active and paused timers in one place",
      "description": "As a user with multiple timers, I want see all my active and paused timers in one place so that I can understand my current time tracking state",
      "acceptanceCriteria": [
        "Timer dropdown accessible from header indicator",
        "Active (running) timer always shows first in list",
        "Paused timers show below active timer",
        "Each timer displays work item name (truncated if long)",
        "Each timer displays elapsed time (HH:MM:SS format)",
        "Active timer elapsed time updates in real-time",
        "Paused timer elapsed times are static",
        "Status badge clearly distinguishes running vs paused",
        "Empty state when no timers active: Shows \"No active timers\" message with \"Start Timer\" button",
        "Empty state dropdown stays open to allow starting timer",
        "Dropdown max height: 400px with scroll when content exceeds",
        "Active timer row sticky at top of scrollable area",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-002"
    },
    {
      "id": "US-401",
      "title": "resume a paused timer with one click",
      "description": "As a user with paused timers, I want resume a paused timer with one click so that I can quickly switch back to previous tasks",
      "acceptanceCriteria": [
        "Resume button visible on paused timers",
        "Clicking resume pauses the current active timer",
        "Resumed timer continues from preserved elapsed time (not reset)",
        "Header indicator updates immediately",
        "Timer dropdown reorders to show newly active timer at top",
        "Toast confirms the switch",
        "Only one timer can be running at any time",
        "Resume button shows spinner during operation",
        "Dropdown stays open after resume (allows multiple actions)",
        "On failure, show toast and revert UI state",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-003"
    },
    {
      "id": "US-402",
      "title": "stop a specific timer and save its time entry",
      "description": "As a user with multiple timers, I want stop a specific timer and save its time entry so that I can finalize time for completed tasks while keeping other timers",
      "acceptanceCriteria": [
        "Stop button available on both active and paused timers",
        "Stopping active timer does NOT auto-resume a paused timer",
        "Stop dialog opens with timer's work item, elapsed time, and notes",
        "User can edit notes before saving",
        "Time entry created with correct hours (elapsed time converted)",
        "Stopped timer removed from concurrent list immediately",
        "Other timers unaffected by stopping one",
        "Toast confirms time entry saved",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-004"
    },
    {
      "id": "US-403",
      "title": "discard a timer without creating a time entry",
      "description": "As a user, I want discard a timer without creating a time entry so that I can remove mistakenly started or unnecessary timers",
      "acceptanceCriteria": [
        "Discard button (\u2715) visible on each timer",
        "Confirmation dialog prevents accidental discard",
        "Dialog shows elapsed time that will be lost",
        "Cancel returns to dropdown without changes",
        "Confirming removes timer from list",
        "No time entry created when discarding",
        "Other timers unaffected",
        "Toast confirms discard",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-005"
    },
    {
      "id": "US-404",
      "title": "see a clear message about the limit",
      "description": "As a user trying to start a 6th timer, I want see a clear message about the limit so that I understand why I can't start more timers",
      "acceptanceCriteria": [
        "Maximum of 5 concurrent timers enforced (including active + paused)",
        "Clear error message when limit reached",
        "Error message explains how to resolve (stop or discard)",
        "Timer dropdown opens to help user manage timers",
        "After stopping/discarding a timer, new timer can be started",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-006"
    },
    {
      "id": "US-405",
      "title": "perform quick actions directly from the dropdown",
      "description": "As a user managing multiple timers, I want perform quick actions directly from the dropdown so that I don't have to navigate to a separate view",
      "acceptanceCriteria": [
        "Action buttons visible on each timer row in dropdown",
        "Active timer shows: Stop, Discard",
        "Paused timers show: Resume, Stop, Discard",
        "Buttons have appropriate icons (Play, Square, X)",
        "Buttons have tooltips explaining action",
        "Actions provide immediate feedback (toast, UI update)",
        "Dropdown stays open after action (allows multiple actions)",
        "Clicking outside dropdown closes it",
        "Buttons disabled during loading state (prevents duplicate actions)",
        "On failure, revert UI and show error toast",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-007"
    },
    {
      "id": "US-406",
      "title": "edit notes on paused timers",
      "description": "As a user with paused timers, I want edit notes on paused timers so that I can add context before resuming",
      "acceptanceCriteria": [
        "Edit icon visible on paused timers (optional, can be in dropdown menu)",
        "Notes editable inline or via modal",
        "Notes save automatically with debounce (500ms delay)",
        "Notes preserved when resuming timer",
        "Notes visible in dropdown (truncated if long, max 2 lines)",
        "Notes editing doesn't affect timer state",
        "Save indicator shows when notes are saving",
        "Error handling if save fails (toast, revert to previous notes)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-011"
    },
    {
      "id": "US-407",
      "title": "clear all concurrent timers at once",
      "description": "As a user ending my workday, I want clear all concurrent timers at once so that I can start fresh the next day",
      "acceptanceCriteria": [
        "\"Clear All\" button visible in timer dropdown (when 2+ timers exist)",
        "Confirmation dialog shows total count of timers",
        "\"Save All\" option opens save dialog for each timer sequentially",
        "\"Discard All\" option removes all timers without saving",
        "\"Cancel\" returns without changes",
        "After clearing, dropdown shows empty state",
        "Toast confirms action: \"3 time entries saved\" or \"3 timers discarded\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-008"
    },
    {
      "id": "US-408",
      "title": "see my timers preserved when I return to the app",
      "description": "As a user with paused timers, I want see my timers preserved when I return to the app so that I don't lose tracked time due to browser refresh or closing",
      "acceptanceCriteria": [
        "Running timer continues counting based on server startTime",
        "Paused timers preserve exact elapsed time",
        "Timers persist across browser refresh",
        "Timers persist across tab close/reopen",
        "Timers persist across logout/login (same tenant)",
        "Timer state syncs when multiple browser tabs open",
        "24-hour expiry still applies to running timers",
        "Browser beforeunload warning optional (if active timer running)",
        "Graceful degradation if server unavailable (show cached state)",
        "Sync conflict resolution (server wins, show toast if conflict detected)",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-009"
    },
    {
      "id": "US-409",
      "title": "be warned if I try to start a timer for a work item that already has a paused timer",
      "description": "As a user, I want be warned if I try to start a timer for a work item that already has a paused timer so that I don't create duplicate timers accidentally",
      "acceptanceCriteria": [
        "System detects if work item already has a paused timer",
        "Dialog prompts user with options",
        "Shows elapsed time on existing paused timer",
        "\"Resume Timer\" resumes existing timer",
        "\"Start New\" creates additional timer for same work item",
        "Both options pause the currently running timer",
        "User can have multiple timers for same work item if needed",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-034-Concurrent-Timers: US-CONC-010"
    },
    {
      "id": "US-410",
      "title": "assign multiple clients to a single work item",
      "description": "As a user, I want assign multiple clients to a single work item so that I can track shared work without creating duplicate items",
      "acceptanceCriteria": [
        "Client picker supports multi-select mode (checkboxes next to each option)",
        "Selected clients shown as badges in trigger button",
        "Badge shows client name with X to remove",
        "\"Clear all\" option available when multiple selected",
        "Search filters work with multi-select",
        "At least one client is required (validation error if all removed)",
        "Maximum 50 clients per work item (reasonable limit to prevent abuse)",
        "When 2+ clients selected, \"Time tracking mode\" dropdown appears below client field",
        "Dropdown options: \"Split equally\", \"Full time to each\", \"Ask each time\"",
        "Default selected based on system setting",
        "Help text explains each option on hover/focus",
        "Form saves successfully with multiple clients",
        "Empty state: If no clients exist in system, shows \"No clients found. Create a client first.\" with link (if permissions allow)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-001"
    },
    {
      "id": "US-411",
      "title": "see all clients associated with a work item",
      "description": "As a user, I want see all clients associated with a work item so that I understand which clients this work covers",
      "acceptanceCriteria": [
        "Work item list \"Client\" column shows client names separated by comma",
        "If >2 clients, shows first 2 then \"+N more\" badge",
        "Hovering \"+N more\" shows tooltip with full client list",
        "Work item detail header shows all clients as linked badges",
        "Each client badge links to client detail page",
        "Client badges wrap to multiple lines if needed",
        "Multi-client indicator icon (Users icon) shows next to client section",
        "Filter by client includes work items where client is in `clientIds` array",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-002"
    },
    {
      "id": "US-412",
      "title": "choose how to allocate time across clients when stopping a timer",
      "description": "As a user, I want choose how to allocate time across clients when stopping a timer so that I can bill appropriately for shared work",
      "acceptanceCriteria": [
        "If work item has 1 client, normal stop timer flow (no change)",
        "If work item has 2+ clients, time allocation step appears",
        "Time allocation shows before/within stop timer modal",
        "Shows total elapsed time prominently: \"1h 30m tracked\"",
        "Shows list of clients that will receive entries",
        "Radio buttons for allocation mode: \"Split equally (45m each)\" / \"Full time to each (1h 30m each)\"",
        "Radio shows calculated time for each option",
        "Split allocation rounds to 2 decimal places (0.01 hours = 36 seconds)",
        "Remainder distributed to first client(s) if rounding causes discrepancy",
        "Calculation breakdown shown: \"0.33h each (0.34h for first client to account for rounding)\"",
        "Default selection based on work item's `multiClientTimeMode` setting",
        "If setting is \"ask\", no default selected (user must choose)",
        "\"Remember for this work item\" checkbox saves selection as work item default",
        "Description, role, task type apply to all created entries",
        "Date is same for all entries (from timer)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-003"
    },
    {
      "id": "US-413",
      "title": "manually enter time for a multi-client work item",
      "description": "As a user, I want manually enter time for a multi-client work item so that I can log time I forgot to track",
      "acceptanceCriteria": [
        "Work item selector shows multi-client indicator (Users icon) next to applicable items",
        "After selecting multi-client work item, allocation section appears",
        "Allocation section shows: \"This work item has N clients. How should time be allocated?\"",
        "Radio options: \"Split equally\" / \"Full time to each\"",
        "Shows calculated hours for each option based on entered hours",
        "If hours field is empty, shows \"Enter hours above\" in calculations",
        "Updates calculations as user changes hours",
        "Default selection based on work item's `multiClientTimeMode`",
        "Save creates N time entries with shared `multiClientGroupId`",
        "All entries share description, role, task type, date",
        "Each entry has correct clientId and billing rate",
        "Success toast: \"Created N time entries\"",
        "Entries appear in timesheet immediately",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-004"
    },
    {
      "id": "US-414",
      "title": "see time entries grouped by client on multi-client work items",
      "description": "As a user, I want see time entries grouped by client on multi-client work items so that I understand how time has been allocated",
      "acceptanceCriteria": [
        "Time & Budget tab shows entries for all clients",
        "Summary section shows:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-005"
    },
    {
      "id": "US-415",
      "title": "Configure System Default Multi-Client Mode",
      "description": "As a user, I want configure system default multi-client mode so that I can use this feature.",
      "acceptanceCriteria": [
        "Settings > Time Tracking page has \"Multi-Client Time Tracking\" section",
        "Section header: \"Multi-Client Time Tracking\"",
        "Setting: \"Default allocation mode when creating time entries for multi-client work\"",
        "Dropdown options:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-006"
    },
    {
      "id": "US-416",
      "title": "set a specific time allocation mode for a particular work item",
      "description": "As a user, I want set a specific time allocation mode for a particular work item so that I don't have to choose every time for recurring shared work",
      "acceptanceCriteria": [
        "\"Time tracking mode\" field appears when work item has 2+ clients",
        "Field hidden/disabled when work item has only 1 client",
        "Dropdown options: \"Split equally\", \"Full time to each\", \"Ask each time\"",
        "Default from system setting when creating new work item",
        "Current selection shown when editing existing work item",
        "Help icon with tooltip explaining options",
        "Changing setting auto-saves (or saves with work item)",
        "Setting stored in `workItem.multiClientTimeMode`",
        "Setting respected in stop timer and manual time entry flows",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-007"
    },
    {
      "id": "US-417",
      "title": "edit a group of related time entries together",
      "description": "As a user, I want edit a group of related time entries together so that I can fix mistakes without editing each entry individually",
      "acceptanceCriteria": [
        "Edit icon appears on grouped time entries",
        "When editing grouped entry, prompt asks scope: \"This entry only\" or \"All N related entries\"",
        "\"This entry only\" opens normal edit form for single entry",
        "\"All N related entries\" opens group edit form",
        "Group edit allows changing: description, role, task type, date",
        "Group edit shows warning: \"Hours cannot be changed for group - edit individually\"",
        "Group edit shows list of affected entries with clients and hours",
        "Changes apply to all entries in group atomically",
        "Success toast: \"Updated N time entries\"",
        "Cancel returns to normal view",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-008"
    },
    {
      "id": "US-418",
      "title": "filter my timesheet by a specific client",
      "description": "As a user, I want filter my timesheet by a specific client so that I can see all time for that client including from multi-client work",
      "acceptanceCriteria": [
        "Timesheet filter includes \"Client\" option",
        "Client filter is multi-select (can filter by multiple clients)",
        "Filter shows entries where `clientId` is in selected clients",
        "Entries from multi-client work items appear when their `clientId` matches",
        "Entries show work item name (which may serve multiple clients)",
        "Entries show which client this specific entry is for",
        "Total hours calculated for filtered view",
        "Clear filter shows all entries again",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-009"
    },
    {
      "id": "US-419",
      "title": "understand what happens to time entries when removing a client",
      "description": "As a user editing a work item, I want understand what happens to time entries when removing a client so that I don't accidentally lose data",
      "acceptanceCriteria": [
        "Warning shown when removing client with existing time entries",
        "Warning shows count of affected entries: \"Removing [Client] will not affect N existing time entries\"",
        "Warning explains: \"They will remain linked to this work item\"",
        "Time entries remain unchanged after client removal (no deletion, no modification)",
        "Validation prevents removing last client (error: \"Work item must have at least one client\")",
        "Work item can be saved with fewer clients",
        "Removed client's time entries still visible in Time & Budget tab with indicator",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-010"
    },
    {
      "id": "US-420",
      "title": "see time entries for clients no longer on work item",
      "description": "As a user, I want see time entries for clients no longer on work item so that I understand the full time history",
      "acceptanceCriteria": [
        "Time entries for removed clients still visible in Time & Budget tab",
        "Indicator shows: \"Client removed from work item\" (muted text, small badge)",
        "Entries can still be edited/deleted individually",
        "Summary includes all entries (not just current clients)",
        "Client breakdown shows removed clients separately: \"Removed clients: [Client A]: X hours\"",
        "Filter by client still works (shows entries for removed clients)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-035-Multi-Client-Time-Tracking: US-MCT-011"
    },
    {
      "id": "US-421",
      "title": "Configure Routing Rules (Modified)",
      "description": "As a user, I want configure routing rules (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Create rules via visual rule builder (modal or full-page editor)",
        "Add multiple conditions with AND logic (all must match)",
        "Add multiple actions per rule",
        "Natural language preview updates in real-time",
        "Rules can be ordered by priority (first match wins)",
        "Reorder rules via drag-and-drop (auto-saves on change)",
        "Set default queue for unmatched tickets",
        "Test rules against sample emails before saving",
        "Enable/disable individual rules via toggle",
        "Duplicate existing rules as templates",
        "Delete routing rule with confirmation dialog",
        "Show rule match statistics (count, last matched)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-004"
    },
    {
      "id": "US-422",
      "title": "Add Domain Mapping",
      "description": "As a user, I want add domain mapping so that I can use this feature.",
      "acceptanceCriteria": [
        "Domain input accepts with or without @ prefix (auto-normalizes)",
        "Queue dropdown shows all active queues",
        "Duplicate domain check prevents adding same domain twice",
        "Duplicate shows error: \"Domain @example.com already has a mapping\"",
        "Mapping immediately active after creation",
        "Save button shows loading spinner during creation",
        "Success toast confirms addition",
        "Network errors show toast with retry button",
        "New mapping appears at bottom of domain table",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-001"
    },
    {
      "id": "US-423",
      "title": "View Domain Mappings",
      "description": "As a user, I want view domain mappings so that I can use this feature.",
      "acceptanceCriteria": [
        "Domain mappings displayed in dedicated section above custom rules",
        "Table shows domain and mapped queue name",
        "Edit action opens edit modal (change queue)",
        "Delete action shows confirmation dialog",
        "Empty state shows \"No domain mappings yet\" with add button",
        "Queue name is clickable link to queue settings",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-002"
    },
    {
      "id": "US-424",
      "title": "Create Custom Routing Rule",
      "description": "As a user, I want create custom routing rule so that I can use this feature.",
      "acceptanceCriteria": [
        "Rule name is required",
        "At least one condition is required",
        "At least one action is required (route_to_queue mandatory)",
        "Multiple conditions use AND logic",
        "Case sensitivity toggle available per condition (default: case-insensitive)",
        "Regex operator available in \"Advanced options\" section",
        "Regex pattern validated with error messages",
        "Natural language preview updates in real-time",
        "Preview example: \"If email is from @example.com AND subject contains 'urgent', route to Support queue and set priority to High\"",
        "\"Save Rule\" creates rule in inactive state",
        "\"Save & Activate\" creates rule in active state",
        "Save button shows loading spinner during save",
        "Validation errors shown inline (e.g., \"Queue is required\")",
        "Network errors show toast with retry button",
        "Cancel button closes without saving (confirms if changes made)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-003"
    },
    {
      "id": "US-425",
      "title": "Edit Routing Rule",
      "description": "As a user, I want edit routing rule so that I can use this feature.",
      "acceptanceCriteria": [
        "All current values pre-populated in editor",
        "Same validation as create flow",
        "Can change rule from active to inactive (and vice versa)",
        "Can convert domain mapping to custom rule (adds more conditions)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-004"
    },
    {
      "id": "US-426",
      "title": "Reorder Routing Rules",
      "description": "As a user, I want reorder routing rules so that I can use this feature.",
      "acceptanceCriteria": [
        "Drag handle visible on each rule card",
        "Visual feedback during drag (card lifts, drop zone highlighted)",
        "Order numbers update immediately after drop",
        "Auto-saves without explicit save button",
        "Works for both domain mappings and custom rules",
        "Domain mappings always evaluate before custom rules (separate priority spaces)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-005"
    },
    {
      "id": "US-427",
      "title": "Test Routing Rules",
      "description": "As a user, I want test routing rules so that I can use this feature.",
      "acceptanceCriteria": [
        "Test panel accessible from routing settings page",
        "Input fields: From (email), To (email), Subject, Body, Has Attachments (checkbox)",
        "Email format validation on From/To fields",
        "\"Test\" button evaluates all active rules",
        "\"Test\" button shows loading spinner during evaluation",
        "Results show which rule matched first",
        "Results show all actions that would be applied",
        "Results show case-sensitivity indicators if applicable",
        "Shows rule evaluation order (Rule #1, #2, etc.)",
        "Clear \"No match\" message with default queue fallback",
        "Can test against inactive rules (checkbox: \"Include inactive rules\")",
        "Error handling: Network errors show toast with retry button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-006"
    },
    {
      "id": "US-428",
      "title": "Test Rule from Ticket",
      "description": "As a user, I want test rule from ticket so that I can use this feature.",
      "acceptanceCriteria": [
        "Action available in ticket detail page menu",
        "Pre-fills: sender email, subject, body excerpt, has attachments",
        "Shows which rule matched for this ticket",
        "Highlights if current queue differs from rule result (manual reassignment)",
        "Link to edit the matched rule",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-007"
    },
    {
      "id": "US-429",
      "title": "Enable/Disable Routing Rule",
      "description": "As a user, I want enable/disable routing rule so that I can use this feature.",
      "acceptanceCriteria": [
        "Toggle switch visible on each rule card",
        "Toggle state reflects rule's isActive status",
        "Disabled rules shown with reduced opacity",
        "Disabled rules skip during email routing evaluation",
        "Toggle change auto-saves",
        "Toast confirms state change",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-008"
    },
    {
      "id": "US-430",
      "title": "Duplicate Routing Rule",
      "description": "As a user, I want duplicate routing rule so that I can use this feature.",
      "acceptanceCriteria": [
        "Duplicate option in rule action menu",
        "All conditions and actions copied",
        "Name appended with \" (copy)\"",
        "New rule created as inactive by default",
        "Opens in editor for modification before saving",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-009"
    },
    {
      "id": "US-431",
      "title": "View Rule Statistics",
      "description": "As a user, I want view rule statistics so that I can use this feature.",
      "acceptanceCriteria": [
        "Match count displayed on each rule card",
        "Shows \"Matched X emails (last 30 days)\"",
        "Shows \"Last matched: [relative time]\" (e.g., \"2 hours ago\", \"Never\")",
        "Zero-match rules highlighted subtly (may indicate unused rule)",
        "Clicking stats opens detail view with historical data (future enhancement)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-010"
    },
    {
      "id": "US-432",
      "title": "Quick Rule Templates",
      "description": "As a user, I want quick rule templates so that I can use this feature.",
      "acceptanceCriteria": [
        "Template selection modal shown when creating new rule",
        "Template: \"Route by Domain\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-011"
    },
    {
      "id": "US-433",
      "title": "Delete Routing Rule",
      "description": "As a user, I want delete routing rule so that I can use this feature.",
      "acceptanceCriteria": [
        "Delete action available in rule action menu (\u00b7\u00b7\u00b7) and as button on domain mapping rows",
        "Confirmation dialog shows rule name prominently",
        "Confirmation dialog shows brief rule summary (e.g., \"Routes @example.com to Support queue\")",
        "Delete button text: \"Delete Rule\" (destructive styling)",
        "Cancel button closes dialog without deleting",
        "Success toast appears: \"Rule '[Name]' deleted\" with undo link",
        "Undo restores rule within 5 seconds of deletion",
        "Error handling: If delete fails (network error), show error toast: \"Failed to delete rule. Please try again.\" with retry button",
        "Rule statistics are preserved for audit purposes (not deleted with rule)",
        "After undo timeout (5 seconds), rule cannot be restored",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-012"
    },
    {
      "id": "US-434",
      "title": "View Rule Details",
      "description": "As a user, I want view rule details so that I can use this feature.",
      "acceptanceCriteria": [
        "Detail view accessible by clicking rule name or \"View Details\" menu item",
        "Detail view shows all conditions in readable format:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-013"
    },
    {
      "id": "US-435",
      "title": "Configure Default Queue",
      "description": "As a user, I want configure default queue so that I can use this feature.",
      "acceptanceCriteria": [
        "Default Routing section sticky at bottom of routing settings page",
        "Dropdown shows all active queues (sorted alphabetically)",
        "Current default queue is pre-selected",
        "Save button disabled when no change made (grayed out)",
        "Save button enabled when queue selection changes",
        "Validation: Selected queue must exist and be active",
        "If selected queue becomes inactive after selection, show error: \"Selected queue is no longer active. Please select another queue.\"",
        "Success toast confirms update: \"Default queue updated to [Queue Name]\"",
        "Error handling: If save fails (network error), show error toast: \"Failed to update default queue. Please try again.\" with retry button",
        "Default queue setting persists across page refreshes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-014"
    },
    {
      "id": "US-436",
      "title": "View Rule Conflict Warnings",
      "description": "As a user, I want view rule conflict warnings so that I can use this feature.",
      "acceptanceCriteria": [
        "Conflict check runs on save (not real-time during editing)",
        "Detects shadowed rules (higher priority rule matches all same conditions)",
        "Detects overlapping rules (some conditions overlap)",
        "Detects duplicate conditions (identical conditions to existing rule)",
        "Warning modal shows clear explanation of conflict",
        "\"View Conflicting Rule\" opens conflicting rule in detail view",
        "\"Create Anyway\" saves rule despite conflict",
        "\"Cancel\" returns to editor without saving",
        "Conflicting rules show warning icon (\u26a0\ufe0f) in rules list",
        "Conflict status stored on rule (`hasConflict`, `conflictingRuleIds`)",
        "Conflicts re-evaluated when any rule is edited or reordered",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-015"
    },
    {
      "id": "US-437",
      "title": "Bulk Select Rules",
      "description": "As a user, I want bulk select rules so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Select\" button toggles selection mode on/off",
        "Checkbox appears on each rule card in selection mode",
        "\"Select All\" option in section header selects all rules in that section",
        "\"Deselect All\" clears all selections",
        "Selection count shown in bulk action bar",
        "Bulk action bar appears when 1+ rules selected",
        "Selection persists while navigating within routing settings page",
        "Clicking outside selection mode or \"Cancel\" exits selection mode",
        "Selection mode works for both Domain Routing and Custom Rules sections",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-016"
    },
    {
      "id": "US-438",
      "title": "Bulk Enable/Disable Rules",
      "description": "As a user, I want bulk enable/disable rules so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Enable\" button visible when 1+ rules selected",
        "\"Disable\" button visible when 1+ rules selected",
        "Loading state on buttons during operation",
        "Optimistic update: rules visually update immediately",
        "Rollback on failure: rules revert if operation fails",
        "Success toast shows count of affected rules",
        "Error toast if operation fails: \"Failed to enable rules. Please try again.\"",
        "Selection mode exits after successful operation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 18,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-017"
    },
    {
      "id": "US-439",
      "title": "Bulk Delete Rules",
      "description": "As a user, I want bulk delete rules so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Delete\" button visible when 1+ rules selected",
        "Confirmation dialog required before bulk delete",
        "Dialog shows list of rule names being deleted",
        "Dialog shows warning: \"This action cannot be undone.\"",
        "\"Delete Rules\" button has destructive styling",
        "Loading state during deletion",
        "Success toast with undo option (5 seconds)",
        "Undo restores all deleted rules",
        "Selection mode exits after successful operation",
        "Change log entries created for each deleted rule",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 19,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-018"
    },
    {
      "id": "US-440",
      "title": "View Rule Change History",
      "description": "As a user, I want view rule change history so that I can use this feature.",
      "acceptanceCriteria": [
        "History tab visible in rule detail view",
        "Changes sorted newest-first",
        "Each entry shows: relative timestamp, user name, change type",
        "Change types: Created, Updated, Deleted, Enabled, Disabled, Reordered",
        "\"View Details\" expands entry to show before/after values",
        "Grouped by date (Today, Yesterday, older dates)",
        "Loading state while history loads",
        "Empty state if no history (new rule): \"No changes recorded yet\"",
        "History retained for 90 days",
        "Pagination or infinite scroll for rules with many changes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 20,
      "passes": true,
      "notes": "CHANGE-036-Advanced-Queue-Routing: US-ROUTE-019"
    },
    {
      "id": "US-441",
      "title": "Type @ to Trigger Autocomplete",
      "description": "As a user, I want type @ to trigger autocomplete so that I can use this feature.",
      "acceptanceCriteria": [
        "Typing `@` triggers autocomplete dropdown immediately (< 100ms)",
        "Dropdown appears positioned below the `@` character in the text",
        "Dropdown shows up to 8 users initially (most relevant or alphabetical)",
        "Each user row shows: Avatar (initials), Full name, Email address",
        "Avatar uses consistent color derivation from user name",
        "Dropdown has subtle shadow and border (matches design system)",
        "Dropdown does not obscure the text being typed",
        "Works in both \"Public Reply\" and \"Internal Note\" modes",
        "Works in both preview pane editor and tab/full-page editor",
        "If user list fetch fails, show error message in dropdown: \"Failed to load users\"",
        "Error state shows \"Retry\" button to refetch users",
        "Dropdown stays open on error (doesn't auto-dismiss)",
        "Retry button refetches user list",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-001"
    },
    {
      "id": "US-442",
      "title": "Filter Users While Typing",
      "description": "As a user, I want filter users while typing so that I can use this feature.",
      "acceptanceCriteria": [
        "Filtering happens instantly as user types (debounce < 50ms)",
        "Filters match against: first name, last name, full name, email",
        "Matching is case-insensitive",
        "Matching portion of text is highlighted (bold or background highlight)",
        "If no matches, show empty state with centered message",
        "Empty state shows: \"No users found matching '[query]'\" with search icon",
        "Empty state suggests: \"Try a different search term or clear the filter\"",
        "Empty state remains visible (dropdown doesn't auto-dismiss)",
        "Maximum query length: 50 characters (truncate silently)",
        "Special characters in query are handled gracefully (no regex errors)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-002"
    },
    {
      "id": "US-443",
      "title": "Navigate and Select with Keyboard",
      "description": "As a user, I want navigate and select with keyboard so that I can use this feature.",
      "acceptanceCriteria": [
        "`\u2193` (Down arrow) moves highlight to next user",
        "`\u2191` (Up arrow) moves highlight to previous user",
        "Navigation wraps around (last \u2192 first, first \u2192 last)",
        "`Enter` selects currently highlighted user",
        "`Tab` selects currently highlighted user (alternative to Enter)",
        "`Escape` closes dropdown without selecting",
        "Clicking outside dropdown closes it without selecting",
        "First user is highlighted by default when dropdown opens",
        "Highlighted row has distinct background color (bg-accent)",
        "Scrolls highlighted item into view if list is scrollable",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-003"
    },
    {
      "id": "US-444",
      "title": "Select User with Click",
      "description": "As a user, I want select user with click so that I can use this feature.",
      "acceptanceCriteria": [
        "Clicking user row selects that user",
        "Hover state shows on mouse over (subtle background change)",
        "Click immediately inserts mention and closes dropdown",
        "Cursor continues at correct position after mention",
        "Double-click doesn't cause issues (same behavior as single click)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-004"
    },
    {
      "id": "US-445",
      "title": "Mention Inserted as Styled Badge",
      "description": "As a user, I want mention inserted as styled badge so that I can use this feature.",
      "acceptanceCriteria": [
        "Selected mention appears as inline badge/chip in editor",
        "Badge shows user's name (e.g., \"@Jane Smith\")",
        "Badge has distinct styling: background color (bg-primary/10), rounded corners, different text color (text-primary)",
        "Badge is non-editable (single unit - backspace deletes entire mention)",
        "Backspace at start of badge deletes the entire mention",
        "Cursor can be positioned before or after badge (not inside)",
        "User can click on mention badge to remove it (shows delete icon on hover)",
        "Clicking delete icon removes mention badge and updates `mentions[]` array",
        "Multiple mentions can be inserted in same message",
        "Mentioning the same user multiple times is allowed (each creates separate mention)",
        "Badge persists when switching between Reply and Note modes (if draft preserved)",
        "Mention user ID is captured when badge is inserted (for `mentions[]` array)",
        "If user types text in the middle of a mention, mention badge is split or text is inserted after badge (behavior: insert text after badge, don't allow typing inside)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-005"
    },
    {
      "id": "US-446",
      "title": "View Mentions in Sent Messages",
      "description": "As a user, I want view mentions in sent messages so that I can use this feature.",
      "acceptanceCriteria": [
        "Mentions in sent messages are visually distinct (blue text or badge style)",
        "Mentions display user's name, not user ID",
        "Mentions are clickable (cursor: pointer)",
        "Clicking mention opens user popover",
        "If mentioned user no longer exists, show name with \"(Deactivated)\" suffix",
        "Mentions are consistent in both internal notes and public replies",
        "Mentions in the thread are rendered consistently across all messages",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-006"
    },
    {
      "id": "US-447",
      "title": "View User Popover on Mention Click",
      "description": "As a user, I want view user popover on mention click so that I can use this feature.",
      "acceptanceCriteria": [
        "Popover appears positioned near clicked mention (above or below)",
        "Popover shows: Large avatar (initials), Full name, Email, Job title (if available)",
        "Email is clickable (mailto: link)",
        "Popover has close button (X) and closes on click outside",
        "Popover closes on Escape key",
        "Popover does not obscure the mention itself",
        "Loading state shows skeleton loader (avatar placeholder + 2-3 text lines) if user data needs to be fetched",
        "Loading spinner shown if fetch takes >500ms",
        "Error state if user not found: \"User not found\" with retry button",
        "Retry button refetches user data",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-007"
    },
    {
      "id": "US-448",
      "title": "Receive In-App Notification When Mentioned",
      "description": "As a user, I want receive in-app notification when mentioned so that I can use this feature.",
      "acceptanceCriteria": [
        "In-app notification created for each mentioned user",
        "Notification appears in notification bell/center",
        "Notification title: \"You were mentioned in [Ticket Subject]\"",
        "Notification body: Message preview (first ~100 characters)",
        "Notification shows who mentioned them: \"by [Mentioner Name]\"",
        "Notification includes timestamp",
        "Clicking notification navigates to ticket detail page",
        "Clicking scrolls to/highlights the specific message (if possible)",
        "Notification badge count updates immediately",
        "Duplicate mentions in same message = single notification",
        "User cannot receive notification for mentioning themselves",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-008"
    },
    {
      "id": "US-449",
      "title": "Receive Email Notification When Mentioned",
      "description": "As a user, I want receive email notification when mentioned so that I can use this feature.",
      "acceptanceCriteria": [
        "Email notification sent only if user has mentions enabled in preferences",
        "Email subject: \"You were mentioned in [Ticket Subject]\"",
        "Email body includes: Who mentioned them, Ticket subject, Message preview, Link to ticket",
        "Email link opens ticket detail page (deep link)",
        "Email uses consistent email template styling",
        "Email is sent asynchronously (doesn't block message send)",
        "Email respects \"Do Not Disturb\" settings if configured",
        "No email if user is already viewing the ticket (optional optimization)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-009"
    },
    {
      "id": "US-450",
      "title": "Configure Mention Notification Preferences",
      "description": "As a user, I want configure mention notification preferences so that I can use this feature.",
      "acceptanceCriteria": [
        "\"Mentions\" appears as notification category in settings",
        "Toggle for in-app notifications (default: enabled)",
        "Toggle for email notifications (default: enabled)",
        "Settings persist across sessions",
        "Changes apply immediately (no page refresh needed)",
        "Settings UI matches existing notification preference patterns",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-010"
    },
    {
      "id": "US-451",
      "title": "Remove Mention from Draft Message",
      "description": "As a user, I want remove mention from draft message so that I can use this feature.",
      "acceptanceCriteria": [
        "Clicking mention badge shows delete icon/option on hover",
        "Clicking delete icon removes mention badge",
        "Backspace at start of badge removes entire badge",
        "Mention user ID removed from `mentions[]` array when badge deleted",
        "Cursor positioned correctly after badge removal",
        "Multiple mentions can be removed independently",
        "Works in both Reply and Note modes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-011"
    },
    {
      "id": "US-452",
      "title": "Dismiss Mention Notification",
      "description": "As a user, I want dismiss mention notification so that I can use this feature.",
      "acceptanceCriteria": [
        "Clicking notification marks it as read",
        "\"Mark all as read\" option available in notification center",
        "Dismissed notifications removed from unread count badge",
        "Notification history preserved (can view dismissed notifications in \"All\" view)",
        "Notification badge count updates immediately after dismissal",
        "Bulk dismiss: Select multiple notifications and mark all as read",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-012"
    },
    {
      "id": "US-453",
      "title": "Fix Reply/Note Input Border Styling",
      "description": "As a user, I want fix reply/note input border styling so that I can use this feature.",
      "acceptanceCriteria": [
        "Input container has clean border that doesn't extend outside parent container",
        "Focus state shows consistent ring/border (ring-2 ring-primary or similar)",
        "Border styling identical between \"Public Reply\" and \"Internal Note\" modes",
        "Toggle between modes doesn't cause border flickering or layout shift",
        "Border radius consistent (matches design system, e.g., rounded-lg)",
        "Padding inside input consistent (e.g., p-4)",
        "Border color matches design system (border-input, border-primary on focus)",
        "No layout shift when clicking into/out of input",
        "Works correctly in both preview pane and full-page/tab views",
        "Input area scrolls independently if content exceeds viewport height",
        "Mention badges remain inline during scroll",
        "Autocomplete dropdown positioned relative to cursor position, not input container",
        "Long messages with mentions scroll smoothly without breaking badge layout",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-037-User-Tagging-Mentions: US-MENTION-013"
    },
    {
      "id": "US-454",
      "title": "access my personal profile settings from anywhere in the app",
      "description": "As a user, I want access my personal profile settings from anywhere in the app so that I can customize my experience without needing admin permissions",
      "acceptanceCriteria": [
        "Profile Settings option visible in user dropdown menu",
        "Accessible via direct URL `/settings/my-settings`",
        "No admin permissions required to access",
        "Page loads with Profile tab selected by default",
        "Tabs: Profile, Email Signature, Notifications, Display",
        "Tabs are sticky at top of content area (don't scroll with content)",
        "Content area scrolls independently below tabs",
        "Each tab content loads without page refresh",
        "Back button or breadcrumb returns to previous location",
        "Loading state shows skeleton loaders for each section while fetching settings",
        "Form field skeletons for Profile tab",
        "Toggle row skeletons for Notifications tab",
        "Editor/preview skeletons for Signature tab",
        "Mobile responsive layout (tabs collapse to dropdown on mobile)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-001"
    },
    {
      "id": "US-455",
      "title": "edit my profile information (name, title, phone)",
      "description": "As a user, I want edit my profile information (name, title, phone) so that my colleagues see accurate information about me",
      "acceptanceCriteria": [
        "Form pre-filled with current values",
        "Name field is required (show error if empty)",
        "Title and phone are optional",
        "Email shown but not editable (read-only with explanation)",
        "Avatar displayed with link/note about changing via Clerk",
        "Phone validates format (optional but must be valid if provided)",
        "Save button disabled until changes are made",
        "Save button shows loading state while saving",
        "Success toast on save",
        "Error handling with specific messages",
        "Cancel/Reset button reverts to saved values",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-002"
    },
    {
      "id": "US-456",
      "title": "create an email signature",
      "description": "As a user, I want create an email signature so that my ticket replies include professional contact information",
      "acceptanceCriteria": [
        "Empty state shows \"No email signature\" with Create button",
        "Empty state includes signature icon/illustration",
        "Empty state help text: \"Signatures are automatically added to ticket replies\"",
        "Rich text editor supports: Bold, Italic, Links, Images, Font size",
        "Editor provides starter templates (Simple, Professional, With Logo)",
        "Template selector inserts template into editor",
        "Live preview panel shows signature as it will appear in emails",
        "Preview updates in real-time as user types",
        "\"Enable signature\" toggle (default: enabled for new signatures)",
        "Image upload for logo (max 500KB, jpg/png/gif)",
        "Images hosted and served via proper URLs",
        "Plain text version auto-generated from HTML",
        "Character counter shows \"X / 5000 characters\" (updates in real-time)",
        "Save button disabled if signature exceeds 5000 characters",
        "Inline error shown if exceeds limit: \"Signature exceeds maximum length\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-003"
    },
    {
      "id": "US-457",
      "title": "edit my existing email signature",
      "description": "As a user, I want edit my existing email signature so that I can keep my contact information current",
      "acceptanceCriteria": [
        "Edit button visible on existing signature card",
        "Editor pre-populated with current signature HTML",
        "All rich text features available",
        "Live preview shows changes in real-time",
        "Save button saves changes",
        "Cancel button discards changes",
        "Changes don't affect already-sent emails",
        "Success toast on save",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-004"
    },
    {
      "id": "US-458",
      "title": "enable or disable my email signature",
      "description": "As a user, I want enable or disable my email signature so that I can control when it's automatically appended",
      "acceptanceCriteria": [
        "Toggle switch clearly visible on signature card",
        "Toggle state reflects current setting",
        "Change saves immediately (no Save button needed)",
        "Toast confirms the change",
        "When disabled, signature not appended to new replies",
        "When enabled, signature auto-appends to all new ticket replies",
        "Toggle state persists across sessions",
        "Works without page refresh",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-005"
    },
    {
      "id": "US-459",
      "title": "see how my signature will look in an actual email",
      "description": "As a user, I want see how my signature will look in an actual email so that I can ensure it's formatted correctly",
      "acceptanceCriteria": [
        "Preview panel visible alongside editor",
        "Preview shows signature in realistic email context",
        "Preview shows separator line before signature (e.g., \"\u2014\" or \"----\")",
        "Preview uses same styling as actual sent emails",
        "Preview updates in real-time (< 500ms delay)",
        "Preview shows both desktop and mobile rendering (optional toggle)",
        "Preview distinguishes signature from email body clearly",
        "Images render correctly in preview",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-006"
    },
    {
      "id": "US-460",
      "title": "have my signature automatically added to ticket replies",
      "description": "As a user, I want have my signature automatically added to ticket replies so that I don't need to manually add it every time",
      "acceptanceCriteria": [
        "Signature appended after separator line (e.g., \"\u2014\")",
        "Signature only appended if enabled in settings",
        "Signature appended to public replies (not internal notes)",
        "Signature appears in HTML emails with formatting preserved",
        "Signature appears in plain text emails with text version",
        "Signature not shown in reply composer by default (appended on send)",
        "Optional: \"Show signature preview\" toggle in reply composer (future enhancement)",
        "Signature not duplicated if user manually adds one",
        "Signature uses current saved version (not cached)",
        "Signature appending happens server-side when creating message",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-007"
    },
    {
      "id": "US-461",
      "title": "configure which email notifications I receive",
      "description": "As a user, I want configure which email notifications I receive so that I only get emails about things that matter to me",
      "acceptanceCriteria": [
        "All notification types listed with clear labels",
        "Each type has toggle switch for email notifications",
        "Toggles show current state",
        "Changes save automatically (auto-save on toggle)",
        "Subtle confirmation (toast or inline checkmark)",
        "Default state: all enabled for new users",
        "Settings persist across sessions",
        "Description text for each notification type",
        "Grouped by category (Tickets, Work Items, Digest)",
        "\"Reset to Defaults\" button available",
        "Reset shows confirmation dialog: \"Reset all notification preferences to defaults?\"",
        "Reset restores all toggles to enabled, frequency to \"immediate\", quiet hours disabled",
        "Success toast: \"Preferences reset to defaults\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-008"
    },
    {
      "id": "US-462",
      "title": "configure which in-app notifications I receive",
      "description": "As a user, I want configure which in-app notifications I receive so that I'm not overwhelmed by notification badges",
      "acceptanceCriteria": [
        "Separate toggles for in-app vs email notifications",
        "All relevant notification types listed",
        "Changes save automatically",
        "Default state: all enabled for new users",
        "Clearly separated from email notification settings",
        "Visual distinction between in-app and email columns",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-009"
    },
    {
      "id": "US-463",
      "title": "choose how often I receive email notifications",
      "description": "As a user, I want choose how often I receive email notifications so that I can batch notifications and reduce interruptions",
      "acceptanceCriteria": [
        "Frequency dropdown with three options",
        "Current selection shown",
        "Change saves immediately",
        "Digest emails combine multiple notifications",
        "Digest sent at consistent time (hourly: on the hour, daily: 8am user's timezone)",
        "If no notifications in period, no digest sent",
        "Setting applies to all email notification types",
        "Exception: Urgent/SLA notifications always immediate (configurable)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-010"
    },
    {
      "id": "US-464",
      "title": "set quiet hours when I don't receive notifications",
      "description": "As a user, I want set quiet hours when I don't receive notifications so that I'm not disturbed outside working hours",
      "acceptanceCriteria": [
        "Quiet hours toggle (default: disabled)",
        "Start and end time pickers (30-minute increments)",
        "Timezone dropdown (defaults to display preferences timezone)",
        "Preview text: \"Notifications paused from 6:00 PM to 8:00 AM EST\"",
        "During quiet hours: no email notifications sent",
        "During quiet hours: in-app notifications still created but no push/sound",
        "Notifications during quiet hours delivered when quiet hours end (for emails)",
        "OR notifications during quiet hours included in next digest",
        "Settings save automatically",
        "Validation: start time must be different from end time",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-011"
    },
    {
      "id": "US-465",
      "title": "choose between light, dark, or system theme",
      "description": "As a user, I want choose between light, dark, or system theme so that the interface matches my preference and reduces eye strain",
      "acceptanceCriteria": [
        "Three theme options: Light, Dark, System",
        "Visual preview/icon for each option",
        "Current selection highlighted",
        "Theme changes immediately on selection",
        "\"System\" follows OS/browser preference",
        "System preference changes are detected and applied",
        "Theme persists across sessions and syncs across devices (stored per-user account)",
        "Theme stored in backend (DisplayPreferences) for cross-device sync",
        "Local storage used for immediate load (prevents flash)",
        "No page refresh required",
        "All components respect theme (no hardcoded colors)",
        "Smooth transition animation between themes (150ms)",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-012"
    },
    {
      "id": "US-466",
      "title": "set my default views for different modules",
      "description": "As a user, I want set my default views for different modules so that the app opens to my preferred layout",
      "acceptanceCriteria": [
        "Dropdown for each view type",
        "Work Items: List, Kanban, Table options",
        "Tickets: List Only, Preview Pane options",
        "Time Periods: Day, Week, Month options",
        "Current selection shown",
        "Changes apply to next page load (or immediately if possible)",
        "Settings persist across sessions",
        "Defaults used when navigating to module without explicit view selection",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-013"
    },
    {
      "id": "US-467",
      "title": "set my timezone and date/time format preferences",
      "description": "As a user, I want set my timezone and date/time format preferences so that dates and times display correctly for my location",
      "acceptanceCriteria": [
        "Timezone dropdown with search (shows current time in each zone)",
        "Timezone defaults to browser's detected timezone",
        "Timezone shows UTC offset (e.g., \"America/New_York (UTC-5)\")",
        "Date format dropdown with preview of today's date",
        "Time format dropdown with preview of current time",
        "Week starts on dropdown (affects calendar views)",
        "Changes apply immediately where possible",
        "All timestamps in app respect user's timezone (user sees their own timezone)",
        "Other users' activity timestamps shown in viewer's timezone (not activity creator's timezone)",
        "All date displays respect user's format preference",
        "Settings persist across sessions",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-014"
    },
    {
      "id": "US-468",
      "title": "understand the difference between admin and personal settings",
      "description": "As a user, I want understand the difference between admin and personal settings so that I know where to find different configuration options",
      "acceptanceCriteria": [
        "Clear visual separation between My Settings and Workspace Settings",
        "\"My Settings\" always visible regardless of role",
        "\"Workspace Settings\" only visible to users with admin permissions",
        "Labels clearly indicate scope (personal vs workspace/tenant)",
        "Breadcrumb reflects current section",
        "URL structure reflects separation:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-015"
    },
    {
      "id": "US-469",
      "title": "see a preview of my signature on the Email Signature tab",
      "description": "As a user, I want see a preview of my signature on the Email Signature tab so that I can verify how it will appear in emails without editing",
      "acceptanceCriteria": [
        "Signature preview shown on Email Signature tab when signature exists",
        "Preview shows signature in email context (with sample message above)",
        "Preview shows separator line before signature",
        "Preview displays HTML formatting correctly",
        "Enabled/disabled status clearly shown",
        "Preview updates in real-time while editing (if editor open)",
        "Preview shows both HTML and plain text versions (toggle or tabs)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-017"
    },
    {
      "id": "US-470",
      "title": "delete my email signature",
      "description": "As a user, I want delete my email signature so that I can remove it if I no longer want one",
      "acceptanceCriteria": [
        "Delete button/icon visible on signature card",
        "Confirmation dialog before deletion",
        "Deleting removes signature from all future replies",
        "Does not affect already-sent emails",
        "Success toast after deletion",
        "Returns to empty state with \"Create Signature\" option",
        "Error handling if deletion fails",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "CHANGE-038-Profile-Settings-Signatures: US-PROFILE-016"
    },
    {
      "id": "US-471",
      "title": "connect my Google or Microsoft calendar",
      "description": "As a user, I want connect my Google or Microsoft calendar so that I can see my schedule and join meetings from within the app",
      "acceptanceCriteria": [
        "\"Connect Calendar\" button visible in Settings \u2192 Integrations",
        "Support for Google Calendar via OAuth 2.0",
        "Support for Microsoft Outlook/Office 365 via OAuth 2.0",
        "OAuth consent screen requests calendar read permissions",
        "OAuth tokens stored securely (encrypted at rest)",
        "Initial sync begins automatically after connection",
        "Sync progress indicator shows during initial sync",
        "Success toast shows when calendar connected",
        "Error handling for OAuth failures with retry option",
        "Only one calendar can be connected per user (for v1)",
        "Calendar permissions requested: read-only (not write)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-001"
    },
    {
      "id": "US-472",
      "title": "see my calendar in day view",
      "description": "As a user, I want see my calendar in day view so that I can see today's schedule in detail",
      "acceptanceCriteria": [
        "Day view shows 24 hours (or configurable working hours)",
        "Current time indicator (red line) shows present time",
        "Events display as colored blocks in time slots",
        "Overlapping events shown side-by-side (max 3, then \"+N more\")",
        "All-day events shown at top of view",
        "Navigation: Previous day / Today / Next day buttons",
        "Date picker to jump to specific date",
        "**Events with meeting links show \"Join\" button prominently**",
        "Clicking event opens event detail panel",
        "Header with date/navigation is sticky (doesn't scroll)",
        "Time slots scroll vertically independently",
        "Empty days show subtle \"No events\" message or remain blank",
        "Empty state for entire view: \"No events this day\" with calendar icon",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-005"
    },
    {
      "id": "US-473",
      "title": "see a prominent \"Join\" button on calendar events with video meetings",
      "description": "As a user, I want see a prominent \"Join\" button on calendar events with video meetings so that I can join meetings with one click",
      "acceptanceCriteria": [
        "Events with meeting links show video camera icon in calendar views",
        "Event detail shows meeting provider icon (Zoom, Teams, Google Meet, Webex)",
        "**\"Join Meeting\" button is large, primary-styled, positioned prominently**",
        "Button shows provider name: \"Join Zoom Meeting\", \"Join Teams Meeting\", etc.",
        "Clicking button opens meeting link in new tab",
        "Button opens immediately (no loading delay)",
        "Meeting link works correctly for all supported platforms",
        "If meeting hasn't started, show \"Meeting starts in X minutes\" but still allow join",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-008"
    },
    {
      "id": "US-474",
      "title": "see full details of a calendar event",
      "description": "As a user, I want see full details of a calendar event so that I understand the meeting context before joining",
      "acceptanceCriteria": [
        "Event detail opens as slide-over panel (right side)",
        "Panel shows:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-014"
    },
    {
      "id": "US-475",
      "title": "manually trigger a calendar sync",
      "description": "As a user  \n**I want** my calendar to sync automatically  \n**So that** new events appear without manual action\n\n**Acceptance Criteria:**\n- [ ] Calendar syncs automatically on interval (every 5 minutes - configurable in future)\n- [ ] Sync uses incremental updates when possible (syncToken/deltaLink)\n-",
      "acceptanceCriteria": [
        "Calendar syncs automatically on interval (every 5 minutes - configurable in future)",
        "Sync uses incremental updates when possible (syncToken/deltaLink)",
        "Full sync on first connection and after errors",
        "Sync respects lookback/lookahead configuration (see US-PEC-023)",
        "Events updated if changed in source calendar",
        "Events deleted if removed from source calendar",
        "Cancelled events marked as cancelled (not deleted) for history",
        "Sync runs in background (no UI blocking)",
        "If sync fails due to expired token, show \"Connection expired\" status",
        "Sync disabled when connection expired (until reconnected)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-017"
    },
    {
      "id": "US-476",
      "title": "receive a notification before meetings start",
      "description": "As a user, I want receive a notification before meetings start so that I don't miss or run late to meetings",
      "acceptanceCriteria": [
        "Notification appears X minutes before meeting (configurable in preferences)",
        "Default notification time: 10 minutes before",
        "Notification shows:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-019"
    },
    {
      "id": "US-477",
      "title": "view my personal emails in the tickets interface",
      "description": "As a user, I want view my personal emails in the tickets interface so that I can manage all communications in one place",
      "acceptanceCriteria": [
        "\"Personal\" section appears in tickets sidebar after inbox connected",
        "Personal section shows unread count badge",
        "Clicking \"Personal\" shows personal emails as tickets",
        "Personal emails use same ticket list UI as ticketing queues",
        "Personal emails are only visible to owning user (not shared)",
        "Personal emails appear in ticket detail view with full conversation",
        "Reply to personal email sends from personal email address",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-039-Personal-Email-Calendar: US-PEC-021"
    },
    {
      "id": "US-478",
      "title": "Connect Email Inbox (Modified)",
      "description": "As a user, I want connect email inbox (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-001"
    },
    {
      "id": "US-479",
      "title": "Manage Connected Inboxes (Modified)",
      "description": "As a user, I want manage connected inboxes (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-002"
    },
    {
      "id": "US-480",
      "title": "Reply to Ticket (Modified)",
      "description": "As a user, I want reply to ticket (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-013"
    },
    {
      "id": "US-481",
      "title": "Receive Real-Time Email Notifications",
      "description": "As a user, I want receive real-time email notifications so that I can use this feature.",
      "acceptanceCriteria": [
        "New email notification appears within 10 seconds of email receipt",
        "In-app notification shows: sender name, subject preview, timestamp",
        "Clicking notification navigates to ticket",
        "Notification badge count updates in real-time",
        "Multiple emails in quick succession are grouped (max 3, then \"X more\")",
        "If >10 notifications within 5 seconds, show single batched notification: \"X new emails received\" with expandable list",
        "Notifications respect user's queue memberships (only notify for relevant queues)",
        "Notifications respect user's assigned tickets (option to only notify if assigned)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-001"
    },
    {
      "id": "US-482",
      "title": "Configure Email Notification Preferences",
      "description": "As a user, I want configure email notification preferences so that I can use this feature.",
      "acceptanceCriteria": [
        "Settings page includes \"Email Notifications\" section",
        "First-time users see default preferences (in-app: on, browser push: off, sound: off, all inboxes: on)",
        "Empty state: If no preferences exist, defaults are shown and auto-saved on first access",
        "Toggle for in-app notifications (default: on)",
        "Toggle for browser push notifications (default: off)",
        "Browser push requires user permission (show request dialog)",
        "Toggle for sound notifications (default: off)",
        "Sound preview button plays notification sound",
        "Inbox filter: checkboxes for each connected inbox",
        "Toggle for \"Only notify for assigned tickets\"",
        "Toggle for \"Only notify for my queues\"",
        "Quiet hours: start time, end time, timezone",
        "Settings persist across sessions",
        "Changes apply immediately (no page refresh)",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-002"
    },
    {
      "id": "US-483",
      "title": "View Inbox Sync Status",
      "description": "As a user, I want view inbox sync status so that I can use this feature.",
      "acceptanceCriteria": [
        "Each inbox shows health indicator: green (healthy), yellow (degraded), red (unhealthy)",
        "Healthy: Webhook active, emails arriving within 30 seconds",
        "Degraded: Webhook issues, falling back to polling, or latency > 2 minutes",
        "Unhealthy: No emails syncing, auth expired, or repeated failures",
        "Inbox detail shows:",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-003"
    },
    {
      "id": "US-484",
      "title": "automatically fall back to polling when webhooks fail",
      "description": "As a system, I want automatically fall back to polling when webhooks fail so that email sync continues even when real-time delivery fails",
      "acceptanceCriteria": [
        "Single webhook failure does not disable webhook mode",
        "3 consecutive failures triggers polling fallback",
        "Polling interval: 60 seconds during fallback",
        "Background job attempts webhook re-registration every 15 minutes",
        "When webhook re-established, polling disabled",
        "Admin notification when mode changes (in-app)",
        "After 24 hours of failed re-registration, persistent notification shown",
        "Persistent notification includes \"Reconnect\" action button",
        "OAuth refresh failure detected and handled gracefully",
        "Auth expiration shows clear error with manual recovery path",
        "Sync health status updates in real-time",
        "All webhook failures logged for debugging",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-004"
    },
    {
      "id": "US-485",
      "title": "View Send Status for Outgoing Emails",
      "description": "As a user, I want view send status for outgoing emails so that I can use this feature.",
      "acceptanceCriteria": [
        "Send button shows spinner during send attempt",
        "Send button disabled during send attempt",
        "Success: Toast notification \"Reply sent\"",
        "Success: Message shows sent timestamp and \"Sent\" indicator",
        "Failure: Error toast with specific message (not generic)",
        "Failure: Message shows error state (red indicator, error icon)",
        "Failure: \"Retry\" button on failed message",
        "Retry attempts up to 3 times automatically on transient errors",
        "Permanent failures (invalid recipient, auth expired) show specific guidance",
        "All send attempts logged for audit",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-005"
    },
    {
      "id": "US-486",
      "title": "Retry Failed Email Sends",
      "description": "As a user, I want retry failed email sends so that I can use this feature.",
      "acceptanceCriteria": [
        "Retry button visible on failed messages",
        "Retry shows spinner during attempt",
        "Retry count incremented (shows \"Attempt 2 of 3\", etc.)",
        "After max retries, show \"Send failed permanently\" with support option",
        "Retries respect rate limits (don't hammer the API)",
        "User can edit message before retry (opens editor with content)",
        "\"Cancel\" option removes failed message from thread (with confirmation)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-006"
    },
    {
      "id": "US-487",
      "title": "Enable Browser Push Notifications",
      "description": "As a user, I want enable browser push notifications so that I can use this feature.",
      "acceptanceCriteria": [
        "Toggle triggers browser permission request",
        "Permission denied: Show inline message explaining how to enable in browser settings with link to browser-specific instructions",
        "Permission denied state persists until user grants permission or dismisses message",
        "Permission granted: Subscription registered with backend",
        "Push notifications show: sender name, subject preview, app icon",
        "Clicking push notification opens app and navigates to ticket",
        "Push notifications respect quiet hours",
        "Push notifications respect inbox/assignment filters",
        "Push subscription survives page refresh",
        "Re-request permission if subscription expires",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-007"
    },
    {
      "id": "US-488",
      "title": "remove failed or disconnected webhook subscriptions",
      "description": "As a system administrator, I want remove failed or disconnected webhook subscriptions so that the system doesn't maintain stale records and provider resources are cleaned up",
      "acceptanceCriteria": [
        "Subscription cancelled with provider API before database deletion",
        "Gmail watch stopped via API call",
        "Outlook subscription deleted via Graph API",
        "Database record deleted from webhookSubscriptions table",
        "ConnectedInbox updated to remove webhookSubscriptionId reference",
        "Sync mode updated to \"polling\" if inbox remains connected",
        "No orphaned records remain in database",
        "Success toast: \"Webhook subscription removed\"",
        "If provider cancellation fails, database record still deleted (prevents orphaned records)",
        "Error logged if provider cancellation fails (for debugging)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-040-Real-Time-Email-Sync: US-RTS-008"
    },
    {
      "id": "US-489",
      "title": "Reply to Ticket (Modified)",
      "description": "As a user, I want reply to ticket (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-013"
    },
    {
      "id": "US-490",
      "title": "Link Ticket to Work Item (Related)",
      "description": "As a user, I want link ticket to work item (related) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-018"
    },
    {
      "id": "US-491",
      "title": "forward an email message as an attachment",
      "description": "As a team member, I want forward an email message as an attachment so that I can prove to clients or colleagues that the original email was sent with its original headers",
      "acceptanceCriteria": [
        "\"Forward as Attachment\" action appears in message action menu (\u22ee)",
        "Action is available on all message types (inbound, outbound, manual)",
        "Compose modal opens pre-populated with attachment reference",
        "Recipients field supports autocomplete from contacts",
        "Subject is pre-filled as \"Fwd: [Original Subject]\"",
        "Cover message body is optional (can send with just attachment)",
        "Attachment preview shows original email subject and date",
        "Cannot remove the message attachment from this flow (use regular compose for that)",
        "Send button is disabled until at least one recipient is entered",
        "Loading state shows while .eml file is generated",
        "Success toast confirms email was sent",
        "New message appears in ticket thread immediately",
        ".eml file is stored in Convex storage for audit trail",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-001"
    },
    {
      "id": "US-492",
      "title": "preview what will be forwarded before sending",
      "description": "As a team member, I want preview what will be forwarded before sending so that I can confirm the correct message is attached",
      "acceptanceCriteria": [
        "Attachment row is clickable to expand preview",
        "Preview shows all original email metadata (from, to, cc, date, subject)",
        "Preview shows original body content (HTML rendered or plain text)",
        "Preview shows original attachments (filename, size) if any",
        "Original content is read-only (not editable)",
        "Preview can be collapsed to return to compose",
        "Preview loading state while fetching full message details",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-002"
    },
    {
      "id": "US-493",
      "title": "search for specific emails across tickets",
      "description": "As a team member, I want search for specific emails across tickets so that I can find the exact email I need to forward as proof",
      "acceptanceCriteria": [
        "Search panel accessible from compose modal (\"Attach Message\" \u2192 \"Search\")",
        "Text search queries subject and body content (full-text search)",
        "Date range filter with date pickers (from/to)",
        "Sender/recipient email filter (autocomplete from contacts)",
        "Client/organization filter (dropdown)",
        "Direction filter: \"Sent only\", \"Received only\", \"All\"",
        "Results show paginated list (25 per page)",
        "Each result shows: ticket subject, message snippet (50 chars), date, sender, direction icon",
        "Checkbox selection for multi-select (up to 10 messages)",
        "\"Attach Selected\" button with count: \"Attach Selected (3)\"",
        "Empty state when no results: \"No messages match your search\"",
        "Search results load within 2 seconds",
        "Clear filters option to reset all criteria",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-003"
    },
    {
      "id": "US-494",
      "title": "attach multiple email messages to a single outgoing email",
      "description": "As a team member, I want attach multiple email messages to a single outgoing email so that I can provide comprehensive proof of communications",
      "acceptanceCriteria": [
        "\"Attach Message\" button in compose toolbar",
        "Can attach from current ticket (quick select) or search (cross-ticket)",
        "Current ticket messages shown in dropdown/popover list",
        "Multiple messages can be selected (checkbox multi-select)",
        "Attachment list shows all selected messages",
        "Each attachment row shows: subject, date, sender, remove (X) button",
        "Remove button removes message from attachment list before sending",
        "If compose is cancelled, attachment references are discarded (not saved)",
        "If send fails permanently, user can remove attachment and retry with different message",
        "Maximum 10 message attachments enforced",
        "Warning shown when limit reached: \"Maximum 10 messages can be attached\"",
        "Duplicate detection prevents attaching same message twice",
        "Total attachment size shown (sum of estimated .eml sizes)",
        "Warning if total size exceeds 25MB",
        "Cannot attach a message that is already a forwarded-as-attachment message (shows warning: \"This message contains forwarded emails and cannot be forwarded again\")",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-004"
    },
    {
      "id": "US-495",
      "title": "Generate EML File",
      "description": "As a user, I want generate eml file so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-005"
    },
    {
      "id": "US-496",
      "title": "view .eml attachments on incoming tickets",
      "description": "As a team member, I want view .eml attachments on incoming tickets so that I can see the original email that was forwarded to us",
      "acceptanceCriteria": [
        ".eml files recognized by MIME type (message/rfc822)",
        "Special icon for .eml attachments (\ud83d\udce7 or mail icon)",
        "Click to preview .eml content in viewer",
        "Preview shows parsed headers in readable format",
        "Preview shows body content (HTML rendered or plain text)",
        "Preview shows nested attachments list",
        "Nested attachments can be downloaded individually",
        "\"Download Original\" button downloads raw .eml file",
        "Error handling for malformed .eml files (show error, allow download)",
        ".eml files from external sources parsed safely (sanitize HTML)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-006"
    },
    {
      "id": "US-497",
      "title": "forward an email as attachment directly from the ticket list",
      "description": "As a team member, I want forward an email as attachment directly from the ticket list so that I can quickly send proof without opening the full ticket",
      "acceptanceCriteria": [
        "Right-click context menu on ticket row includes \"Forward as Attachment\"",
        "If single message in ticket: opens compose directly",
        "If multiple messages: shows message selector popover",
        "Message selector shows: sender, subject, date, snippet",
        "Maximum 5 recent messages in quick selector",
        "\"View all in ticket\" option opens ticket detail",
        "Selected message passed to compose modal",
        "Keyboard shortcut: Select ticket + press \"F\" opens forward flow",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-041-Forward-Email-Attachment: US-FWD-007"
    },
    {
      "id": "US-498",
      "title": "View Ticket List (Modified)",
      "description": "As a user, I want view ticket list (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-011"
    },
    {
      "id": "US-499",
      "title": "Toggle Preview Pane Mode (Modified)",
      "description": "As a user, I want toggle preview pane mode (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-034"
    },
    {
      "id": "US-500",
      "title": "View Ticket Detail (Modified)",
      "description": "As a user, I want view ticket detail (modified) so that I can use this feature.",
      "acceptanceCriteria": [
        "Feature implemented as specified",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-012"
    },
    {
      "id": "US-501",
      "title": "search for tickets within my current filtered view",
      "description": "As a ticket agent, I want search for tickets within my current filtered view so that I can find specific tickets without losing my current context",
      "acceptanceCriteria": [
        "Search bar appears in ticket list header (right side, before view toggle)",
        "Search bar has search icon and placeholder text",
        "Placeholder shows current context: \"Search in [Queue/View Name]...\" or \"Search all tickets...\"",
        "300ms debounce on typing before search executes",
        "Minimum 2 characters required to trigger search",
        "Search respects all active view filters when scope is \"currentView\"",
        "Results replace normal ticket list (same layout/columns)",
        "Result count shown in header: \"X results for '[query]'\"",
        "Results sorted by relevance (best match first) then by updated date",
        "Empty results show: \"No tickets found for '[query]' in [context]\"",
        "Loading skeleton shows while search is executing",
        "Keyboard shortcut `/` focuses search bar (when not in input field)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-001"
    },
    {
      "id": "US-502",
      "title": "change the scope of my search",
      "description": "As a ticket agent, I want change the scope of my search so that I can broaden or narrow my search area",
      "acceptanceCriteria": [
        "Scope dropdown appears in search bar (left side, before input)",
        "Current scope shown as chip with dropdown arrow",
        "Default scope is \"Current View\"",
        "\"Current View\" searches only tickets matching all active filters + query",
        "\"Current Queue\" searches all tickets in current queue (ignores status/assignee/etc filters)",
        "\"Current Queue\" only available when viewing a specific queue",
        "\"All Tickets\" searches all accessible tickets (ignores all filters)",
        "Changing scope re-executes current search immediately",
        "Scope persists during search session",
        "Scope resets to \"Current View\" when search is cleared",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-002"
    },
    {
      "id": "US-503",
      "title": "see search results with matched terms highlighted",
      "description": "As a ticket agent, I want see search results with matched terms highlighted so that I can quickly identify the ticket I'm looking for",
      "acceptanceCriteria": [
        "Results use same layout as regular ticket list (list-only or preview mode)",
        "Matching terms highlighted in subject (yellow background or bold)",
        "If body matched, snippet shows: \"...context **matching text** more context...\"",
        "Snippet limited to ~100 characters around match",
        "Multiple matches in same field show multiple snippets (max 2)",
        "Requester name/email highlighted if matched",
        "Tags highlighted if matched",
        "Hover shows tooltip with additional match context (if available)",
        "Click opens ticket in current mode (detail page, preview, or tab)",
        "In preview mode, clicking selects ticket and shows in preview pane",
        "Matched field indicators show which fields matched (icons or text)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-003"
    },
    {
      "id": "US-504",
      "title": "clear my search and return to normal view",
      "description": "As a ticket agent, I want clear my search and return to normal view so that I can go back to browsing tickets normally",
      "acceptanceCriteria": [
        "X button appears in search bar when query exists",
        "Clicking X clears query and search results",
        "Escape key clears search when search bar is focused",
        "Escape key closes search bar focus when search is empty",
        "Clearing input (backspace all) clears search after debounce",
        "Original view filters are restored (not lost during search)",
        "Search bar returns to placeholder state",
        "Scope resets to \"Current View\"",
        "View counts update back to original (search count badge removed)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-004"
    },
    {
      "id": "US-505",
      "title": "search within a single ticket's message thread",
      "description": "As a ticket agent, I want search within a single ticket's message thread so that I can find specific messages in long conversations",
      "acceptanceCriteria": [
        "Cmd+F / Ctrl+F opens in-ticket search (not browser find)",
        "Search bar appears at top of conversation area (sticky)",
        "Search bar shows: input, result count \"X of Y\", prev/next buttons, close button",
        "Search queries all messages in ticket (subject, body)",
        "Minimum 2 characters to trigger search",
        "200ms debounce on typing",
        "Matching messages are visually indicated (border, background, or badge)",
        "First match automatically scrolls into view",
        "Match text highlighted within message (yellow background)",
        "Enter or \u2193 button navigates to next match",
        "Shift+Enter or \u2191 button navigates to previous match",
        "Navigation wraps (after last match, goes to first)",
        "Current match shows distinct highlight (different from other matches)",
        "\"No matches found\" shown when query returns nothing",
        "Escape closes in-ticket search",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-005"
    },
    {
      "id": "US-506",
      "title": "use search alongside existing view filters",
      "description": "As a ticket agent, I want use search alongside existing view filters so that I can find tickets with specific criteria plus keyword match",
      "acceptanceCriteria": [
        "Changing filters while search active re-executes search",
        "Search results respect all active filters (when scope is \"Current View\")",
        "Filter chips remain visible during search",
        "Clearing a filter re-executes search with remaining filters",
        "Adding a filter re-executes search with new filter",
        "Search + filters combine with AND logic",
        "\"No results\" state shows active filters for context",
        "Filter changes have same debounce as search (300ms)",
        "If tickets are selected when search starts, selection is cleared with toast notification",
        "Bulk actions disabled during search (or work on search results only)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-006"
    },
    {
      "id": "US-507",
      "title": "control which fields are searched",
      "description": "As a ticket agent, I want control which fields are searched so that I can narrow results to specific criteria",
      "acceptanceCriteria": [
        "Prefixes recognized: `subject:`, `body:`, `from:`, `tag:`",
        "Prefix removed from search query when recognized",
        "Multiple prefixes can be combined: `subject:invoice from:john`",
        "Without prefix, search queries all fields (default)",
        "Search options panel accessible via icon button",
        "Panel shows checkboxes for each searchable field",
        "All fields checked by default",
        "Unchecking field excludes it from search",
        "Field selection persists during search session",
        "Results indicate which field matched (icon or text)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-007"
    },
    {
      "id": "US-508",
      "title": "see my recent searches in this context",
      "description": "As a ticket agent, I want see my recent searches in this context so that I can quickly repeat common searches",
      "acceptanceCriteria": [
        "Recent searches dropdown appears on focus when input is empty",
        "If no recent searches exist, dropdown shows: \"No recent searches. Start typing to search.\"",
        "Shows last 5 contextual searches (not global searches)",
        "Each shows: query text, scope badge, result count, \"2h ago\"",
        "Recent searches are context-aware (queue-specific if in queue)",
        "Clicking recent search populates input and executes",
        "Dropdown closes when user starts typing",
        "Dropdown closes on click outside",
        "\"Clear recent\" option at bottom of dropdown (only shown if searches exist)",
        "Recent searches stored per-user in Convex (persist across sessions)",
        "Recent searches separate from global search history",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "CHANGE-042-Contextual-Ticket-Search: US-TKT-SEARCH-008"
    },
    {
      "id": "US-509",
      "title": "Consolidate views sidebar hierarchy",
      "description": "As a user, I want to see all admin-controlled views in one 'Views' section so that I understand which views are available without confusion",
      "acceptanceCriteria": [
        "'Views' section contains all non-personal views (system + shared)",
        "System views marked with subtle indicator (lock icon or 'Default' badge)",
        "Shared views show share icon and/or 'Shared with X' tooltip",
        "Personal Views section appears between Views and Queues",
        "Section collapse state persists in localStorage (keys: tickets-sidebar-views-collapsed, tickets-sidebar-personal-collapsed, tickets-sidebar-queues-collapsed)",
        "View counts (badges) still display correctly",
        "Active view highlighted appropriately",
        "Empty sections handled appropriately (empty Personal Views shows collapsed section with (0) badge or hides entirely)",
        "When Queues section has no queues, show empty state message: 'No queues available'",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "CHANGE-044: US-TUX-001 - See 'Views Sidebar (New Hierarchy)' in UI Specifications",
      "status": "complete"
    },
    {
      "id": "US-510",
      "title": "Edit default system views (admin)",
      "description": "As an admin, I want to edit the default system views so that I can customize them for my organization's workflow",
      "acceptanceCriteria": [
        "Edit option available on system views for admins only",
        "Warning message displayed when editing system view: 'This is a system default view. Changes affect all users.'",
        "'Reset to Default' button available in editor for system views",
        "Reset confirmation: 'Reset this view to original settings?'",
        "Changes to system views apply to all users immediately",
        "Non-admins see system views but cannot edit them",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": true,
      "notes": "CHANGE-044: US-TUX-002 - See 'Views Sidebar (New Hierarchy)' in UI Specifications"
    },
    {
      "id": "US-511",
      "title": "Multi-select in list view with hover checkboxes",
      "description": "As a user, I want to select multiple tickets using hover checkboxes so that I can perform bulk actions without visual clutter",
      "acceptanceCriteria": [
        "Checkboxes hidden by default, appear on hover",
        "Hover area for checkbox is generous (entire left portion of row)",
        "First checkbox click enters select mode with visual feedback (subtle animation/transition)",
        "Bulk actions bar slides up smoothly from bottom when entering select mode",
        "Header checkbox appears with animation when entering select mode",
        "In select mode, all checkboxes visible (not just hovered row)",
        "Single click toggles selection in select mode",
        "Shift+click selects range (inclusive, works in both directions)",
        "Escape key clears selection and exits select mode",
        "'Clear selection' button in bulk actions bar clears selection",
        "Clicking outside ticket list clears selection (boundaries: clicking in header, sidebar, or preview pane clears selection; clicking in filter bar does NOT clear selection)",
        "Changing view clears selection",
        "Selection count shown in bulk actions bar: 'X tickets selected'",
        "Select all checkbox in header (when in select mode)",
        "Select all respects current filters (selects visible tickets only)",
        "Loading states during bulk operations: show loading spinner on affected rows, bulk actions bar shows 'Processing...' state with spinner, loading state clears when operation completes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-003 - See 'Multi-Select States (List View)' in UI Specifications"
    },
    {
      "id": "US-512",
      "title": "Multi-select in preview view (Outlook-style)",
      "description": "As a user, I want to select multiple tickets in preview mode using keyboard modifiers so that I can work with tickets like I do with emails in Outlook",
      "acceptanceCriteria": [
        "Single click selects one ticket (existing behavior)",
        "Cmd+click (Mac) / Ctrl+click (Windows) toggles selection",
        "Shift+click selects range from last clicked to current",
        "Multiple selection shows count in UI",
        "Preview pane shows 'X tickets selected' message (not individual ticket)",
        "Bulk actions available for multi-selection",
        "Escape clears selection",
        "Clicking without modifier selects only that ticket (clears others)",
        "Visual indicator on selected cards (highlight/border)",
        "Works with keyboard navigation (arrow keys + shift for range)",
        "Loading states during bulk operations: show loading spinner on affected cards, bulk actions bar shows 'Processing...' state with spinner, loading state clears when operation completes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-004 - See 'Multi-Select States (List View)' in UI Specifications"
    },
    {
      "id": "US-513",
      "title": "Archive ticket backend and quick action UI",
      "description": "As a user, I want to quickly archive non-actionable tickets with one click so that I can clear noise from my inbox without opening each ticket",
      "acceptanceCriteria": [
        "Add isArchived, archivedAt, archivedBy fields to tickets schema if not present",
        "Add index on tenantId and isArchived",
        "Create archive mutation that sets isArchived=true, archivedAt=now, archivedBy=currentUserId",
        "Create bulkArchive mutation for multiple tickets",
        "Create restore mutation that clears archive fields",
        "Create bulkRestore mutation for multiple tickets",
        "Update listTickets query to support includeArchived and archivedOnly filter parameters",
        "Archive icon appears on hover (both list and preview card views)",
        "Archive icon is clearly recognizable (archive box icon)",
        "Single-click archives immediately (no confirmation dialog)",
        "Archived ticket removed from current view (if view excludes archived)",
        "Toast notification with Undo option",
        "Undo restores ticket to previous state",
        "Undo button disappears after 5 seconds, toast remains visible but undo action disabled after timeout",
        "After timeout, archive is permanent (no way to undo)",
        "Archived tickets viewable in 'All Tickets' view with filter",
        "Archive does NOT change ticket status",
        "Archive does NOT send any notification/email",
        "Bulk archive available from bulk actions bar",
        "Bulk archive shows confirmation: 'Archive X tickets?'",
        "Keyboard shortcut: 'E' to archive selected ticket(s)",
        "Error handling: permission check happens before archive attempt, error message is user-friendly, error toast appears immediately (no loading state), bulk archive shows which tickets failed: 'X tickets archived, Y failed (permission denied)'",
        "Network errors show different message: 'Failed to archive ticket. Please try again.' with retry button",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-005, US-TUX-011 - See 'Archive Hover Action' in UI Specifications and 'Data Model Updates' section"
    },
    {
      "id": "US-514",
      "title": "View and restore archived tickets",
      "description": "As a user, I want to view and restore archived tickets so that I can recover tickets I archived by mistake",
      "acceptanceCriteria": [
        "'Show archived' toggle in filter panel",
        "Archived tickets visually distinct (dimmed, badge, or icon)",
        "Archive date shown in ticket detail",
        "'Restore' action available on archived tickets",
        "Restore removes archived status",
        "Restore shows toast: 'Ticket restored'",
        "Bulk restore available for multiple archived tickets",
        "Bulk restore shows confirmation: 'Restore X archived tickets?' with list of tickets being restored",
        "Single restore requires no confirmation (like single archive)",
        "Archived tickets excluded from default views (configurable per view)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-006 - See 'Data Model Updates' section"
    },
    {
      "id": "US-515",
      "title": "Fixed submit button in preview mode",
      "description": "As a user, I want to see the submit button in a fixed position in preview mode so that it's always visible and accessible like in full-screen mode",
      "acceptanceCriteria": [
        "Left panel: ticket list (scrollable container)",
        "Right panel: ticket detail (scrollable container)",
        "Right panel structure: Header (sticky), Conversation (scrollable), Reply editor (sticky bottom), Submit button (fixed bottom-right)",
        "Submit button overlays reply editor (doesn't push it up)",
        "Submit button fixed at bottom-right of preview pane viewport (not document)",
        "Button position matches full-screen ticket view",
        "Button stays visible when scrolling conversation",
        "Reply editor has full available height (not shrunk by button)",
        "Button clearly separated from reply content (visual boundary)",
        "When conversation is short, submit button appears at natural position above editor",
        "When conversation is long, submit button stays visible at bottom while scrolling",
        "Button shows loading state when submitting",
        "Button disabled when reply is empty and no status change",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-007 - See 'Submit Split Button' in UI Specifications"
    },
    {
      "id": "US-516",
      "title": "One-click status submit with split button",
      "description": "As a user, I want to submit a reply with a different status in one click so that I don't have to select status and then click submit separately",
      "acceptanceCriteria": [
        "Submit button is a split button (main button + dropdown arrow)",
        "Main button submits with current/default status",
        "Dropdown shows all valid status options",
        "Each dropdown option is an ACTION (submits immediately)",
        "Dropdown options show status color indicator: Open (Blue/primary), Pending (Yellow/amber), On Hold (Orange), Solved (Green)",
        "Colors match existing status color scheme",
        "No second click required after selecting status",
        "Loading state shows on clicked option while submitting",
        "Success closes dropdown and shows toast",
        "Error keeps dropdown open with error message",
        "Keyboard: Enter submits default, arrow keys navigate options",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-008 - See 'Submit Split Button' in UI Specifications"
    },
    {
      "id": "US-517",
      "title": "Hierarchical assignment UI",
      "description": "As a user, I want to see users organized under their teams in the assignment dropdown so that I can find the right person faster and understand team structure",
      "acceptanceCriteria": [
        "Assignment dropdown shows hierarchical tree",
        "Teams shown with expand/collapse chevron",
        "Teams show member count: 'Payroll Team (3)'",
        "Users shown with avatar and name under their team",
        "Users can belong to multiple teams (shown under each)",
        "'No Team' section at bottom for users without team membership",
        "Search filters both team names and user names",
        "Search match highlights in results",
        "Clicking team assigns ticket to team (not a specific user)",
        "Clicking user assigns ticket to that user",
        "Current assignee shown with checkmark",
        "'Unassign' option at top (if currently assigned)",
        "Keyboard navigation: Arrow Up/Down navigates between items, Arrow Right expands collapsed team, Arrow Left collapses expanded team, Enter selects highlighted item (assigns), Escape closes dropdown without assigning, Tab moves focus to search input, Visual highlight shows currently focused item",
        "Team expansion state: Teams always start collapsed, If team is currently assigned, that team starts expanded, Expansion state does NOT persist across sessions",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-009 - See 'Hierarchical Assignment' in UI Specifications"
    },
    {
      "id": "US-518",
      "title": "Simplified attach message dialog",
      "description": "As a user, I want to search for messages to attach starting with related correspondence so that I can quickly find the relevant email to forward",
      "acceptanceCriteria": [
        "Dialog opens to search interface (no 'Current Ticket' tab)",
        "Search pre-populated with requester's email: 'from:{email} OR to:{email}'",
        "Pre-populated search shows: 'Messages with {requester name/email}'",
        "Search debounced by 300ms",
        "Search triggers after 2+ characters OR immediately on Enter",
        "Clear button (X) appears when search has text",
        "Results load immediately on dialog open",
        "Loading states: Search shows skeleton loaders or spinner while loading, Results appear incrementally as they load (if paginated), Search input shows loading indicator during query",
        "Advanced filters available: date range, direction, client",
        "Multi-select with checkboxes (max 10)",
        "Selection count shown: 'X messages selected (max 10)'",
        "Clear search button to start fresh search",
        "Results show: subject, sender, date, snippet",
        "Results show ticket context: 'From ticket: {subject}'",
        "Pagination or infinite scroll for many results",
        "Empty state: Shows icon (search/mail icon), Shows message: 'No messages found matching your search', Shows suggestion: 'Try adjusting your filters or search terms', Has 'Clear search' button to start fresh",
        "Attach button disabled if nothing selected",
        "Attached messages show in reply draft with remove option",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": false,
      "notes": "CHANGE-044: US-TUX-010 - See 'Attach Message Dialog (Search Only)' in UI Specifications"
    }
  ]
}